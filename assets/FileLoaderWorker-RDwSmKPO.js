(function(){"use strict";var Ar=(t=>(t.start="start",t.cancel="cancel",t))(Ar||{}),Zt=(t=>(t.started="started",t.progress="progress",t.cancel="cancel",t.error="error",t.finished="finished",t))(Zt||{});let Ze;const Ci=new Uint8Array(16);function xi(){if(!Ze&&(Ze=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ze))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ze(Ci)}const vt=[];for(let t=0;t<256;++t)vt.push((t+256).toString(16).slice(1));function Oi(t,e=0){return vt[t[e+0]]+vt[t[e+1]]+vt[t[e+2]]+vt[t[e+3]]+"-"+vt[t[e+4]]+vt[t[e+5]]+"-"+vt[t[e+6]]+vt[t[e+7]]+"-"+vt[t[e+8]]+vt[t[e+9]]+"-"+vt[t[e+10]]+vt[t[e+11]]+vt[t[e+12]]+vt[t[e+13]]+vt[t[e+14]]+vt[t[e+15]]}var Tr={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function wn(t,e,n){if(Tr.randomUUID&&!e&&!t)return Tr.randomUUID();t=t||{};const i=t.random||(t.rng||xi)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(let r=0;r<16;++r)e[n+r]=i[r];return e}return Oi(i)}const ye={RegionCentroid:1,RoadWaypoint:2,Airport:3,AirwayWaypoint:4,Seaport:5,SeawayWaypoint:6,RailwayStation:7,RailwayWaypoint:8},be={Road:1,Airway:2,Seaway:3,Railway:4,HighSpeedRailway:5},Qt=10,wr={NOT_CONTAINED:-1},He=256;function Ee(t,e){let n=Math.sin(t.lat*Math.PI/180);n=Math.min(Math.max(n,-.9999),.9999);const i=He*(.5+t.lng/360)*Math.pow(2,e),r=He*(.5-Math.log((1+n)/(1-n))/(4*Math.PI))*Math.pow(2,e);return{x:i,y:r}}function ve(t,e){return{x:Math.floor(t.x/He),y:Math.floor(t.y/He),z:e}}function qe({x:t,y:e,z:n}){let i=0;for(let r=0;r<n;r++){const s=1<<r;t&s&&(i|=1<<2*r),e&s&&(i|=1<<2*r+1)}return i}function Pi(t,e){let n=Qt;for(;n>0;){const i=ve(Ee(t,n),n),r=ve(Ee(e,n),n),s=qe(i),a=qe(r);if(s!==a)break;n--}return n}function In(t,e,n){if(n===void 0&&(n=Pi(t,e)),n<0||n>Qt)throw new Error(`Invalid zoom level: ${n}`);if(t.lng>e.lng){const i=Rn(t,{lat:e.lat,lng:180},n),r=Rn({lat:t.lat,lng:-180},e,n);return[i,r]}else return t.lng===-180&&e.lng===180?[[0]]:[Rn(t,e,n)]}function Rn(t,e,n){const i=Ee(t,n),r=Ee(e,n),s=ve(i,n),a=ve(r,n),o=[];for(let u=s.x;u<=a.x;u++)for(let g=s.y;g<=a.y;g++)o.push(qe({x:u,y:g,z:n}));return o}function Di(t,e,n){if(n<0||n>Qt)throw new Error(`Invalid max zoom level: ${n}`);const i={};for(let r=0;r<=n;r++)i[`z${r}`]=In(t,e,r);return i}const Bi=async({db:t,stream:e,fileName:n,fileSize:i,csvLoaders:r,startedCallback:s,progressCallback:a,errorCallback:o,cancelCallback:u,finishedCallback:g})=>{let m=[],d=0;s(n,t.name);let l="",b=null,h=0,E=0;const f=e.getReader();for(;;){console.log(n,h);const{done:y,value:v}=await f.read();if(y||!v)break;const I=new TextDecoder("utf-8").decode(v);l+=I;const w=l.split(/[\r\n]+/);E+=w.length,l.endsWith(`
`)?l="":l=w.pop()||"";for(let k=0;k<w.length;k++){h++;const L=w[k];if(d===0&&k===0){const[,S]=Object.entries(r).find(([M,Z])=>{if(Z.check(L))return!0})||[null,null];if(S===null)throw new Error("loader not found:"+L);b=S;continue}if(b===null)throw new Error("loader not selected");const O=await b.createEntity(t,L);O&&(m.push(O),d++,m.length===64&&(await b.bulkAddEntity(t,m),m=[])),a({type:Zt.progress,fileName:n,fileSize:i,progress:Math.round(h/E*100),index:h,total:E,unit:"lines"})}}if(b===null)throw new Error("loader not selected");m.length>0&&await b.bulkAddEntity(t,m),g(n)},Mi=(t,e)=>{const n=t.split(/[.\s]/);return n[0]==="Stn"?ye.RailwayStation:n[0]==="Port"?ye.Seaport:n[0]==="Airport"?ye.Airport:e?ye.RegionCentroid:ye.RoadWaypoint},Ui=t=>{if(t==="0")return be.Road;if(t==="1")return be.Seaway;if(t==="2")return be.Airway;if(t==="3")return be.Railway;if(t==="4")return be.HighSpeedRailway;throw new Error},Fi={0:{check:t=>t==="CapitalCity,Latitude,Longitude,Region,Country,Habitable,Population,Employment,EmplyomentA,EmploymentM1,EmploymentM2,EmploymentM3,EmploymentM4,EmploymentM5,EmploymentS,EmploymentA2,GDP,GDPA,GDPM1,GDPM2,GDPM3,GDPM4,GDPM5,GDPS,GDPA2,Area,Mining,Grate,Plimit"||t==="CapitalCity,Latitude,Longitude,Region,Country,Habitable,Population,Employment,EmploymentA,EmploymentM1,EmploymentM2,EmploymentM3,EmploymentM4,EmploymentM5,EmploymentS,EmploymentA2,GDP,GDPA,GDPM1,GDPM2,GDPM3,GDPM4,GDPM5,GDPS,GDPA2,Area,Mining,Grate,Plimit",createEntity:async(t,e)=>{const[n,i,r,s,a,o,...u]=e.split(",");if(n==="")return null;const g=[parseFloat(i),parseFloat(r)],m={};for(let b=0;b<=Qt;b++)m[`z${b}`]=qe(ve(Ee({lat:g[0],lng:g[1]},b),b));const d=Mi(n,o==="1"),l={uuid:wn(),lat:g[0],lng:g[1],country:a,name_1:s,name_2:"",name:n,type:d,...m};return console.log(l),l},bulkAddEntity:async(t,e)=>{await t.points.bulkAdd(e)}},1:{check:t=>t==="Start,End,Name,Distance,Speed,Border,Orverhead,Loading,Mode,Quality,Oneway,Freight,Country1,Region1,Country2,Region2"||t==="Start,End,Name,Distance,Speed,Border,Overhead,Loading,Mode,Quality,Oneway,Freight,Country1,Region1,Country2,Region2",createEntity:async(t,e)=>{const[n,i,r,s,a,o,u,g,m,_,d,l,b,h,E,f]=e.split(","),y=await t.points.where("name").equals(n).last(),v=await t.points.where("name").equals(i).last();if(!y||!v)throw new Error;const[I,w]=y.lat>v.lat?[y.lat,v.lat]:[v.lat,y.lat],[k,L]=y.lng>v.lng?[y.lng,v.lng]:[v.lng,y.lng],O={};for(let M=0;M<=Qt;M++){const Z=In({lat:I,lng:k},{lat:w,lng:L},M);if(Z.length===0)O[`z${M}`]=wr.NOT_CONTAINED;else if(Z.length===1)if(Z[0].length===1)O[`z${M}`]=Z[0][0];else if(Z[0].length>=2)O[`z${M}`]=O[`z${M-1}`];else throw new Error;else if(Z.length===2)Z[1].length===1?O[`z${M}_`]=Z[1][0]:Z[1].length>=2&&(O[`z${M}_`]=O[`z${M-1}_`]);else throw new Error("mortonNumber.length > 2 :"+Z.join(" ,"))}return{uuid:wn(),sourceName:y.name,sourceIdRef:y.uuid,sourceCountry:b,sourceName1:h,sourceName2:"",targetName:v.name,targetIdRef:v.uuid,targetCountry:E,targetName1:f,targetName2:"",name:r,mode:Ui(m),...O}},bulkAddEntity:async(t,e)=>{await t.routeSegments.bulkAdd(e)}}};var H;(function(t){t[t.BACKSPACE=8]="BACKSPACE",t[t.FORM_FEED=12]="FORM_FEED",t[t.NEWLINE=10]="NEWLINE",t[t.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",t[t.TAB=9]="TAB",t[t.SPACE=32]="SPACE",t[t.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",t[t.QUOTATION_MARK=34]="QUOTATION_MARK",t[t.NUMBER_SIGN=35]="NUMBER_SIGN",t[t.DOLLAR_SIGN=36]="DOLLAR_SIGN",t[t.PERCENT_SIGN=37]="PERCENT_SIGN",t[t.AMPERSAND=38]="AMPERSAND",t[t.APOSTROPHE=39]="APOSTROPHE",t[t.LEFT_PARENTHESIS=40]="LEFT_PARENTHESIS",t[t.RIGHT_PARENTHESIS=41]="RIGHT_PARENTHESIS",t[t.ASTERISK=42]="ASTERISK",t[t.PLUS_SIGN=43]="PLUS_SIGN",t[t.COMMA=44]="COMMA",t[t.HYPHEN_MINUS=45]="HYPHEN_MINUS",t[t.FULL_STOP=46]="FULL_STOP",t[t.SOLIDUS=47]="SOLIDUS",t[t.DIGIT_ZERO=48]="DIGIT_ZERO",t[t.DIGIT_ONE=49]="DIGIT_ONE",t[t.DIGIT_TWO=50]="DIGIT_TWO",t[t.DIGIT_THREE=51]="DIGIT_THREE",t[t.DIGIT_FOUR=52]="DIGIT_FOUR",t[t.DIGIT_FIVE=53]="DIGIT_FIVE",t[t.DIGIT_SIX=54]="DIGIT_SIX",t[t.DIGIT_SEVEN=55]="DIGIT_SEVEN",t[t.DIGIT_EIGHT=56]="DIGIT_EIGHT",t[t.DIGIT_NINE=57]="DIGIT_NINE",t[t.COLON=58]="COLON",t[t.SEMICOLON=59]="SEMICOLON",t[t.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",t[t.EQUALS_SIGN=61]="EQUALS_SIGN",t[t.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.COMMERCIAL_AT=64]="COMMERCIAL_AT",t[t.LATIN_CAPITAL_LETTER_A=65]="LATIN_CAPITAL_LETTER_A",t[t.LATIN_CAPITAL_LETTER_B=66]="LATIN_CAPITAL_LETTER_B",t[t.LATIN_CAPITAL_LETTER_C=67]="LATIN_CAPITAL_LETTER_C",t[t.LATIN_CAPITAL_LETTER_D=68]="LATIN_CAPITAL_LETTER_D",t[t.LATIN_CAPITAL_LETTER_E=69]="LATIN_CAPITAL_LETTER_E",t[t.LATIN_CAPITAL_LETTER_F=70]="LATIN_CAPITAL_LETTER_F",t[t.LATIN_CAPITAL_LETTER_G=71]="LATIN_CAPITAL_LETTER_G",t[t.LATIN_CAPITAL_LETTER_H=72]="LATIN_CAPITAL_LETTER_H",t[t.LATIN_CAPITAL_LETTER_I=73]="LATIN_CAPITAL_LETTER_I",t[t.LATIN_CAPITAL_LETTER_J=74]="LATIN_CAPITAL_LETTER_J",t[t.LATIN_CAPITAL_LETTER_K=75]="LATIN_CAPITAL_LETTER_K",t[t.LATIN_CAPITAL_LETTER_L=76]="LATIN_CAPITAL_LETTER_L",t[t.LATIN_CAPITAL_LETTER_M=77]="LATIN_CAPITAL_LETTER_M",t[t.LATIN_CAPITAL_LETTER_N=78]="LATIN_CAPITAL_LETTER_N",t[t.LATIN_CAPITAL_LETTER_O=79]="LATIN_CAPITAL_LETTER_O",t[t.LATIN_CAPITAL_LETTER_P=80]="LATIN_CAPITAL_LETTER_P",t[t.LATIN_CAPITAL_LETTER_Q=81]="LATIN_CAPITAL_LETTER_Q",t[t.LATIN_CAPITAL_LETTER_R=82]="LATIN_CAPITAL_LETTER_R",t[t.LATIN_CAPITAL_LETTER_S=83]="LATIN_CAPITAL_LETTER_S",t[t.LATIN_CAPITAL_LETTER_T=84]="LATIN_CAPITAL_LETTER_T",t[t.LATIN_CAPITAL_LETTER_U=85]="LATIN_CAPITAL_LETTER_U",t[t.LATIN_CAPITAL_LETTER_V=86]="LATIN_CAPITAL_LETTER_V",t[t.LATIN_CAPITAL_LETTER_W=87]="LATIN_CAPITAL_LETTER_W",t[t.LATIN_CAPITAL_LETTER_X=88]="LATIN_CAPITAL_LETTER_X",t[t.LATIN_CAPITAL_LETTER_Y=89]="LATIN_CAPITAL_LETTER_Y",t[t.LATIN_CAPITAL_LETTER_Z=90]="LATIN_CAPITAL_LETTER_Z",t[t.LEFT_SQUARE_BRACKET=91]="LEFT_SQUARE_BRACKET",t[t.REVERSE_SOLIDUS=92]="REVERSE_SOLIDUS",t[t.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",t[t.CIRCUMFLEX_ACCENT=94]="CIRCUMFLEX_ACCENT",t[t.LOW_LINE=95]="LOW_LINE",t[t.GRAVE_ACCENT=96]="GRAVE_ACCENT",t[t.LATIN_SMALL_LETTER_A=97]="LATIN_SMALL_LETTER_A",t[t.LATIN_SMALL_LETTER_B=98]="LATIN_SMALL_LETTER_B",t[t.LATIN_SMALL_LETTER_C=99]="LATIN_SMALL_LETTER_C",t[t.LATIN_SMALL_LETTER_D=100]="LATIN_SMALL_LETTER_D",t[t.LATIN_SMALL_LETTER_E=101]="LATIN_SMALL_LETTER_E",t[t.LATIN_SMALL_LETTER_F=102]="LATIN_SMALL_LETTER_F",t[t.LATIN_SMALL_LETTER_G=103]="LATIN_SMALL_LETTER_G",t[t.LATIN_SMALL_LETTER_H=104]="LATIN_SMALL_LETTER_H",t[t.LATIN_SMALL_LETTER_I=105]="LATIN_SMALL_LETTER_I",t[t.LATIN_SMALL_LETTER_J=106]="LATIN_SMALL_LETTER_J",t[t.LATIN_SMALL_LETTER_K=107]="LATIN_SMALL_LETTER_K",t[t.LATIN_SMALL_LETTER_L=108]="LATIN_SMALL_LETTER_L",t[t.LATIN_SMALL_LETTER_M=109]="LATIN_SMALL_LETTER_M",t[t.LATIN_SMALL_LETTER_N=110]="LATIN_SMALL_LETTER_N",t[t.LATIN_SMALL_LETTER_O=111]="LATIN_SMALL_LETTER_O",t[t.LATIN_SMALL_LETTER_P=112]="LATIN_SMALL_LETTER_P",t[t.LATIN_SMALL_LETTER_Q=113]="LATIN_SMALL_LETTER_Q",t[t.LATIN_SMALL_LETTER_R=114]="LATIN_SMALL_LETTER_R",t[t.LATIN_SMALL_LETTER_S=115]="LATIN_SMALL_LETTER_S",t[t.LATIN_SMALL_LETTER_T=116]="LATIN_SMALL_LETTER_T",t[t.LATIN_SMALL_LETTER_U=117]="LATIN_SMALL_LETTER_U",t[t.LATIN_SMALL_LETTER_V=118]="LATIN_SMALL_LETTER_V",t[t.LATIN_SMALL_LETTER_W=119]="LATIN_SMALL_LETTER_W",t[t.LATIN_SMALL_LETTER_X=120]="LATIN_SMALL_LETTER_X",t[t.LATIN_SMALL_LETTER_Y=121]="LATIN_SMALL_LETTER_Y",t[t.LATIN_SMALL_LETTER_Z=122]="LATIN_SMALL_LETTER_Z",t[t.LEFT_CURLY_BRACKET=123]="LEFT_CURLY_BRACKET",t[t.VERTICAL_LINE=124]="VERTICAL_LINE",t[t.RIGHT_CURLY_BRACKET=125]="RIGHT_CURLY_BRACKET",t[t.TILDE=126]="TILDE"})(H||(H={}));const zi={[H.QUOTATION_MARK]:H.QUOTATION_MARK,[H.REVERSE_SOLIDUS]:H.REVERSE_SOLIDUS,[H.SOLIDUS]:H.SOLIDUS,[H.LATIN_SMALL_LETTER_B]:H.BACKSPACE,[H.LATIN_SMALL_LETTER_F]:H.FORM_FEED,[H.LATIN_SMALL_LETTER_N]:H.NEWLINE,[H.LATIN_SMALL_LETTER_R]:H.CARRIAGE_RETURN,[H.LATIN_SMALL_LETTER_T]:H.TAB};class Ir{constructor(){this.decoder=new TextDecoder("utf-8"),this.strings=[],this.byteLength=0}appendChar(e){this.strings.push(String.fromCharCode(e)),this.byteLength+=1}appendBuf(e,n=0,i=e.length){this.strings.push(this.decoder.decode(e.subarray(n,i))),this.byteLength+=i-n}reset(){this.strings=[],this.byteLength=0}toString(){return this.strings.join("")}}class Rr{constructor(e){this.decoder=new TextDecoder("utf-8"),this.bufferOffset=0,this.string="",this.byteLength=0,this.buffer=new Uint8Array(e)}appendChar(e){this.bufferOffset>=this.buffer.length&&this.flushStringBuffer(),this.buffer[this.bufferOffset++]=e,this.byteLength+=1}appendBuf(e,n=0,i=e.length){const r=i-n;this.bufferOffset+r>this.buffer.length&&this.flushStringBuffer(),this.buffer.set(e.subarray(n,i),this.bufferOffset),this.bufferOffset+=r,this.byteLength+=r}flushStringBuffer(){this.string+=this.decoder.decode(this.buffer.subarray(0,this.bufferOffset)),this.bufferOffset=0}reset(){this.string="",this.bufferOffset=0,this.byteLength=0}toString(){return this.flushStringBuffer(),this.string}}var Ln;(function(t){t[t.LEFT_BRACE=0]="LEFT_BRACE",t[t.RIGHT_BRACE=1]="RIGHT_BRACE",t[t.LEFT_BRACKET=2]="LEFT_BRACKET",t[t.RIGHT_BRACKET=3]="RIGHT_BRACKET",t[t.COLON=4]="COLON",t[t.COMMA=5]="COMMA",t[t.TRUE=6]="TRUE",t[t.FALSE=7]="FALSE",t[t.NULL=8]="NULL",t[t.STRING=9]="STRING",t[t.NUMBER=10]="NUMBER",t[t.SEPARATOR=11]="SEPARATOR"})(Ln||(Ln={}));var at=Ln,G;(function(t){t[t.START=0]="START",t[t.ENDED=1]="ENDED",t[t.ERROR=2]="ERROR",t[t.TRUE1=3]="TRUE1",t[t.TRUE2=4]="TRUE2",t[t.TRUE3=5]="TRUE3",t[t.FALSE1=6]="FALSE1",t[t.FALSE2=7]="FALSE2",t[t.FALSE3=8]="FALSE3",t[t.FALSE4=9]="FALSE4",t[t.NULL1=10]="NULL1",t[t.NULL2=11]="NULL2",t[t.NULL3=12]="NULL3",t[t.STRING_DEFAULT=13]="STRING_DEFAULT",t[t.STRING_AFTER_BACKSLASH=14]="STRING_AFTER_BACKSLASH",t[t.STRING_UNICODE_DIGIT_1=15]="STRING_UNICODE_DIGIT_1",t[t.STRING_UNICODE_DIGIT_2=16]="STRING_UNICODE_DIGIT_2",t[t.STRING_UNICODE_DIGIT_3=17]="STRING_UNICODE_DIGIT_3",t[t.STRING_UNICODE_DIGIT_4=18]="STRING_UNICODE_DIGIT_4",t[t.STRING_INCOMPLETE_CHAR=19]="STRING_INCOMPLETE_CHAR",t[t.NUMBER_AFTER_INITIAL_MINUS=20]="NUMBER_AFTER_INITIAL_MINUS",t[t.NUMBER_AFTER_INITIAL_ZERO=21]="NUMBER_AFTER_INITIAL_ZERO",t[t.NUMBER_AFTER_INITIAL_NON_ZERO=22]="NUMBER_AFTER_INITIAL_NON_ZERO",t[t.NUMBER_AFTER_FULL_STOP=23]="NUMBER_AFTER_FULL_STOP",t[t.NUMBER_AFTER_DECIMAL=24]="NUMBER_AFTER_DECIMAL",t[t.NUMBER_AFTER_E=25]="NUMBER_AFTER_E",t[t.NUMBER_AFTER_E_AND_SIGN=26]="NUMBER_AFTER_E_AND_SIGN",t[t.NUMBER_AFTER_E_AND_DIGIT=27]="NUMBER_AFTER_E_AND_DIGIT",t[t.SEPARATOR=28]="SEPARATOR",t[t.BOM_OR_START=29]="BOM_OR_START",t[t.BOM=30]="BOM"})(G||(G={}));function Lr(t){return["START","ENDED","ERROR","TRUE1","TRUE2","TRUE3","FALSE1","FALSE2","FALSE3","FALSE4","NULL1","NULL2","NULL3","STRING_DEFAULT","STRING_AFTER_BACKSLASH","STRING_UNICODE_DIGIT_1","STRING_UNICODE_DIGIT_2","STRING_UNICODE_DIGIT_3","STRING_UNICODE_DIGIT_4","STRING_INCOMPLETE_CHAR","NUMBER_AFTER_INITIAL_MINUS","NUMBER_AFTER_INITIAL_ZERO","NUMBER_AFTER_INITIAL_NON_ZERO","NUMBER_AFTER_FULL_STOP","NUMBER_AFTER_DECIMAL","NUMBER_AFTER_E","NUMBER_AFTER_E_AND_SIGN","NUMBER_AFTER_E_AND_DIGIT","SEPARATOR","BOM_OR_START","BOM"][t]}const Gi={stringBufferSize:0,numberBufferSize:0,separator:void 0,emitPartialTokens:!1};class Ae extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ae.prototype)}}class Sr{constructor(e){this.state=G.BOM_OR_START,this.bomIndex=0,this.separatorIndex=0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.char_split_buffer=new Uint8Array(4),this.encoder=new TextEncoder,this.offset=-1,e=Object.assign(Object.assign({},Gi),e),this.emitPartialTokens=e.emitPartialTokens===!0,this.bufferedString=e.stringBufferSize&&e.stringBufferSize>4?new Rr(e.stringBufferSize):new Ir,this.bufferedNumber=e.numberBufferSize&&e.numberBufferSize>0?new Rr(e.numberBufferSize):new Ir,this.separator=e.separator,this.separatorBytes=e.separator?this.encoder.encode(e.separator):void 0}get isEnded(){return this.state===G.ENDED}write(e){try{let n;if(e instanceof Uint8Array)n=e;else if(typeof e=="string")n=this.encoder.encode(e);else if(Array.isArray(e))n=Uint8Array.from(e);else if(ArrayBuffer.isView(e))n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);else throw new TypeError("Unexpected type. The `write` function only accepts Arrays, TypedArrays and Strings.");for(let i=0;i<n.length;i+=1){const r=n[i];switch(this.state){case G.BOM_OR_START:if(e instanceof Uint8Array&&r===239){this.bom=[239,187,191],this.bomIndex+=1,this.state=G.BOM;continue}if(e instanceof Uint16Array){if(r===254){this.bom=[254,255],this.bomIndex+=1,this.state=G.BOM;continue}if(r===255){this.bom=[255,254],this.bomIndex+=1,this.state=G.BOM;continue}}if(e instanceof Uint32Array){if(r===0){this.bom=[0,0,254,255],this.bomIndex+=1,this.state=G.BOM;continue}if(r===255){this.bom=[255,254,0,0],this.bomIndex+=1,this.state=G.BOM;continue}}case G.START:if(this.offset+=1,this.separatorBytes&&r===this.separatorBytes[0]){if(this.separatorBytes.length===1){this.state=G.START,this.onToken({token:at.SEPARATOR,value:this.separator,offset:this.offset+this.separatorBytes.length-1});continue}this.state=G.SEPARATOR;continue}if(r===H.SPACE||r===H.NEWLINE||r===H.CARRIAGE_RETURN||r===H.TAB)continue;if(r===H.LEFT_CURLY_BRACKET){this.onToken({token:at.LEFT_BRACE,value:"{",offset:this.offset});continue}if(r===H.RIGHT_CURLY_BRACKET){this.onToken({token:at.RIGHT_BRACE,value:"}",offset:this.offset});continue}if(r===H.LEFT_SQUARE_BRACKET){this.onToken({token:at.LEFT_BRACKET,value:"[",offset:this.offset});continue}if(r===H.RIGHT_SQUARE_BRACKET){this.onToken({token:at.RIGHT_BRACKET,value:"]",offset:this.offset});continue}if(r===H.COLON){this.onToken({token:at.COLON,value:":",offset:this.offset});continue}if(r===H.COMMA){this.onToken({token:at.COMMA,value:",",offset:this.offset});continue}if(r===H.LATIN_SMALL_LETTER_T){this.state=G.TRUE1;continue}if(r===H.LATIN_SMALL_LETTER_F){this.state=G.FALSE1;continue}if(r===H.LATIN_SMALL_LETTER_N){this.state=G.NULL1;continue}if(r===H.QUOTATION_MARK){this.bufferedString.reset(),this.state=G.STRING_DEFAULT;continue}if(r>=H.DIGIT_ONE&&r<=H.DIGIT_NINE){this.bufferedNumber.reset(),this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_INITIAL_NON_ZERO;continue}if(r===H.DIGIT_ZERO){this.bufferedNumber.reset(),this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_INITIAL_ZERO;continue}if(r===H.HYPHEN_MINUS){this.bufferedNumber.reset(),this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_INITIAL_MINUS;continue}break;case G.STRING_DEFAULT:if(r===H.QUOTATION_MARK){const a=this.bufferedString.toString();this.state=G.START,this.onToken({token:at.STRING,value:a,offset:this.offset}),this.offset+=this.bufferedString.byteLength+1;continue}if(r===H.REVERSE_SOLIDUS){this.state=G.STRING_AFTER_BACKSLASH;continue}if(r>=128){if(r>=194&&r<=223?this.bytes_in_sequence=2:r<=239?this.bytes_in_sequence=3:this.bytes_in_sequence=4,this.bytes_in_sequence<=n.length-i){this.bufferedString.appendBuf(n,i,i+this.bytes_in_sequence),i+=this.bytes_in_sequence-1;continue}this.bytes_remaining=i+this.bytes_in_sequence-n.length,this.char_split_buffer.set(n.subarray(i)),i=n.length-1,this.state=G.STRING_INCOMPLETE_CHAR;continue}if(r>=H.SPACE){this.bufferedString.appendChar(r);continue}break;case G.STRING_INCOMPLETE_CHAR:this.char_split_buffer.set(n.subarray(i,i+this.bytes_remaining),this.bytes_in_sequence-this.bytes_remaining),this.bufferedString.appendBuf(this.char_split_buffer,0,this.bytes_in_sequence),i=this.bytes_remaining-1,this.state=G.STRING_DEFAULT;continue;case G.STRING_AFTER_BACKSLASH:const s=zi[r];if(s){this.bufferedString.appendChar(s),this.state=G.STRING_DEFAULT;continue}if(r===H.LATIN_SMALL_LETTER_U){this.unicode="",this.state=G.STRING_UNICODE_DIGIT_1;continue}break;case G.STRING_UNICODE_DIGIT_1:case G.STRING_UNICODE_DIGIT_2:case G.STRING_UNICODE_DIGIT_3:if(r>=H.DIGIT_ZERO&&r<=H.DIGIT_NINE||r>=H.LATIN_CAPITAL_LETTER_A&&r<=H.LATIN_CAPITAL_LETTER_F||r>=H.LATIN_SMALL_LETTER_A&&r<=H.LATIN_SMALL_LETTER_F){this.unicode+=String.fromCharCode(r),this.state+=1;continue}break;case G.STRING_UNICODE_DIGIT_4:if(r>=H.DIGIT_ZERO&&r<=H.DIGIT_NINE||r>=H.LATIN_CAPITAL_LETTER_A&&r<=H.LATIN_CAPITAL_LETTER_F||r>=H.LATIN_SMALL_LETTER_A&&r<=H.LATIN_SMALL_LETTER_F){const a=parseInt(this.unicode+String.fromCharCode(r),16);this.highSurrogate===void 0?a>=55296&&a<=56319?this.highSurrogate=a:this.bufferedString.appendBuf(this.encoder.encode(String.fromCharCode(a))):(a>=56320&&a<=57343?this.bufferedString.appendBuf(this.encoder.encode(String.fromCharCode(this.highSurrogate,a))):this.bufferedString.appendBuf(this.encoder.encode(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.state=G.STRING_DEFAULT;continue}break;case G.NUMBER_AFTER_INITIAL_MINUS:if(r===H.DIGIT_ZERO){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_INITIAL_ZERO;continue}if(r>=H.DIGIT_ONE&&r<=H.DIGIT_NINE){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_INITIAL_NON_ZERO;continue}break;case G.NUMBER_AFTER_INITIAL_ZERO:if(r===H.FULL_STOP){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_FULL_STOP;continue}if(r===H.LATIN_SMALL_LETTER_E||r===H.LATIN_CAPITAL_LETTER_E){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_E;continue}i-=1,this.state=G.START,this.emitNumber();continue;case G.NUMBER_AFTER_INITIAL_NON_ZERO:if(r>=H.DIGIT_ZERO&&r<=H.DIGIT_NINE){this.bufferedNumber.appendChar(r);continue}if(r===H.FULL_STOP){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_FULL_STOP;continue}if(r===H.LATIN_SMALL_LETTER_E||r===H.LATIN_CAPITAL_LETTER_E){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_E;continue}i-=1,this.state=G.START,this.emitNumber();continue;case G.NUMBER_AFTER_FULL_STOP:if(r>=H.DIGIT_ZERO&&r<=H.DIGIT_NINE){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_DECIMAL;continue}break;case G.NUMBER_AFTER_DECIMAL:if(r>=H.DIGIT_ZERO&&r<=H.DIGIT_NINE){this.bufferedNumber.appendChar(r);continue}if(r===H.LATIN_SMALL_LETTER_E||r===H.LATIN_CAPITAL_LETTER_E){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_E;continue}i-=1,this.state=G.START,this.emitNumber();continue;case G.NUMBER_AFTER_E:if(r===H.PLUS_SIGN||r===H.HYPHEN_MINUS){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_E_AND_SIGN;continue}case G.NUMBER_AFTER_E_AND_SIGN:if(r>=H.DIGIT_ZERO&&r<=H.DIGIT_NINE){this.bufferedNumber.appendChar(r),this.state=G.NUMBER_AFTER_E_AND_DIGIT;continue}break;case G.NUMBER_AFTER_E_AND_DIGIT:if(r>=H.DIGIT_ZERO&&r<=H.DIGIT_NINE){this.bufferedNumber.appendChar(r);continue}i-=1,this.state=G.START,this.emitNumber();continue;case G.TRUE1:if(r===H.LATIN_SMALL_LETTER_R){this.state=G.TRUE2;continue}break;case G.TRUE2:if(r===H.LATIN_SMALL_LETTER_U){this.state=G.TRUE3;continue}break;case G.TRUE3:if(r===H.LATIN_SMALL_LETTER_E){this.state=G.START,this.onToken({token:at.TRUE,value:!0,offset:this.offset}),this.offset+=3;continue}break;case G.FALSE1:if(r===H.LATIN_SMALL_LETTER_A){this.state=G.FALSE2;continue}break;case G.FALSE2:if(r===H.LATIN_SMALL_LETTER_L){this.state=G.FALSE3;continue}break;case G.FALSE3:if(r===H.LATIN_SMALL_LETTER_S){this.state=G.FALSE4;continue}break;case G.FALSE4:if(r===H.LATIN_SMALL_LETTER_E){this.state=G.START,this.onToken({token:at.FALSE,value:!1,offset:this.offset}),this.offset+=4;continue}break;case G.NULL1:if(r===H.LATIN_SMALL_LETTER_U){this.state=G.NULL2;continue}break;case G.NULL2:if(r===H.LATIN_SMALL_LETTER_L){this.state=G.NULL3;continue}break;case G.NULL3:if(r===H.LATIN_SMALL_LETTER_L){this.state=G.START,this.onToken({token:at.NULL,value:null,offset:this.offset}),this.offset+=3;continue}break;case G.SEPARATOR:if(this.separatorIndex+=1,!this.separatorBytes||r!==this.separatorBytes[this.separatorIndex])break;this.separatorIndex===this.separatorBytes.length-1&&(this.state=G.START,this.onToken({token:at.SEPARATOR,value:this.separator,offset:this.offset+this.separatorIndex}),this.separatorIndex=0);continue;case G.BOM:if(r===this.bom[this.bomIndex]){if(this.bomIndex===this.bom.length-1){this.state=G.START,this.bom=void 0,this.bomIndex=0;continue}this.bomIndex+=1;continue}break;case G.ENDED:if(r===H.SPACE||r===H.NEWLINE||r===H.CARRIAGE_RETURN||r===H.TAB)continue}throw new Ae(`Unexpected "${String.fromCharCode(r)}" at position "${i}" in state ${Lr(this.state)}`)}if(this.emitPartialTokens)switch(this.state){case G.TRUE1:case G.TRUE2:case G.TRUE3:this.onToken({token:at.TRUE,value:!0,offset:this.offset,partial:!0});break;case G.FALSE1:case G.FALSE2:case G.FALSE3:case G.FALSE4:this.onToken({token:at.FALSE,value:!1,offset:this.offset,partial:!0});break;case G.NULL1:case G.NULL2:case G.NULL3:this.onToken({token:at.NULL,value:null,offset:this.offset,partial:!0});break;case G.STRING_DEFAULT:{const i=this.bufferedString.toString();this.onToken({token:at.STRING,value:i,offset:this.offset,partial:!0});break}case G.NUMBER_AFTER_INITIAL_ZERO:case G.NUMBER_AFTER_INITIAL_NON_ZERO:case G.NUMBER_AFTER_DECIMAL:case G.NUMBER_AFTER_E_AND_DIGIT:try{this.onToken({token:at.NUMBER,value:this.parseNumber(this.bufferedNumber.toString()),offset:this.offset,partial:!0})}catch{}}}catch(n){this.error(n)}}emitNumber(){this.onToken({token:at.NUMBER,value:this.parseNumber(this.bufferedNumber.toString()),offset:this.offset}),this.offset+=this.bufferedNumber.byteLength-1}parseNumber(e){return Number(e)}error(e){this.state!==G.ENDED&&(this.state=G.ERROR),this.onError(e)}end(){switch(this.state){case G.NUMBER_AFTER_INITIAL_ZERO:case G.NUMBER_AFTER_INITIAL_NON_ZERO:case G.NUMBER_AFTER_DECIMAL:case G.NUMBER_AFTER_E_AND_DIGIT:this.state=G.ENDED,this.emitNumber(),this.onEnd();break;case G.BOM_OR_START:case G.START:case G.ERROR:case G.SEPARATOR:this.state=G.ENDED,this.onEnd();break;default:this.error(new Ae(`Tokenizer ended in the middle of a token (state: ${Lr(this.state)}). Either not all the data was received or the data was invalid.`))}}onToken(e){throw new Ae(`Can't emit tokens before the "onToken" callback has been set up.`)}onError(e){throw e}onEnd(){}}var It;(function(t){t[t.OBJECT=0]="OBJECT",t[t.ARRAY=1]="ARRAY"})(It||(It={}));var ht;(function(t){t[t.VALUE=0]="VALUE",t[t.KEY=1]="KEY",t[t.COLON=2]="COLON",t[t.COMMA=3]="COMMA",t[t.ENDED=4]="ENDED",t[t.ERROR=5]="ERROR",t[t.SEPARATOR=6]="SEPARATOR"})(ht||(ht={}));function kr(t){return["VALUE","KEY","COLON","COMMA","ENDED","ERROR","SEPARATOR"][t]}const ji={paths:void 0,keepStack:!0,separator:void 0,emitPartialValues:!1};class ue extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ue.prototype)}}class Nr{constructor(e){this.state=ht.VALUE,this.mode=void 0,this.key=void 0,this.value=void 0,this.stack=[],e=Object.assign(Object.assign({},ji),e),e.paths&&(this.paths=e.paths.map(n=>{if(n===void 0||n==="$*")return;if(!n.startsWith("$"))throw new ue(`Invalid selector "${n}". Should start with "$".`);const i=n.split(".").slice(1);if(i.includes(""))throw new ue(`Invalid selector "${n}". ".." syntax not supported.`);return i})),this.keepStack=e.keepStack||!1,this.separator=e.separator,e.emitPartialValues||(this.emitPartial=()=>{})}shouldEmit(){return this.paths?this.paths.some(e=>{var n;if(e===void 0)return!0;if(e.length!==this.stack.length)return!1;for(let r=0;r<e.length-1;r++){const s=e[r],a=this.stack[r+1].key;if(s!=="*"&&s!==a)return!1}const i=e[e.length-1];return i==="*"?!0:i===((n=this.key)===null||n===void 0?void 0:n.toString())}):!0}push(){this.stack.push({key:this.key,value:this.value,mode:this.mode,emit:this.shouldEmit()})}pop(){const e=this.value;let n;({key:this.key,value:this.value,mode:this.mode,emit:n}=this.stack.pop()),this.state=this.mode!==void 0?ht.COMMA:ht.VALUE,this.emit(e,n)}emit(e,n){!this.keepStack&&this.value&&this.stack.every(i=>!i.emit)&&delete this.value[this.key],n&&this.onValue({value:e,key:this.key,parent:this.value,stack:this.stack}),this.stack.length===0&&(this.separator?this.state=ht.SEPARATOR:this.separator===void 0&&this.end())}emitPartial(e){if(this.shouldEmit()){if(this.state===ht.KEY){this.onValue({value:void 0,key:e,parent:this.value,stack:this.stack,partial:!0});return}this.onValue({value:e,key:this.key,parent:this.value,stack:this.stack,partial:!0})}}get isEnded(){return this.state===ht.ENDED}write({token:e,value:n,partial:i}){try{if(i){this.emitPartial(n);return}if(this.state===ht.VALUE){if(e===at.STRING||e===at.NUMBER||e===at.TRUE||e===at.FALSE||e===at.NULL){this.mode===It.OBJECT?(this.value[this.key]=n,this.state=ht.COMMA):this.mode===It.ARRAY&&(this.value.push(n),this.state=ht.COMMA),this.emit(n,this.shouldEmit());return}if(e===at.LEFT_BRACE){if(this.push(),this.mode===It.OBJECT)this.value=this.value[this.key]={};else if(this.mode===It.ARRAY){const r={};this.value.push(r),this.value=r}else this.value={};this.mode=It.OBJECT,this.state=ht.KEY,this.key=void 0,this.emitPartial();return}if(e===at.LEFT_BRACKET){if(this.push(),this.mode===It.OBJECT)this.value=this.value[this.key]=[];else if(this.mode===It.ARRAY){const r=[];this.value.push(r),this.value=r}else this.value=[];this.mode=It.ARRAY,this.state=ht.VALUE,this.key=0,this.emitPartial();return}if(this.mode===It.ARRAY&&e===at.RIGHT_BRACKET&&this.value.length===0){this.pop();return}}if(this.state===ht.KEY){if(e===at.STRING){this.key=n,this.state=ht.COLON,this.emitPartial();return}if(e===at.RIGHT_BRACE&&Object.keys(this.value).length===0){this.pop();return}}if(this.state===ht.COLON&&e===at.COLON){this.state=ht.VALUE;return}if(this.state===ht.COMMA){if(e===at.COMMA){if(this.mode===It.ARRAY){this.state=ht.VALUE,this.key+=1;return}if(this.mode===It.OBJECT){this.state=ht.KEY;return}}if(e===at.RIGHT_BRACE&&this.mode===It.OBJECT||e===at.RIGHT_BRACKET&&this.mode===It.ARRAY){this.pop();return}}if(this.state===ht.SEPARATOR&&e===at.SEPARATOR&&n===this.separator){this.state=ht.VALUE;return}throw new ue(`Unexpected ${at[e]} (${JSON.stringify(n)}) in state ${kr(this.state)}`)}catch(r){this.error(r)}}error(e){this.state!==ht.ENDED&&(this.state=ht.ERROR),this.onError(e)}end(){this.state!==ht.VALUE&&this.state!==ht.SEPARATOR||this.stack.length>0?this.error(new Error(`Parser ended in mid-parsing (state: ${kr(this.state)}). Either not all the data was received or the data was invalid.`)):(this.state=ht.ENDED,this.onEnd())}onValue(e){throw new ue(`Can't emit data before the "onValue" callback has been set up.`)}onError(e){throw e}onEnd(){}}class Ki{constructor(e={}){this.tokenizer=new Sr(e),this.tokenParser=new Nr(e),this.tokenizer.onToken=this.tokenParser.write.bind(this.tokenParser),this.tokenizer.onEnd=()=>{this.tokenParser.isEnded||this.tokenParser.end()},this.tokenParser.onError=this.tokenizer.error.bind(this.tokenizer),this.tokenParser.onEnd=()=>{this.tokenizer.isEnded||this.tokenizer.end()}}get isEnded(){return this.tokenizer.isEnded&&this.tokenParser.isEnded}write(e){this.tokenizer.write(e)}end(){this.tokenizer.end()}set onToken(e){this.tokenizer.onToken=n=>{e(n),this.tokenParser.write(n)}}set onValue(e){this.tokenParser.onValue=e}set onError(e){this.tokenizer.onError=e}set onEnd(e){this.tokenParser.onEnd=()=>{this.tokenizer.isEnded||this.tokenizer.end(),e.call(this.tokenParser)}}}function Cr(t){const{value:e,key:n,parent:i,stack:r,partial:s}=t;return{value:e,key:n,parent:xr(i),stack:xr(r),partial:s}}function xr(t){return typeof t!="object"||Array.isArray(t)&&t.filter(e=>e).length===0?t:JSON.parse(JSON.stringify(t))}class Wi extends Ki{constructor(e){super(e),this.onValue=n=>this.controller.enqueue(Cr(n)),this.onError=n=>this.controller.error(n),this.onEnd=()=>this.controller.terminate()}start(e){this.controller=e}transform(e){this.write(e)}flush(){this.end()}}class Zi extends TransformStream{constructor(e,n,i){const r=new Wi(e);super(r,n,i)}}class Hi extends Sr{constructor(e){super(e),this.onToken=n=>this.controller.enqueue(n),this.onError=n=>this.controller.error(n),this.onEnd=()=>this.controller.terminate()}start(e){this.controller=e}transform(e){this.write(e)}flush(){this.end()}}class aa extends TransformStream{constructor(e,n,i){const r=new Hi(e);super(r,n,i)}}class qi extends Nr{constructor(e){super(e),this.onValue=n=>this.controller.enqueue(Cr(n)),this.onError=n=>this.controller.error(n),this.onEnd=()=>this.controller.terminate()}start(e){this.controller=e}transform(e){this.write(e)}flush(){this.end()}}class oa extends TransformStream{constructor(e,n,i){const r=new qi(e);super(r,n,i)}}function Vi(t){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(const s of t)for(const a of s)for(const o of a){let u=o[0],g=o[1];u<e&&(e=u),u>n&&(n=u),g<i&&(i=g),g>r&&(r=g)}return{topLeft:{lng:e,lat:r},bottomRight:{lng:n,lat:i}}}function $i(t,e){const n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function Yi(t,e,n){let i=e[0],r=e[1],s=n[0]-i,a=n[1]-r;if(s!==0||a!==0){const o=((t[0]-i)*s+(t[1]-r)*a)/(s*s+a*a);o>1?(i=n[0],r=n[1]):o>0&&(i+=s*o,r+=a*o)}return s=t[0]-i,a=t[1]-r,s*s+a*a}function Xi(t,e){let n=t[0];const i=[n];let r=null;for(let s=1,a=t.length;s<a;s++)r=t[s],$i(r,n)>e&&(i.push(r),n=r);return n!==r&&i.push(r),i}function Sn(t,e,n,i,r){let s=i,a=0;for(let o=e+1;o<n;o++){const u=Yi(t[o],t[e],t[n]);u>s&&(a=o,s=u)}s>i&&(a-e>1&&Sn(t,e,a,i,r),r.push(t[a]),n-a>1&&Sn(t,a,n,i,r))}function Ji(t,e){const n=t.length-1,i=[t[0]];return Sn(t,0,n,e,i),i.push(t[n]),i}function Qi(t,e,n){if(t.length<=2)return t;const i=e!==void 0?e*e:1;return t=n?t:Xi(t,i),t=Ji(t,i),t}function Ht(t,e=1e4){return Math.round((t[0]+180)*e)*(1e3*e)+Math.round((t[1]+90)*e)}function ts(t,e){const n=[],i=t.map(a=>{const o=Ht(a);return e.has(o)});let r=0,s=i[0];for(let a=1;a<=i.length;a++)(a===i.length||i[a]!==s)&&(n.push({isCached:s,startIndex:r,endIndex:a-1}),r=a,s=a<i.length?i[a]:!s);return n}function es(t,e,n,i){let r=0,s=0;for(;r<e.length&&s<n.length;){const a=n[s],o=Ht(a),u=e[r],g=Ht(u);i.set(g,o),g===o?(r++,s++):r++}return i}const ns=new Map;function rs(t,e,n,i,r){return e.map((s,a)=>s.map((o,u)=>{const g=[];return ts(o,r).forEach((_,d)=>{if(_.isCached)for(let l=_.startIndex;l<=_.endIndex;l++){const b=o[l],h=Ht(b);r.get(h)===h&&g.push(b)}else{const l=o.slice(_.startIndex,_.endIndex+1),b=Qi(l,n,i);l.length>0&&b.length>0&&(Ht(l[0])!==Ht(b[0])&&b.unshift(l[0]),Ht(l[l.length-1])!==Ht(b[b.length-1])&&b.push(l[l.length-1])),g.push(...b),es(t,l,b,r)}}),g}).filter(o=>o.length>2)).filter(s=>s.length>0)}const is=.05,ss=async({db:t,stream:e,fileName:n,fileSize:i,startedCallback:r,progressCallback:s,errorCallback:a,finishedCallback:o,cancelCallback:u})=>{let m=[],_=[],d=[];const l=new Zi({stringBufferSize:void 0,paths:["$.features"],keepStack:!1}),b=async(f,y,v)=>{f.bulkAdd(y).catch(I=>{a(v,I.message)})};let h=0;const E=async f=>{r(n,t.name),f.getReader().read().then(y=>{const{done:v,value:I}=y;if(v)return;const w=I.value;h+=w.length,w.forEach((k,L)=>{const{COUNTRY:O,NAME_1:S,NAME_2:M,GID_0:Z,GID_1:R,GID_2:P}=k.properties,p=k.geometry.coordinates,U=rs(`${O}	${S}	${M}`,p,is,!0,ns),tt={},z=Vi(U);for(let j=0;j<=Qt;j++){const Q=In(z.topLeft,z.bottomRight,j);if(Q.length===0)tt[`z${j}`]=wr.NOT_CONTAINED;else if(Q.length===1)if(Q[0].length===1)tt[`z${j}`]=Q[0][0];else if(Q[0].length>=2)tt[`z${j}`]=tt[`z${j-1}`];else throw new Error;else if(Q.length===2)Q[1].length===1?tt[`z${j}_`]=Q[1][0]:Q[1].length>=2&&(tt[`z${j}_`]=tt[`z${j-1}_`]);else throw new Error("mortonNumber.length > 2 :"+Q.join(" ,"))}const et={country:O,gid_0:Z,coordinates:U,...tt};et.coordinates.length>0&&et.country&&(S?M?d.push({...et,name_1:S,gid_1:R,name_2:M,gid_2:P,name:et.name_2}):_.push({...et,name_1:S,gid_1:R,name:et.name_1}):m.push({...et,name:et.country}),s({type:Zt.progress,progress:L/w.length*100,index:L,total:h,unit:"items",fileName:n,fileSize:i||-1}),m.length===64&&(b(t.countries,m,n),m=[]),_.length===64&&(b(t.regions1,_,n),_=[]),d.length===64&&(b(t.regions2,d,n),d=[]))}),m.length>0&&b(t.countries,m,n),_.length>0&&b(t.regions1,_,n),d.length>0&&b(t.regions2,d,n),s({type:Zt.progress,fileName:n,fileSize:i,progress:100,total:h,index:h,unit:"items_end"}),o(n)})};try{await E(e.pipeThrough(l))}catch(f){console.error(f),a(n,f.message);return}};var Ve=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function as(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function $e(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Or={exports:{}};/*!

  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>

  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  */(function(t,e){(function(n){t.exports=n()})(function(){return function n(i,r,s){function a(g,m){if(!r[g]){if(!i[g]){var _=typeof $e=="function"&&$e;if(!m&&_)return _(g,!0);if(o)return o(g,!0);var d=new Error("Cannot find module '"+g+"'");throw d.code="MODULE_NOT_FOUND",d}var l=r[g]={exports:{}};i[g][0].call(l.exports,function(b){var h=i[g][1][b];return a(h||b)},l,l.exports,n,i,r,s)}return r[g].exports}for(var o=typeof $e=="function"&&$e,u=0;u<s.length;u++)a(s[u]);return a}({1:[function(n,i,r){var s=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(u){for(var g,m,_,d,l,b,h,E=[],f=0,y=u.length,v=y,I=s.getTypeOf(u)!=="string";f<u.length;)v=y-f,_=I?(g=u[f++],m=f<y?u[f++]:0,f<y?u[f++]:0):(g=u.charCodeAt(f++),m=f<y?u.charCodeAt(f++):0,f<y?u.charCodeAt(f++):0),d=g>>2,l=(3&g)<<4|m>>4,b=1<v?(15&m)<<2|_>>6:64,h=2<v?63&_:64,E.push(o.charAt(d)+o.charAt(l)+o.charAt(b)+o.charAt(h));return E.join("")},r.decode=function(u){var g,m,_,d,l,b,h=0,E=0,f="data:";if(u.substr(0,f.length)===f)throw new Error("Invalid base64 input, it looks like a data url.");var y,v=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===o.charAt(64)&&v--,u.charAt(u.length-2)===o.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=a.uint8array?new Uint8Array(0|v):new Array(0|v);h<u.length;)g=o.indexOf(u.charAt(h++))<<2|(d=o.indexOf(u.charAt(h++)))>>4,m=(15&d)<<4|(l=o.indexOf(u.charAt(h++)))>>2,_=(3&l)<<6|(b=o.indexOf(u.charAt(h++))),y[E++]=g,l!==64&&(y[E++]=m),b!==64&&(y[E++]=_);return y}},{"./support":30,"./utils":32}],2:[function(n,i,r){var s=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),u=n("./stream/DataLengthProbe");function g(m,_,d,l,b){this.compressedSize=m,this.uncompressedSize=_,this.crc32=d,this.compression=l,this.compressedContent=b}g.prototype={getContentWorker:function(){var m=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),_=this;return m.on("end",function(){if(this.streamInfo.data_length!==_.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(m,_,d){return m.pipe(new o).pipe(new u("uncompressedSize")).pipe(_.compressWorker(d)).pipe(new u("compressedSize")).withStreamInfo("compression",_)},i.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,i,r){var s=n("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},r.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,i,r){var s=n("./utils"),a=function(){for(var o,u=[],g=0;g<256;g++){o=g;for(var m=0;m<8;m++)o=1&o?3988292384^o>>>1:o>>>1;u[g]=o}return u}();i.exports=function(o,u){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?function(g,m,_,d){var l=a,b=d+_;g^=-1;for(var h=d;h<b;h++)g=g>>>8^l[255&(g^m[h])];return-1^g}(0|u,o,o.length,0):function(g,m,_,d){var l=a,b=d+_;g^=-1;for(var h=d;h<b;h++)g=g>>>8^l[255&(g^m.charCodeAt(h))];return-1^g}(0|u,o,o.length,0):0}},{"./utils":32}],5:[function(n,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(n,i,r){var s=null;s=typeof Promise<"u"?Promise:n("lie"),i.exports={Promise:s}},{lie:37}],7:[function(n,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),u=n("./stream/GenericWorker"),g=s?"uint8array":"array";function m(_,d){u.call(this,"FlateWorker/"+_),this._pako=null,this._pakoAction=_,this._pakoOptions=d,this.meta={}}r.magic="\b\0",o.inherits(m,u),m.prototype.processChunk=function(_){this.meta=_.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(g,_.data),!1)},m.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var _=this;this._pako.onData=function(d){_.push({data:d,meta:_.meta})}},r.compressWorker=function(_){return new m("Deflate",_)},r.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,i,r){function s(l,b){var h,E="";for(h=0;h<b;h++)E+=String.fromCharCode(255&l),l>>>=8;return E}function a(l,b,h,E,f,y){var v,I,w=l.file,k=l.compression,L=y!==g.utf8encode,O=o.transformTo("string",y(w.name)),S=o.transformTo("string",g.utf8encode(w.name)),M=w.comment,Z=o.transformTo("string",y(M)),R=o.transformTo("string",g.utf8encode(M)),P=S.length!==w.name.length,p=R.length!==M.length,U="",tt="",z="",et=w.dir,j=w.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};b&&!h||(Q.crc32=l.crc32,Q.compressedSize=l.compressedSize,Q.uncompressedSize=l.uncompressedSize);var D=0;b&&(D|=8),L||!P&&!p||(D|=2048);var x=0,it=0;et&&(x|=16),f==="UNIX"?(it=798,x|=function($,_t){var wt=$;return $||(wt=_t?16893:33204),(65535&wt)<<16}(w.unixPermissions,et)):(it=20,x|=function($){return 63&($||0)}(w.dosPermissions)),v=j.getUTCHours(),v<<=6,v|=j.getUTCMinutes(),v<<=5,v|=j.getUTCSeconds()/2,I=j.getUTCFullYear()-1980,I<<=4,I|=j.getUTCMonth()+1,I<<=5,I|=j.getUTCDate(),P&&(tt=s(1,1)+s(m(O),4)+S,U+="up"+s(tt.length,2)+tt),p&&(z=s(1,1)+s(m(Z),4)+R,U+="uc"+s(z.length,2)+z);var X="";return X+=`
\0`,X+=s(D,2),X+=k.magic,X+=s(v,2),X+=s(I,2),X+=s(Q.crc32,4),X+=s(Q.compressedSize,4),X+=s(Q.uncompressedSize,4),X+=s(O.length,2),X+=s(U.length,2),{fileRecord:_.LOCAL_FILE_HEADER+X+O+U,dirRecord:_.CENTRAL_FILE_HEADER+s(it,2)+X+s(Z.length,2)+"\0\0\0\0"+s(x,4)+s(E,4)+O+U+Z}}var o=n("../utils"),u=n("../stream/GenericWorker"),g=n("../utf8"),m=n("../crc32"),_=n("../signature");function d(l,b,h,E){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=h,this.encodeFileName=E,this.streamFiles=l,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(d,u),d.prototype.push=function(l){var b=l.meta.percent||0,h=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(l):(this.bytesWritten+=l.data.length,u.prototype.push.call(this,{data:l.data,meta:{currentFile:this.currentFile,percent:h?(b+100*(h-E-1))/h:100}}))},d.prototype.openedSource=function(l){this.currentSourceOffset=this.bytesWritten,this.currentFile=l.file.name;var b=this.streamFiles&&!l.file.dir;if(b){var h=a(l,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(l){this.accumulate=!1;var b=this.streamFiles&&!l.file.dir,h=a(l,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),b)this.push({data:function(E){return _.DATA_DESCRIPTOR+s(E.crc32,4)+s(E.compressedSize,4)+s(E.uncompressedSize,4)}(l),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var l=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var h=this.bytesWritten-l,E=function(f,y,v,I,w){var k=o.transformTo("string",w(I));return _.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(f,2)+s(f,2)+s(y,4)+s(v,4)+s(k.length,2)+k}(this.dirRecords.length,h,l,this.zipComment,this.encodeFileName);this.push({data:E,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(l){this._sources.push(l);var b=this;return l.on("data",function(h){b.processChunk(h)}),l.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),l.on("error",function(h){b.error(h)}),this},d.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(l){var b=this._sources;if(!u.prototype.error.call(this,l))return!1;for(var h=0;h<b.length;h++)try{b[h].error(l)}catch{}return!0},d.prototype.lock=function(){u.prototype.lock.call(this);for(var l=this._sources,b=0;b<l.length;b++)l[b].lock()},i.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,i,r){var s=n("../compressions"),a=n("./ZipFileWorker");r.generateWorker=function(o,u,g){var m=new a(u.streamFiles,g,u.platform,u.encodeFileName),_=0;try{o.forEach(function(d,l){_++;var b=function(y,v){var I=y||v,w=s[I];if(!w)throw new Error(I+" is not a valid compression method !");return w}(l.options.compression,u.compression),h=l.options.compressionOptions||u.compressionOptions||{},E=l.dir,f=l.date;l._compressWorker(b,h).withStreamInfo("file",{name:d,dir:E,date:f,comment:l.comment||"",unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions}).pipe(m)}),m.entriesCount=_}catch(d){m.error(d)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,i,r){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=n("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,i,r){var s=n("./utils"),a=n("./external"),o=n("./utf8"),u=n("./zipEntries"),g=n("./stream/Crc32Probe"),m=n("./nodejsUtils");function _(d){return new a.Promise(function(l,b){var h=d.decompressed.getContentWorker().pipe(new g);h.on("error",function(E){b(E)}).on("end",function(){h.streamInfo.crc32!==d.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):l()}).resume()})}i.exports=function(d,l){var b=this;return l=s.extend(l||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),m.isNode&&m.isStream(d)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",d,!0,l.optimizedBinaryString,l.base64).then(function(h){var E=new u(l);return E.load(h),E}).then(function(h){var E=[a.Promise.resolve(h)],f=h.files;if(l.checkCRC32)for(var y=0;y<f.length;y++)E.push(_(f[y]));return a.Promise.all(E)}).then(function(h){for(var E=h.shift(),f=E.files,y=0;y<f.length;y++){var v=f[y],I=v.fileNameStr,w=s.resolve(v.fileNameStr);b.file(w,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:l.createFolders}),v.dir||(b.file(w).unsafeOriginalName=I)}return E.zipComment.length&&(b.comment=E.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,i,r){var s=n("../utils"),a=n("../stream/GenericWorker");function o(u,g){a.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(g)}s.inherits(o,a),o.prototype._bindStream=function(u){var g=this;(this._stream=u).pause(),u.on("data",function(m){g.push({data:m,meta:{percent:0}})}).on("error",function(m){g.isPaused?this.generatedError=m:g.error(m)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,i,r){var s=n("readable-stream").Readable;function a(o,u,g){s.call(this,u),this._helper=o;var m=this;o.on("data",function(_,d){m.push(_)||m._helper.pause(),g&&g(d)}).on("error",function(_){m.emit("error",_)}).on("end",function(){m.push(null)})}n("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},i.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,i,r){function s(w,k,L){var O,S=o.getTypeOf(k),M=o.extend(L||{},m);M.date=M.date||new Date,M.compression!==null&&(M.compression=M.compression.toUpperCase()),typeof M.unixPermissions=="string"&&(M.unixPermissions=parseInt(M.unixPermissions,8)),M.unixPermissions&&16384&M.unixPermissions&&(M.dir=!0),M.dosPermissions&&16&M.dosPermissions&&(M.dir=!0),M.dir&&(w=f(w)),M.createFolders&&(O=E(w))&&y.call(this,O,!0);var Z=S==="string"&&M.binary===!1&&M.base64===!1;L&&L.binary!==void 0||(M.binary=!Z),(k instanceof _&&k.uncompressedSize===0||M.dir||!k||k.length===0)&&(M.base64=!1,M.binary=!0,k="",M.compression="STORE",S="string");var R=null;R=k instanceof _||k instanceof u?k:b.isNode&&b.isStream(k)?new h(w,k):o.prepareContent(w,k,M.binary,M.optimizedBinaryString,M.base64);var P=new d(w,R,M);this.files[w]=P}var a=n("./utf8"),o=n("./utils"),u=n("./stream/GenericWorker"),g=n("./stream/StreamHelper"),m=n("./defaults"),_=n("./compressedObject"),d=n("./zipObject"),l=n("./generate"),b=n("./nodejsUtils"),h=n("./nodejs/NodejsStreamInputAdapter"),E=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var k=w.lastIndexOf("/");return 0<k?w.substring(0,k):""},f=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},y=function(w,k){return k=k!==void 0?k:m.createFolders,w=f(w),this.files[w]||s.call(this,w,null,{dir:!0,createFolders:k}),this.files[w]};function v(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var I={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var k,L,O;for(k in this.files)O=this.files[k],(L=k.slice(this.root.length,k.length))&&k.slice(0,this.root.length)===this.root&&w(L,O)},filter:function(w){var k=[];return this.forEach(function(L,O){w(L,O)&&k.push(O)}),k},file:function(w,k,L){if(arguments.length!==1)return w=this.root+w,s.call(this,w,k,L),this;if(v(w)){var O=w;return this.filter(function(M,Z){return!Z.dir&&O.test(M)})}var S=this.files[this.root+w];return S&&!S.dir?S:null},folder:function(w){if(!w)return this;if(v(w))return this.filter(function(S,M){return M.dir&&w.test(S)});var k=this.root+w,L=y.call(this,k),O=this.clone();return O.root=L.name,O},remove:function(w){w=this.root+w;var k=this.files[w];if(k||(w.slice(-1)!=="/"&&(w+="/"),k=this.files[w]),k&&!k.dir)delete this.files[w];else for(var L=this.filter(function(S,M){return M.name.slice(0,w.length)===w}),O=0;O<L.length;O++)delete this.files[L[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var k,L={};try{if((L=o.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=L.type.toLowerCase(),L.compression=L.compression.toUpperCase(),L.type==="binarystring"&&(L.type="string"),!L.type)throw new Error("No output type specified.");o.checkSupport(L.type),L.platform!=="darwin"&&L.platform!=="freebsd"&&L.platform!=="linux"&&L.platform!=="sunos"||(L.platform="UNIX"),L.platform==="win32"&&(L.platform="DOS");var O=L.comment||this.comment||"";k=l.generateWorker(this,L,O)}catch(S){(k=new u("error")).error(S)}return new g(k,L.type||"string",L.mimeType)},generateAsync:function(w,k){return this.generateInternalStream(w).accumulate(k)},generateNodeStream:function(w,k){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(k)}};i.exports=I},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,i,r){i.exports=n("stream")},{stream:void 0}],17:[function(n,i,r){var s=n("./DataReader");function a(o){s.call(this,o);for(var u=0;u<this.data.length;u++)o[u]=255&o[u]}n("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var u=o.charCodeAt(0),g=o.charCodeAt(1),m=o.charCodeAt(2),_=o.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===u&&this.data[d+1]===g&&this.data[d+2]===m&&this.data[d+3]===_)return d-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var u=o.charCodeAt(0),g=o.charCodeAt(1),m=o.charCodeAt(2),_=o.charCodeAt(3),d=this.readData(4);return u===d[0]&&g===d[1]&&m===d[2]&&_===d[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,u},i.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,i,r){var s=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var u,g=0;for(this.checkOffset(o),u=this.index+o-1;u>=this.index;u--)g=(g<<8)+this.byteAt(u);return this.index+=o,g},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},i.exports=a},{"../utils":32}],19:[function(n,i,r){var s=n("./Uint8ArrayReader");function a(o){s.call(this,o)}n("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var u=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,u},i.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,i,r){var s=n("./DataReader");function a(o){s.call(this,o)}n("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var u=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,u},i.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,i,r){var s=n("./ArrayReader");function a(o){s.call(this,o)}n("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,u},i.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,i,r){var s=n("../utils"),a=n("../support"),o=n("./ArrayReader"),u=n("./StringReader"),g=n("./NodeBufferReader"),m=n("./Uint8ArrayReader");i.exports=function(_){var d=s.getTypeOf(_);return s.checkSupport(d),d!=="string"||a.uint8array?d==="nodebuffer"?new g(_):a.uint8array?new m(s.transformTo("uint8array",_)):new o(s.transformTo("array",_)):new u(_)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,i,r){var s=n("./GenericWorker"),a=n("../utils");function o(u){s.call(this,"ConvertWorker to "+u),this.destType=u}a.inherits(o,s),o.prototype.processChunk=function(u){this.push({data:a.transformTo(this.destType,u.data),meta:u.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,i,r){var s=n("./GenericWorker"),a=n("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,s),o.prototype.processChunk=function(u){this.streamInfo.crc32=a(u.data,this.streamInfo.crc32||0),this.push(u)},i.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,i,r){var s=n("../utils"),a=n("./GenericWorker");function o(u){a.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}s.inherits(o,a),o.prototype.processChunk=function(u){if(u){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+u.data.length}a.prototype.processChunk.call(this,u)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,i,r){var s=n("../utils"),a=n("./GenericWorker");function o(u){a.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(m){g.dataIsReady=!0,g.data=m,g.max=m&&m.length||0,g.type=s.getTypeOf(m),g.isPaused||g._tickAndRepeat()},function(m){g.error(m)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,g);break;case"uint8array":u=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":u=this.data.slice(this.index,g)}return this.index=g,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,i,r){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var u=0;u<this._listeners[a].length;u++)this._listeners[a][u].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(u){o.processChunk(u)}),a.on("end",function(){o.end()}),a.on("error",function(u){o.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=s},{}],29:[function(n,i,r){var s=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),u=n("../base64"),g=n("../support"),m=n("../external"),_=null;if(g.nodestream)try{_=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(b,h){return new m.Promise(function(E,f){var y=[],v=b._internalType,I=b._outputType,w=b._mimeType;b.on("data",function(k,L){y.push(k),h&&h(L)}).on("error",function(k){y=[],f(k)}).on("end",function(){try{var k=function(L,O,S){switch(L){case"blob":return s.newBlob(s.transformTo("arraybuffer",O),S);case"base64":return u.encode(O);default:return s.transformTo(L,O)}}(I,function(L,O){var S,M=0,Z=null,R=0;for(S=0;S<O.length;S++)R+=O[S].length;switch(L){case"string":return O.join("");case"array":return Array.prototype.concat.apply([],O);case"uint8array":for(Z=new Uint8Array(R),S=0;S<O.length;S++)Z.set(O[S],M),M+=O[S].length;return Z;case"nodebuffer":return Buffer.concat(O);default:throw new Error("concat : unsupported type '"+L+"'")}}(v,y),w);E(k)}catch(L){f(L)}y=[]}).resume()})}function l(b,h,E){var f=h;switch(h){case"blob":case"arraybuffer":f="uint8array";break;case"base64":f="string"}try{this._internalType=f,this._outputType=h,this._mimeType=E,s.checkSupport(f),this._worker=b.pipe(new a(f)),b.lock()}catch(y){this._worker=new o("error"),this._worker.error(y)}}l.prototype={accumulate:function(b){return d(this,b)},on:function(b,h){var E=this;return b==="data"?this._worker.on(b,function(f){h.call(E,f.data,f.meta)}):this._worker.on(b,function(){s.delay(h,arguments,E)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new _(this,{objectMode:this._outputType!=="nodebuffer"},b)}},i.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var s=new ArrayBuffer(0);try{r.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),r.blob=a.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!n("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(n,i,r){for(var s=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),u=n("./stream/GenericWorker"),g=new Array(256),m=0;m<256;m++)g[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;g[254]=g[254]=1;function _(){u.call(this,"utf-8 decode"),this.leftOver=null}function d(){u.call(this,"utf-8 encode")}r.utf8encode=function(l){return a.nodebuffer?o.newBufferFrom(l,"utf-8"):function(b){var h,E,f,y,v,I=b.length,w=0;for(y=0;y<I;y++)(64512&(E=b.charCodeAt(y)))==55296&&y+1<I&&(64512&(f=b.charCodeAt(y+1)))==56320&&(E=65536+(E-55296<<10)+(f-56320),y++),w+=E<128?1:E<2048?2:E<65536?3:4;for(h=a.uint8array?new Uint8Array(w):new Array(w),y=v=0;v<w;y++)(64512&(E=b.charCodeAt(y)))==55296&&y+1<I&&(64512&(f=b.charCodeAt(y+1)))==56320&&(E=65536+(E-55296<<10)+(f-56320),y++),E<128?h[v++]=E:(E<2048?h[v++]=192|E>>>6:(E<65536?h[v++]=224|E>>>12:(h[v++]=240|E>>>18,h[v++]=128|E>>>12&63),h[v++]=128|E>>>6&63),h[v++]=128|63&E);return h}(l)},r.utf8decode=function(l){return a.nodebuffer?s.transformTo("nodebuffer",l).toString("utf-8"):function(b){var h,E,f,y,v=b.length,I=new Array(2*v);for(h=E=0;h<v;)if((f=b[h++])<128)I[E++]=f;else if(4<(y=g[f]))I[E++]=65533,h+=y-1;else{for(f&=y===2?31:y===3?15:7;1<y&&h<v;)f=f<<6|63&b[h++],y--;1<y?I[E++]=65533:f<65536?I[E++]=f:(f-=65536,I[E++]=55296|f>>10&1023,I[E++]=56320|1023&f)}return I.length!==E&&(I.subarray?I=I.subarray(0,E):I.length=E),s.applyFromCharCode(I)}(l=s.transformTo(a.uint8array?"uint8array":"array",l))},s.inherits(_,u),_.prototype.processChunk=function(l){var b=s.transformTo(a.uint8array?"uint8array":"array",l.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var h=b;(b=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),b.set(h,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var E=function(y,v){var I;for((v=v||y.length)>y.length&&(v=y.length),I=v-1;0<=I&&(192&y[I])==128;)I--;return I<0||I===0?v:I+g[y[I]]>v?I:v}(b),f=b;E!==b.length&&(a.uint8array?(f=b.subarray(0,E),this.leftOver=b.subarray(E,b.length)):(f=b.slice(0,E),this.leftOver=b.slice(E,b.length))),this.push({data:r.utf8decode(f),meta:l.meta})},_.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=_,s.inherits(d,u),d.prototype.processChunk=function(l){this.push({data:r.utf8encode(l.data),meta:l.meta})},r.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,i,r){var s=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),u=n("./external");function g(h){return h}function m(h,E){for(var f=0;f<h.length;++f)E[f]=255&h.charCodeAt(f);return E}n("setimmediate"),r.newBlob=function(h,E){r.checkSupport("blob");try{return new Blob([h],{type:E})}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return f.append(h),f.getBlob(E)}catch{throw new Error("Bug : can't construct the Blob.")}}};var _={stringifyByChunk:function(h,E,f){var y=[],v=0,I=h.length;if(I<=f)return String.fromCharCode.apply(null,h);for(;v<I;)E==="array"||E==="nodebuffer"?y.push(String.fromCharCode.apply(null,h.slice(v,Math.min(v+f,I)))):y.push(String.fromCharCode.apply(null,h.subarray(v,Math.min(v+f,I)))),v+=f;return y.join("")},stringifyByChar:function(h){for(var E="",f=0;f<h.length;f++)E+=String.fromCharCode(h[f]);return E},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function d(h){var E=65536,f=r.getTypeOf(h),y=!0;if(f==="uint8array"?y=_.applyCanBeUsed.uint8array:f==="nodebuffer"&&(y=_.applyCanBeUsed.nodebuffer),y)for(;1<E;)try{return _.stringifyByChunk(h,f,E)}catch{E=Math.floor(E/2)}return _.stringifyByChar(h)}function l(h,E){for(var f=0;f<h.length;f++)E[f]=h[f];return E}r.applyFromCharCode=d;var b={};b.string={string:g,array:function(h){return m(h,new Array(h.length))},arraybuffer:function(h){return b.string.uint8array(h).buffer},uint8array:function(h){return m(h,new Uint8Array(h.length))},nodebuffer:function(h){return m(h,o.allocBuffer(h.length))}},b.array={string:d,array:g,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return o.newBufferFrom(h)}},b.arraybuffer={string:function(h){return d(new Uint8Array(h))},array:function(h){return l(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:g,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return o.newBufferFrom(new Uint8Array(h))}},b.uint8array={string:d,array:function(h){return l(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:g,nodebuffer:function(h){return o.newBufferFrom(h)}},b.nodebuffer={string:d,array:function(h){return l(h,new Array(h.length))},arraybuffer:function(h){return b.nodebuffer.uint8array(h).buffer},uint8array:function(h){return l(h,new Uint8Array(h.length))},nodebuffer:g},r.transformTo=function(h,E){if(E=E||"",!h)return E;r.checkSupport(h);var f=r.getTypeOf(E);return b[f][h](E)},r.resolve=function(h){for(var E=h.split("/"),f=[],y=0;y<E.length;y++){var v=E[y];v==="."||v===""&&y!==0&&y!==E.length-1||(v===".."?f.pop():f.push(v))}return f.join("/")},r.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(h)?"nodebuffer":s.uint8array&&h instanceof Uint8Array?"uint8array":s.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(h){if(!s[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(h){var E,f,y="";for(f=0;f<(h||"").length;f++)y+="\\x"+((E=h.charCodeAt(f))<16?"0":"")+E.toString(16).toUpperCase();return y},r.delay=function(h,E,f){setImmediate(function(){h.apply(f||null,E||[])})},r.inherits=function(h,E){function f(){}f.prototype=E.prototype,h.prototype=new f},r.extend=function(){var h,E,f={};for(h=0;h<arguments.length;h++)for(E in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],E)&&f[E]===void 0&&(f[E]=arguments[h][E]);return f},r.prepareContent=function(h,E,f,y,v){return u.Promise.resolve(E).then(function(I){return s.blob&&(I instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(I))!==-1)&&typeof FileReader<"u"?new u.Promise(function(w,k){var L=new FileReader;L.onload=function(O){w(O.target.result)},L.onerror=function(O){k(O.target.error)},L.readAsArrayBuffer(I)}):I}).then(function(I){var w=r.getTypeOf(I);return w?(w==="arraybuffer"?I=r.transformTo("uint8array",I):w==="string"&&(v?I=a.decode(I):f&&y!==!0&&(I=function(k){return m(k,s.uint8array?new Uint8Array(k.length):new Array(k.length))}(I))),I):u.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,i,r){var s=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),u=n("./zipEntry"),g=n("./support");function m(_){this.files=[],this.loadOptions=_}m.prototype={checkSignature:function(_){if(!this.reader.readAndCheckSignature(_)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(d)+", expected "+a.pretty(_)+")")}},isSignature:function(_,d){var l=this.reader.index;this.reader.setIndex(_);var b=this.reader.readString(4)===d;return this.reader.setIndex(l),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var _=this.reader.readData(this.zipCommentLength),d=g.uint8array?"uint8array":"array",l=a.transformTo(d,_);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var _,d,l,b=this.zip64EndOfCentralSize-44;0<b;)_=this.reader.readInt(2),d=this.reader.readInt(4),l=this.reader.readData(d),this.zip64ExtensibleData[_]={id:_,length:d,value:l}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var _,d;for(_=0;_<this.files.length;_++)d=this.files[_],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var _;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(_=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(_);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var _=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(_<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(_);var d=_;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(_=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(_),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var l=this.centralDirOffset+this.centralDirSize;this.zip64&&(l+=20,l+=12+this.zip64EndOfCentralSize);var b=d-l;if(0<b)this.isSignature(d,o.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(_){this.reader=s(_)},load:function(_){this.prepareReader(_),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,i,r){var s=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),u=n("./crc32"),g=n("./utf8"),m=n("./compressions"),_=n("./support");function d(l,b){this.options=l,this.loadOptions=b}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(l){var b,h;if(l.skip(22),this.fileNameLength=l.readInt(2),h=l.readInt(2),this.fileName=l.readData(this.fileNameLength),l.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=function(E){for(var f in m)if(Object.prototype.hasOwnProperty.call(m,f)&&m[f].magic===E)return m[f];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,b,l.readData(this.compressedSize))},readCentralPart:function(l){this.versionMadeBy=l.readInt(2),l.skip(2),this.bitFlag=l.readInt(2),this.compressionMethod=l.readString(2),this.date=l.readDate(),this.crc32=l.readInt(4),this.compressedSize=l.readInt(4),this.uncompressedSize=l.readInt(4);var b=l.readInt(2);if(this.extraFieldsLength=l.readInt(2),this.fileCommentLength=l.readInt(2),this.diskNumberStart=l.readInt(2),this.internalFileAttributes=l.readInt(2),this.externalFileAttributes=l.readInt(4),this.localHeaderOffset=l.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");l.skip(b),this.readExtraFields(l),this.parseZIP64ExtraField(l),this.fileComment=l.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var l=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),l==0&&(this.dosPermissions=63&this.externalFileAttributes),l==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var l=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=l.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=l.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=l.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=l.readInt(4))}},readExtraFields:function(l){var b,h,E,f=l.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});l.index+4<f;)b=l.readInt(2),h=l.readInt(2),E=l.readData(h),this.extraFields[b]={id:b,length:h,value:E};l.setIndex(f)},handleUTF8:function(){var l=_.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var h=a.transformTo(l,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var E=this.findExtraFieldUnicodeComment();if(E!==null)this.fileCommentStr=E;else{var f=a.transformTo(l,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(f)}}},findExtraFieldUnicodePath:function(){var l=this.extraFields[28789];if(l){var b=s(l.value);return b.readInt(1)!==1||u(this.fileName)!==b.readInt(4)?null:g.utf8decode(b.readData(l.length-5))}return null},findExtraFieldUnicodeComment:function(){var l=this.extraFields[25461];if(l){var b=s(l.value);return b.readInt(1)!==1||u(this.fileComment)!==b.readInt(4)?null:g.utf8decode(b.readData(l.length-5))}return null}},i.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,i,r){function s(b,h,E){this.name=b,this.dir=E.dir,this.date=E.date,this.comment=E.comment,this.unixPermissions=E.unixPermissions,this.dosPermissions=E.dosPermissions,this._data=h,this._dataBinary=E.binary,this.options={compression:E.compression,compressionOptions:E.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),u=n("./utf8"),g=n("./compressedObject"),m=n("./stream/GenericWorker");s.prototype={internalStream:function(b){var h=null,E="string";try{if(!b)throw new Error("No output type specified.");var f=(E=b.toLowerCase())==="string"||E==="text";E!=="binarystring"&&E!=="text"||(E="string"),h=this._decompressWorker();var y=!this._dataBinary;y&&!f&&(h=h.pipe(new u.Utf8EncodeWorker)),!y&&f&&(h=h.pipe(new u.Utf8DecodeWorker))}catch(v){(h=new m("error")).error(v)}return new a(h,E,"")},async:function(b,h){return this.internalStream(b).accumulate(h)},nodeStream:function(b,h){return this.internalStream(b||"nodebuffer").toNodejsStream(h)},_compressWorker:function(b,h){if(this._data instanceof g&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var E=this._decompressWorker();return this._dataBinary||(E=E.pipe(new u.Utf8EncodeWorker)),g.createWorkerFrom(E,b,h)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof m?this._data:new o(this._data)}};for(var _=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<_.length;l++)s.prototype[_[l]]=d;i.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,i,r){(function(s){var a,o,u=s.MutationObserver||s.WebKitMutationObserver;if(u){var g=0,m=new u(b),_=s.document.createTextNode("");m.observe(_,{characterData:!0}),a=function(){_.data=g=++g%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var h=s.document.createElement("script");h.onreadystatechange=function(){b(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},s.document.documentElement.appendChild(h)}:function(){setTimeout(b,0)};else{var d=new s.MessageChannel;d.port1.onmessage=b,a=function(){d.port2.postMessage(0)}}var l=[];function b(){var h,E;o=!0;for(var f=l.length;f;){for(E=l,l=[],h=-1;++h<f;)E[h]();f=l.length}o=!1}i.exports=function(h){l.push(h)!==1||o||a()}}).call(this,typeof Ve<"u"?Ve:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,i,r){var s=n("immediate");function a(){}var o={},u=["REJECTED"],g=["FULFILLED"],m=["PENDING"];function _(f){if(typeof f!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,f!==a&&h(this,f)}function d(f,y,v){this.promise=f,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function l(f,y,v){s(function(){var I;try{I=y(v)}catch(w){return o.reject(f,w)}I===f?o.reject(f,new TypeError("Cannot resolve promise with itself")):o.resolve(f,I)})}function b(f){var y=f&&f.then;if(f&&(typeof f=="object"||typeof f=="function")&&typeof y=="function")return function(){y.apply(f,arguments)}}function h(f,y){var v=!1;function I(L){v||(v=!0,o.reject(f,L))}function w(L){v||(v=!0,o.resolve(f,L))}var k=E(function(){y(w,I)});k.status==="error"&&I(k.value)}function E(f,y){var v={};try{v.value=f(y),v.status="success"}catch(I){v.status="error",v.value=I}return v}(i.exports=_).prototype.finally=function(f){if(typeof f!="function")return this;var y=this.constructor;return this.then(function(v){return y.resolve(f()).then(function(){return v})},function(v){return y.resolve(f()).then(function(){throw v})})},_.prototype.catch=function(f){return this.then(null,f)},_.prototype.then=function(f,y){if(typeof f!="function"&&this.state===g||typeof y!="function"&&this.state===u)return this;var v=new this.constructor(a);return this.state!==m?l(v,this.state===g?f:y,this.outcome):this.queue.push(new d(v,f,y)),v},d.prototype.callFulfilled=function(f){o.resolve(this.promise,f)},d.prototype.otherCallFulfilled=function(f){l(this.promise,this.onFulfilled,f)},d.prototype.callRejected=function(f){o.reject(this.promise,f)},d.prototype.otherCallRejected=function(f){l(this.promise,this.onRejected,f)},o.resolve=function(f,y){var v=E(b,y);if(v.status==="error")return o.reject(f,v.value);var I=v.value;if(I)h(f,I);else{f.state=g,f.outcome=y;for(var w=-1,k=f.queue.length;++w<k;)f.queue[w].callFulfilled(y)}return f},o.reject=function(f,y){f.state=u,f.outcome=y;for(var v=-1,I=f.queue.length;++v<I;)f.queue[v].callRejected(y);return f},_.resolve=function(f){return f instanceof this?f:o.resolve(new this(a),f)},_.reject=function(f){var y=new this(a);return o.reject(y,f)},_.all=function(f){var y=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=f.length,I=!1;if(!v)return this.resolve([]);for(var w=new Array(v),k=0,L=-1,O=new this(a);++L<v;)S(f[L],L);return O;function S(M,Z){y.resolve(M).then(function(R){w[Z]=R,++k!==v||I||(I=!0,o.resolve(O,w))},function(R){I||(I=!0,o.reject(O,R))})}},_.race=function(f){var y=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=f.length,I=!1;if(!v)return this.resolve([]);for(var w=-1,k=new this(a);++w<v;)L=f[w],y.resolve(L).then(function(O){I||(I=!0,o.resolve(k,O))},function(O){I||(I=!0,o.reject(k,O))});var L;return k}},{immediate:36}],38:[function(n,i,r){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),i.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,i,r){var s=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),u=n("./zlib/messages"),g=n("./zlib/zstream"),m=Object.prototype.toString,_=0,d=-1,l=0,b=8;function h(f){if(!(this instanceof h))return new h(f);this.options=a.assign({level:d,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},f||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var v=s.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(v!==_)throw new Error(u[v]);if(y.header&&s.deflateSetHeader(this.strm,y.header),y.dictionary){var I;if(I=typeof y.dictionary=="string"?o.string2buf(y.dictionary):m.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(v=s.deflateSetDictionary(this.strm,I))!==_)throw new Error(u[v]);this._dict_set=!0}}function E(f,y){var v=new h(y);if(v.push(f,!0),v.err)throw v.msg||u[v.err];return v.result}h.prototype.push=function(f,y){var v,I,w=this.strm,k=this.options.chunkSize;if(this.ended)return!1;I=y===~~y?y:y===!0?4:0,typeof f=="string"?w.input=o.string2buf(f):m.call(f)==="[object ArrayBuffer]"?w.input=new Uint8Array(f):w.input=f,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new a.Buf8(k),w.next_out=0,w.avail_out=k),(v=s.deflate(w,I))!==1&&v!==_)return this.onEnd(v),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||I!==4&&I!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(w.output,w.next_out))):this.onData(a.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&v!==1);return I===4?(v=s.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===_):I!==2||(this.onEnd(_),!(w.avail_out=0))},h.prototype.onData=function(f){this.chunks.push(f)},h.prototype.onEnd=function(f){f===_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},r.Deflate=h,r.deflate=E,r.deflateRaw=function(f,y){return(y=y||{}).raw=!0,E(f,y)},r.gzip=function(f,y){return(y=y||{}).gzip=!0,E(f,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,i,r){var s=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),u=n("./zlib/constants"),g=n("./zlib/messages"),m=n("./zlib/zstream"),_=n("./zlib/gzheader"),d=Object.prototype.toString;function l(h){if(!(this instanceof l))return new l(h);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},h||{});var E=this.options;E.raw&&0<=E.windowBits&&E.windowBits<16&&(E.windowBits=-E.windowBits,E.windowBits===0&&(E.windowBits=-15)),!(0<=E.windowBits&&E.windowBits<16)||h&&h.windowBits||(E.windowBits+=32),15<E.windowBits&&E.windowBits<48&&!(15&E.windowBits)&&(E.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var f=s.inflateInit2(this.strm,E.windowBits);if(f!==u.Z_OK)throw new Error(g[f]);this.header=new _,s.inflateGetHeader(this.strm,this.header)}function b(h,E){var f=new l(E);if(f.push(h,!0),f.err)throw f.msg||g[f.err];return f.result}l.prototype.push=function(h,E){var f,y,v,I,w,k,L=this.strm,O=this.options.chunkSize,S=this.options.dictionary,M=!1;if(this.ended)return!1;y=E===~~E?E:E===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof h=="string"?L.input=o.binstring2buf(h):d.call(h)==="[object ArrayBuffer]"?L.input=new Uint8Array(h):L.input=h,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new a.Buf8(O),L.next_out=0,L.avail_out=O),(f=s.inflate(L,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&S&&(k=typeof S=="string"?o.string2buf(S):d.call(S)==="[object ArrayBuffer]"?new Uint8Array(S):S,f=s.inflateSetDictionary(this.strm,k)),f===u.Z_BUF_ERROR&&M===!0&&(f=u.Z_OK,M=!1),f!==u.Z_STREAM_END&&f!==u.Z_OK)return this.onEnd(f),!(this.ended=!0);L.next_out&&(L.avail_out!==0&&f!==u.Z_STREAM_END&&(L.avail_in!==0||y!==u.Z_FINISH&&y!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=o.utf8border(L.output,L.next_out),I=L.next_out-v,w=o.buf2string(L.output,v),L.next_out=I,L.avail_out=O-I,I&&a.arraySet(L.output,L.output,v,I,0),this.onData(w)):this.onData(a.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(M=!0)}while((0<L.avail_in||L.avail_out===0)&&f!==u.Z_STREAM_END);return f===u.Z_STREAM_END&&(y=u.Z_FINISH),y===u.Z_FINISH?(f=s.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,f===u.Z_OK):y!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(L.avail_out=0))},l.prototype.onData=function(h){this.chunks.push(h)},l.prototype.onEnd=function(h){h===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},r.Inflate=l,r.inflate=b,r.inflateRaw=function(h,E){return(E=E||{}).raw=!0,b(h,E)},r.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(u){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var m=g.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var _ in m)m.hasOwnProperty(_)&&(u[_]=m[_])}}return u},r.shrinkBuf=function(u,g){return u.length===g?u:u.subarray?u.subarray(0,g):(u.length=g,u)};var a={arraySet:function(u,g,m,_,d){if(g.subarray&&u.subarray)u.set(g.subarray(m,m+_),d);else for(var l=0;l<_;l++)u[d+l]=g[m+l]},flattenChunks:function(u){var g,m,_,d,l,b;for(g=_=0,m=u.length;g<m;g++)_+=u[g].length;for(b=new Uint8Array(_),g=d=0,m=u.length;g<m;g++)l=u[g],b.set(l,d),d+=l.length;return b}},o={arraySet:function(u,g,m,_,d){for(var l=0;l<_;l++)u[d+l]=g[m+l]},flattenChunks:function(u){return[].concat.apply([],u)}};r.setTyped=function(u){u?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(s)},{}],42:[function(n,i,r){var s=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var u=new s.Buf8(256),g=0;g<256;g++)u[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function m(_,d){if(d<65537&&(_.subarray&&o||!_.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(_,d));for(var l="",b=0;b<d;b++)l+=String.fromCharCode(_[b]);return l}u[254]=u[254]=1,r.string2buf=function(_){var d,l,b,h,E,f=_.length,y=0;for(h=0;h<f;h++)(64512&(l=_.charCodeAt(h)))==55296&&h+1<f&&(64512&(b=_.charCodeAt(h+1)))==56320&&(l=65536+(l-55296<<10)+(b-56320),h++),y+=l<128?1:l<2048?2:l<65536?3:4;for(d=new s.Buf8(y),h=E=0;E<y;h++)(64512&(l=_.charCodeAt(h)))==55296&&h+1<f&&(64512&(b=_.charCodeAt(h+1)))==56320&&(l=65536+(l-55296<<10)+(b-56320),h++),l<128?d[E++]=l:(l<2048?d[E++]=192|l>>>6:(l<65536?d[E++]=224|l>>>12:(d[E++]=240|l>>>18,d[E++]=128|l>>>12&63),d[E++]=128|l>>>6&63),d[E++]=128|63&l);return d},r.buf2binstring=function(_){return m(_,_.length)},r.binstring2buf=function(_){for(var d=new s.Buf8(_.length),l=0,b=d.length;l<b;l++)d[l]=_.charCodeAt(l);return d},r.buf2string=function(_,d){var l,b,h,E,f=d||_.length,y=new Array(2*f);for(l=b=0;l<f;)if((h=_[l++])<128)y[b++]=h;else if(4<(E=u[h]))y[b++]=65533,l+=E-1;else{for(h&=E===2?31:E===3?15:7;1<E&&l<f;)h=h<<6|63&_[l++],E--;1<E?y[b++]=65533:h<65536?y[b++]=h:(h-=65536,y[b++]=55296|h>>10&1023,y[b++]=56320|1023&h)}return m(y,b)},r.utf8border=function(_,d){var l;for((d=d||_.length)>_.length&&(d=_.length),l=d-1;0<=l&&(192&_[l])==128;)l--;return l<0||l===0?d:l+u[_[l]]>d?l:d}},{"./common":41}],43:[function(n,i,r){i.exports=function(s,a,o,u){for(var g=65535&s|0,m=s>>>16&65535|0,_=0;o!==0;){for(o-=_=2e3<o?2e3:o;m=m+(g=g+a[u++]|0)|0,--_;);g%=65521,m%=65521}return g|m<<16|0}},{}],44:[function(n,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,i,r){var s=function(){for(var a,o=[],u=0;u<256;u++){a=u;for(var g=0;g<8;g++)a=1&a?3988292384^a>>>1:a>>>1;o[u]=a}return o}();i.exports=function(a,o,u,g){var m=s,_=g+u;a^=-1;for(var d=g;d<_;d++)a=a>>>8^m[255&(a^o[d])];return-1^a}},{}],46:[function(n,i,r){var s,a=n("../utils/common"),o=n("./trees"),u=n("./adler32"),g=n("./crc32"),m=n("./messages"),_=0,d=4,l=0,b=-2,h=-1,E=4,f=2,y=8,v=9,I=286,w=30,k=19,L=2*I+1,O=15,S=3,M=258,Z=M+S+1,R=42,P=113,p=1,U=2,tt=3,z=4;function et(c,F){return c.msg=m[F],F}function j(c){return(c<<1)-(4<c?9:0)}function Q(c){for(var F=c.length;0<=--F;)c[F]=0}function D(c){var F=c.state,B=F.pending;B>c.avail_out&&(B=c.avail_out),B!==0&&(a.arraySet(c.output,F.pending_buf,F.pending_out,B,c.next_out),c.next_out+=B,F.pending_out+=B,c.total_out+=B,c.avail_out-=B,F.pending-=B,F.pending===0&&(F.pending_out=0))}function x(c,F){o._tr_flush_block(c,0<=c.block_start?c.block_start:-1,c.strstart-c.block_start,F),c.block_start=c.strstart,D(c.strm)}function it(c,F){c.pending_buf[c.pending++]=F}function X(c,F){c.pending_buf[c.pending++]=F>>>8&255,c.pending_buf[c.pending++]=255&F}function $(c,F){var B,T,A=c.max_chain_length,N=c.strstart,K=c.prev_length,W=c.nice_match,C=c.strstart>c.w_size-Z?c.strstart-(c.w_size-Z):0,q=c.window,J=c.w_mask,V=c.prev,rt=c.strstart+M,ft=q[N+K-1],ut=q[N+K];c.prev_length>=c.good_match&&(A>>=2),W>c.lookahead&&(W=c.lookahead);do if(q[(B=F)+K]===ut&&q[B+K-1]===ft&&q[B]===q[N]&&q[++B]===q[N+1]){N+=2,B++;do;while(q[++N]===q[++B]&&q[++N]===q[++B]&&q[++N]===q[++B]&&q[++N]===q[++B]&&q[++N]===q[++B]&&q[++N]===q[++B]&&q[++N]===q[++B]&&q[++N]===q[++B]&&N<rt);if(T=M-(rt-N),N=rt-M,K<T){if(c.match_start=F,W<=(K=T))break;ft=q[N+K-1],ut=q[N+K]}}while((F=V[F&J])>C&&--A!=0);return K<=c.lookahead?K:c.lookahead}function _t(c){var F,B,T,A,N,K,W,C,q,J,V=c.w_size;do{if(A=c.window_size-c.lookahead-c.strstart,c.strstart>=V+(V-Z)){for(a.arraySet(c.window,c.window,V,V,0),c.match_start-=V,c.strstart-=V,c.block_start-=V,F=B=c.hash_size;T=c.head[--F],c.head[F]=V<=T?T-V:0,--B;);for(F=B=V;T=c.prev[--F],c.prev[F]=V<=T?T-V:0,--B;);A+=V}if(c.strm.avail_in===0)break;if(K=c.strm,W=c.window,C=c.strstart+c.lookahead,q=A,J=void 0,J=K.avail_in,q<J&&(J=q),B=J===0?0:(K.avail_in-=J,a.arraySet(W,K.input,K.next_in,J,C),K.state.wrap===1?K.adler=u(K.adler,W,J,C):K.state.wrap===2&&(K.adler=g(K.adler,W,J,C)),K.next_in+=J,K.total_in+=J,J),c.lookahead+=B,c.lookahead+c.insert>=S)for(N=c.strstart-c.insert,c.ins_h=c.window[N],c.ins_h=(c.ins_h<<c.hash_shift^c.window[N+1])&c.hash_mask;c.insert&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[N+S-1])&c.hash_mask,c.prev[N&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=N,N++,c.insert--,!(c.lookahead+c.insert<S)););}while(c.lookahead<Z&&c.strm.avail_in!==0)}function wt(c,F){for(var B,T;;){if(c.lookahead<Z){if(_t(c),c.lookahead<Z&&F===_)return p;if(c.lookahead===0)break}if(B=0,c.lookahead>=S&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+S-1])&c.hash_mask,B=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),B!==0&&c.strstart-B<=c.w_size-Z&&(c.match_length=$(c,B)),c.match_length>=S)if(T=o._tr_tally(c,c.strstart-c.match_start,c.match_length-S),c.lookahead-=c.match_length,c.match_length<=c.max_lazy_match&&c.lookahead>=S){for(c.match_length--;c.strstart++,c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+S-1])&c.hash_mask,B=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart,--c.match_length!=0;);c.strstart++}else c.strstart+=c.match_length,c.match_length=0,c.ins_h=c.window[c.strstart],c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+1])&c.hash_mask;else T=o._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++;if(T&&(x(c,!1),c.strm.avail_out===0))return p}return c.insert=c.strstart<S-1?c.strstart:S-1,F===d?(x(c,!0),c.strm.avail_out===0?tt:z):c.last_lit&&(x(c,!1),c.strm.avail_out===0)?p:U}function ot(c,F){for(var B,T,A;;){if(c.lookahead<Z){if(_t(c),c.lookahead<Z&&F===_)return p;if(c.lookahead===0)break}if(B=0,c.lookahead>=S&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+S-1])&c.hash_mask,B=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),c.prev_length=c.match_length,c.prev_match=c.match_start,c.match_length=S-1,B!==0&&c.prev_length<c.max_lazy_match&&c.strstart-B<=c.w_size-Z&&(c.match_length=$(c,B),c.match_length<=5&&(c.strategy===1||c.match_length===S&&4096<c.strstart-c.match_start)&&(c.match_length=S-1)),c.prev_length>=S&&c.match_length<=c.prev_length){for(A=c.strstart+c.lookahead-S,T=o._tr_tally(c,c.strstart-1-c.prev_match,c.prev_length-S),c.lookahead-=c.prev_length-1,c.prev_length-=2;++c.strstart<=A&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+S-1])&c.hash_mask,B=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),--c.prev_length!=0;);if(c.match_available=0,c.match_length=S-1,c.strstart++,T&&(x(c,!1),c.strm.avail_out===0))return p}else if(c.match_available){if((T=o._tr_tally(c,0,c.window[c.strstart-1]))&&x(c,!1),c.strstart++,c.lookahead--,c.strm.avail_out===0)return p}else c.match_available=1,c.strstart++,c.lookahead--}return c.match_available&&(T=o._tr_tally(c,0,c.window[c.strstart-1]),c.match_available=0),c.insert=c.strstart<S-1?c.strstart:S-1,F===d?(x(c,!0),c.strm.avail_out===0?tt:z):c.last_lit&&(x(c,!1),c.strm.avail_out===0)?p:U}function lt(c,F,B,T,A){this.good_length=c,this.max_lazy=F,this.nice_length=B,this.max_chain=T,this.func=A}function Et(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*L),this.dyn_dtree=new a.Buf16(2*(2*w+1)),this.bl_tree=new a.Buf16(2*(2*k+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(O+1),this.heap=new a.Buf16(2*I+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*I+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function mt(c){var F;return c&&c.state?(c.total_in=c.total_out=0,c.data_type=f,(F=c.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?R:P,c.adler=F.wrap===2?0:1,F.last_flush=_,o._tr_init(F),l):et(c,b)}function Dt(c){var F=mt(c);return F===l&&function(B){B.window_size=2*B.w_size,Q(B.head),B.max_lazy_match=s[B.level].max_lazy,B.good_match=s[B.level].good_length,B.nice_match=s[B.level].nice_length,B.max_chain_length=s[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=S-1,B.match_available=0,B.ins_h=0}(c.state),F}function xt(c,F,B,T,A,N){if(!c)return b;var K=1;if(F===h&&(F=6),T<0?(K=0,T=-T):15<T&&(K=2,T-=16),A<1||v<A||B!==y||T<8||15<T||F<0||9<F||N<0||E<N)return et(c,b);T===8&&(T=9);var W=new Et;return(c.state=W).strm=c,W.wrap=K,W.gzhead=null,W.w_bits=T,W.w_size=1<<W.w_bits,W.w_mask=W.w_size-1,W.hash_bits=A+7,W.hash_size=1<<W.hash_bits,W.hash_mask=W.hash_size-1,W.hash_shift=~~((W.hash_bits+S-1)/S),W.window=new a.Buf8(2*W.w_size),W.head=new a.Buf16(W.hash_size),W.prev=new a.Buf16(W.w_size),W.lit_bufsize=1<<A+6,W.pending_buf_size=4*W.lit_bufsize,W.pending_buf=new a.Buf8(W.pending_buf_size),W.d_buf=1*W.lit_bufsize,W.l_buf=3*W.lit_bufsize,W.level=F,W.strategy=N,W.method=B,Dt(c)}s=[new lt(0,0,0,0,function(c,F){var B=65535;for(B>c.pending_buf_size-5&&(B=c.pending_buf_size-5);;){if(c.lookahead<=1){if(_t(c),c.lookahead===0&&F===_)return p;if(c.lookahead===0)break}c.strstart+=c.lookahead,c.lookahead=0;var T=c.block_start+B;if((c.strstart===0||c.strstart>=T)&&(c.lookahead=c.strstart-T,c.strstart=T,x(c,!1),c.strm.avail_out===0)||c.strstart-c.block_start>=c.w_size-Z&&(x(c,!1),c.strm.avail_out===0))return p}return c.insert=0,F===d?(x(c,!0),c.strm.avail_out===0?tt:z):(c.strstart>c.block_start&&(x(c,!1),c.strm.avail_out),p)}),new lt(4,4,8,4,wt),new lt(4,5,16,8,wt),new lt(4,6,32,32,wt),new lt(4,4,16,16,ot),new lt(8,16,32,32,ot),new lt(8,16,128,128,ot),new lt(8,32,128,256,ot),new lt(32,128,258,1024,ot),new lt(32,258,258,4096,ot)],r.deflateInit=function(c,F){return xt(c,F,y,15,8,0)},r.deflateInit2=xt,r.deflateReset=Dt,r.deflateResetKeep=mt,r.deflateSetHeader=function(c,F){return c&&c.state?c.state.wrap!==2?b:(c.state.gzhead=F,l):b},r.deflate=function(c,F){var B,T,A,N;if(!c||!c.state||5<F||F<0)return c?et(c,b):b;if(T=c.state,!c.output||!c.input&&c.avail_in!==0||T.status===666&&F!==d)return et(c,c.avail_out===0?-5:b);if(T.strm=c,B=T.last_flush,T.last_flush=F,T.status===R)if(T.wrap===2)c.adler=0,it(T,31),it(T,139),it(T,8),T.gzhead?(it(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),it(T,255&T.gzhead.time),it(T,T.gzhead.time>>8&255),it(T,T.gzhead.time>>16&255),it(T,T.gzhead.time>>24&255),it(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),it(T,255&T.gzhead.os),T.gzhead.extra&&T.gzhead.extra.length&&(it(T,255&T.gzhead.extra.length),it(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(c.adler=g(c.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=69):(it(T,0),it(T,0),it(T,0),it(T,0),it(T,0),it(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),it(T,3),T.status=P);else{var K=y+(T.w_bits-8<<4)<<8;K|=(2<=T.strategy||T.level<2?0:T.level<6?1:T.level===6?2:3)<<6,T.strstart!==0&&(K|=32),K+=31-K%31,T.status=P,X(T,K),T.strstart!==0&&(X(T,c.adler>>>16),X(T,65535&c.adler)),c.adler=1}if(T.status===69)if(T.gzhead.extra){for(A=T.pending;T.gzindex<(65535&T.gzhead.extra.length)&&(T.pending!==T.pending_buf_size||(T.gzhead.hcrc&&T.pending>A&&(c.adler=g(c.adler,T.pending_buf,T.pending-A,A)),D(c),A=T.pending,T.pending!==T.pending_buf_size));)it(T,255&T.gzhead.extra[T.gzindex]),T.gzindex++;T.gzhead.hcrc&&T.pending>A&&(c.adler=g(c.adler,T.pending_buf,T.pending-A,A)),T.gzindex===T.gzhead.extra.length&&(T.gzindex=0,T.status=73)}else T.status=73;if(T.status===73)if(T.gzhead.name){A=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>A&&(c.adler=g(c.adler,T.pending_buf,T.pending-A,A)),D(c),A=T.pending,T.pending===T.pending_buf_size)){N=1;break}N=T.gzindex<T.gzhead.name.length?255&T.gzhead.name.charCodeAt(T.gzindex++):0,it(T,N)}while(N!==0);T.gzhead.hcrc&&T.pending>A&&(c.adler=g(c.adler,T.pending_buf,T.pending-A,A)),N===0&&(T.gzindex=0,T.status=91)}else T.status=91;if(T.status===91)if(T.gzhead.comment){A=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>A&&(c.adler=g(c.adler,T.pending_buf,T.pending-A,A)),D(c),A=T.pending,T.pending===T.pending_buf_size)){N=1;break}N=T.gzindex<T.gzhead.comment.length?255&T.gzhead.comment.charCodeAt(T.gzindex++):0,it(T,N)}while(N!==0);T.gzhead.hcrc&&T.pending>A&&(c.adler=g(c.adler,T.pending_buf,T.pending-A,A)),N===0&&(T.status=103)}else T.status=103;if(T.status===103&&(T.gzhead.hcrc?(T.pending+2>T.pending_buf_size&&D(c),T.pending+2<=T.pending_buf_size&&(it(T,255&c.adler),it(T,c.adler>>8&255),c.adler=0,T.status=P)):T.status=P),T.pending!==0){if(D(c),c.avail_out===0)return T.last_flush=-1,l}else if(c.avail_in===0&&j(F)<=j(B)&&F!==d)return et(c,-5);if(T.status===666&&c.avail_in!==0)return et(c,-5);if(c.avail_in!==0||T.lookahead!==0||F!==_&&T.status!==666){var W=T.strategy===2?function(C,q){for(var J;;){if(C.lookahead===0&&(_t(C),C.lookahead===0)){if(q===_)return p;break}if(C.match_length=0,J=o._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++,J&&(x(C,!1),C.strm.avail_out===0))return p}return C.insert=0,q===d?(x(C,!0),C.strm.avail_out===0?tt:z):C.last_lit&&(x(C,!1),C.strm.avail_out===0)?p:U}(T,F):T.strategy===3?function(C,q){for(var J,V,rt,ft,ut=C.window;;){if(C.lookahead<=M){if(_t(C),C.lookahead<=M&&q===_)return p;if(C.lookahead===0)break}if(C.match_length=0,C.lookahead>=S&&0<C.strstart&&(V=ut[rt=C.strstart-1])===ut[++rt]&&V===ut[++rt]&&V===ut[++rt]){ft=C.strstart+M;do;while(V===ut[++rt]&&V===ut[++rt]&&V===ut[++rt]&&V===ut[++rt]&&V===ut[++rt]&&V===ut[++rt]&&V===ut[++rt]&&V===ut[++rt]&&rt<ft);C.match_length=M-(ft-rt),C.match_length>C.lookahead&&(C.match_length=C.lookahead)}if(C.match_length>=S?(J=o._tr_tally(C,1,C.match_length-S),C.lookahead-=C.match_length,C.strstart+=C.match_length,C.match_length=0):(J=o._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++),J&&(x(C,!1),C.strm.avail_out===0))return p}return C.insert=0,q===d?(x(C,!0),C.strm.avail_out===0?tt:z):C.last_lit&&(x(C,!1),C.strm.avail_out===0)?p:U}(T,F):s[T.level].func(T,F);if(W!==tt&&W!==z||(T.status=666),W===p||W===tt)return c.avail_out===0&&(T.last_flush=-1),l;if(W===U&&(F===1?o._tr_align(T):F!==5&&(o._tr_stored_block(T,0,0,!1),F===3&&(Q(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),D(c),c.avail_out===0))return T.last_flush=-1,l}return F!==d?l:T.wrap<=0?1:(T.wrap===2?(it(T,255&c.adler),it(T,c.adler>>8&255),it(T,c.adler>>16&255),it(T,c.adler>>24&255),it(T,255&c.total_in),it(T,c.total_in>>8&255),it(T,c.total_in>>16&255),it(T,c.total_in>>24&255)):(X(T,c.adler>>>16),X(T,65535&c.adler)),D(c),0<T.wrap&&(T.wrap=-T.wrap),T.pending!==0?l:1)},r.deflateEnd=function(c){var F;return c&&c.state?(F=c.state.status)!==R&&F!==69&&F!==73&&F!==91&&F!==103&&F!==P&&F!==666?et(c,b):(c.state=null,F===P?et(c,-3):l):b},r.deflateSetDictionary=function(c,F){var B,T,A,N,K,W,C,q,J=F.length;if(!c||!c.state||(N=(B=c.state).wrap)===2||N===1&&B.status!==R||B.lookahead)return b;for(N===1&&(c.adler=u(c.adler,F,J,0)),B.wrap=0,J>=B.w_size&&(N===0&&(Q(B.head),B.strstart=0,B.block_start=0,B.insert=0),q=new a.Buf8(B.w_size),a.arraySet(q,F,J-B.w_size,B.w_size,0),F=q,J=B.w_size),K=c.avail_in,W=c.next_in,C=c.input,c.avail_in=J,c.next_in=0,c.input=F,_t(B);B.lookahead>=S;){for(T=B.strstart,A=B.lookahead-(S-1);B.ins_h=(B.ins_h<<B.hash_shift^B.window[T+S-1])&B.hash_mask,B.prev[T&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=T,T++,--A;);B.strstart=T,B.lookahead=S-1,_t(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=S-1,B.match_available=0,c.next_in=W,c.input=C,c.avail_in=K,B.wrap=N,l},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,i,r){i.exports=function(s,a){var o,u,g,m,_,d,l,b,h,E,f,y,v,I,w,k,L,O,S,M,Z,R,P,p,U;o=s.state,u=s.next_in,p=s.input,g=u+(s.avail_in-5),m=s.next_out,U=s.output,_=m-(a-s.avail_out),d=m+(s.avail_out-257),l=o.dmax,b=o.wsize,h=o.whave,E=o.wnext,f=o.window,y=o.hold,v=o.bits,I=o.lencode,w=o.distcode,k=(1<<o.lenbits)-1,L=(1<<o.distbits)-1;t:do{v<15&&(y+=p[u++]<<v,v+=8,y+=p[u++]<<v,v+=8),O=I[y&k];e:for(;;){if(y>>>=S=O>>>24,v-=S,(S=O>>>16&255)===0)U[m++]=65535&O;else{if(!(16&S)){if(!(64&S)){O=I[(65535&O)+(y&(1<<S)-1)];continue e}if(32&S){o.mode=12;break t}s.msg="invalid literal/length code",o.mode=30;break t}M=65535&O,(S&=15)&&(v<S&&(y+=p[u++]<<v,v+=8),M+=y&(1<<S)-1,y>>>=S,v-=S),v<15&&(y+=p[u++]<<v,v+=8,y+=p[u++]<<v,v+=8),O=w[y&L];n:for(;;){if(y>>>=S=O>>>24,v-=S,!(16&(S=O>>>16&255))){if(!(64&S)){O=w[(65535&O)+(y&(1<<S)-1)];continue n}s.msg="invalid distance code",o.mode=30;break t}if(Z=65535&O,v<(S&=15)&&(y+=p[u++]<<v,(v+=8)<S&&(y+=p[u++]<<v,v+=8)),l<(Z+=y&(1<<S)-1)){s.msg="invalid distance too far back",o.mode=30;break t}if(y>>>=S,v-=S,(S=m-_)<Z){if(h<(S=Z-S)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break t}if(P=f,(R=0)===E){if(R+=b-S,S<M){for(M-=S;U[m++]=f[R++],--S;);R=m-Z,P=U}}else if(E<S){if(R+=b+E-S,(S-=E)<M){for(M-=S;U[m++]=f[R++],--S;);if(R=0,E<M){for(M-=S=E;U[m++]=f[R++],--S;);R=m-Z,P=U}}}else if(R+=E-S,S<M){for(M-=S;U[m++]=f[R++],--S;);R=m-Z,P=U}for(;2<M;)U[m++]=P[R++],U[m++]=P[R++],U[m++]=P[R++],M-=3;M&&(U[m++]=P[R++],1<M&&(U[m++]=P[R++]))}else{for(R=m-Z;U[m++]=U[R++],U[m++]=U[R++],U[m++]=U[R++],2<(M-=3););M&&(U[m++]=U[R++],1<M&&(U[m++]=U[R++]))}break}}break}}while(u<g&&m<d);u-=M=v>>3,y&=(1<<(v-=M<<3))-1,s.next_in=u,s.next_out=m,s.avail_in=u<g?g-u+5:5-(u-g),s.avail_out=m<d?d-m+257:257-(m-d),o.hold=y,o.bits=v}},{}],49:[function(n,i,r){var s=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),u=n("./inffast"),g=n("./inftrees"),m=1,_=2,d=0,l=-2,b=1,h=852,E=592;function f(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(R){var P;return R&&R.state?(P=R.state,R.total_in=R.total_out=P.total=0,R.msg="",P.wrap&&(R.adler=1&P.wrap),P.mode=b,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new s.Buf32(h),P.distcode=P.distdyn=new s.Buf32(E),P.sane=1,P.back=-1,d):l}function I(R){var P;return R&&R.state?((P=R.state).wsize=0,P.whave=0,P.wnext=0,v(R)):l}function w(R,P){var p,U;return R&&R.state?(U=R.state,P<0?(p=0,P=-P):(p=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?l:(U.window!==null&&U.wbits!==P&&(U.window=null),U.wrap=p,U.wbits=P,I(R))):l}function k(R,P){var p,U;return R?(U=new y,(R.state=U).window=null,(p=w(R,P))!==d&&(R.state=null),p):l}var L,O,S=!0;function M(R){if(S){var P;for(L=new s.Buf32(512),O=new s.Buf32(32),P=0;P<144;)R.lens[P++]=8;for(;P<256;)R.lens[P++]=9;for(;P<280;)R.lens[P++]=7;for(;P<288;)R.lens[P++]=8;for(g(m,R.lens,0,288,L,0,R.work,{bits:9}),P=0;P<32;)R.lens[P++]=5;g(_,R.lens,0,32,O,0,R.work,{bits:5}),S=!1}R.lencode=L,R.lenbits=9,R.distcode=O,R.distbits=5}function Z(R,P,p,U){var tt,z=R.state;return z.window===null&&(z.wsize=1<<z.wbits,z.wnext=0,z.whave=0,z.window=new s.Buf8(z.wsize)),U>=z.wsize?(s.arraySet(z.window,P,p-z.wsize,z.wsize,0),z.wnext=0,z.whave=z.wsize):(U<(tt=z.wsize-z.wnext)&&(tt=U),s.arraySet(z.window,P,p-U,tt,z.wnext),(U-=tt)?(s.arraySet(z.window,P,p-U,U,0),z.wnext=U,z.whave=z.wsize):(z.wnext+=tt,z.wnext===z.wsize&&(z.wnext=0),z.whave<z.wsize&&(z.whave+=tt))),0}r.inflateReset=I,r.inflateReset2=w,r.inflateResetKeep=v,r.inflateInit=function(R){return k(R,15)},r.inflateInit2=k,r.inflate=function(R,P){var p,U,tt,z,et,j,Q,D,x,it,X,$,_t,wt,ot,lt,Et,mt,Dt,xt,c,F,B,T,A=0,N=new s.Buf8(4),K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&R.avail_in!==0)return l;(p=R.state).mode===12&&(p.mode=13),et=R.next_out,tt=R.output,Q=R.avail_out,z=R.next_in,U=R.input,j=R.avail_in,D=p.hold,x=p.bits,it=j,X=Q,F=d;t:for(;;)switch(p.mode){case b:if(p.wrap===0){p.mode=13;break}for(;x<16;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(2&p.wrap&&D===35615){N[p.check=0]=255&D,N[1]=D>>>8&255,p.check=o(p.check,N,2,0),x=D=0,p.mode=2;break}if(p.flags=0,p.head&&(p.head.done=!1),!(1&p.wrap)||(((255&D)<<8)+(D>>8))%31){R.msg="incorrect header check",p.mode=30;break}if((15&D)!=8){R.msg="unknown compression method",p.mode=30;break}if(x-=4,c=8+(15&(D>>>=4)),p.wbits===0)p.wbits=c;else if(c>p.wbits){R.msg="invalid window size",p.mode=30;break}p.dmax=1<<c,R.adler=p.check=1,p.mode=512&D?10:12,x=D=0;break;case 2:for(;x<16;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(p.flags=D,(255&p.flags)!=8){R.msg="unknown compression method",p.mode=30;break}if(57344&p.flags){R.msg="unknown header flags set",p.mode=30;break}p.head&&(p.head.text=D>>8&1),512&p.flags&&(N[0]=255&D,N[1]=D>>>8&255,p.check=o(p.check,N,2,0)),x=D=0,p.mode=3;case 3:for(;x<32;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}p.head&&(p.head.time=D),512&p.flags&&(N[0]=255&D,N[1]=D>>>8&255,N[2]=D>>>16&255,N[3]=D>>>24&255,p.check=o(p.check,N,4,0)),x=D=0,p.mode=4;case 4:for(;x<16;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}p.head&&(p.head.xflags=255&D,p.head.os=D>>8),512&p.flags&&(N[0]=255&D,N[1]=D>>>8&255,p.check=o(p.check,N,2,0)),x=D=0,p.mode=5;case 5:if(1024&p.flags){for(;x<16;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}p.length=D,p.head&&(p.head.extra_len=D),512&p.flags&&(N[0]=255&D,N[1]=D>>>8&255,p.check=o(p.check,N,2,0)),x=D=0}else p.head&&(p.head.extra=null);p.mode=6;case 6:if(1024&p.flags&&(j<($=p.length)&&($=j),$&&(p.head&&(c=p.head.extra_len-p.length,p.head.extra||(p.head.extra=new Array(p.head.extra_len)),s.arraySet(p.head.extra,U,z,$,c)),512&p.flags&&(p.check=o(p.check,U,$,z)),j-=$,z+=$,p.length-=$),p.length))break t;p.length=0,p.mode=7;case 7:if(2048&p.flags){if(j===0)break t;for($=0;c=U[z+$++],p.head&&c&&p.length<65536&&(p.head.name+=String.fromCharCode(c)),c&&$<j;);if(512&p.flags&&(p.check=o(p.check,U,$,z)),j-=$,z+=$,c)break t}else p.head&&(p.head.name=null);p.length=0,p.mode=8;case 8:if(4096&p.flags){if(j===0)break t;for($=0;c=U[z+$++],p.head&&c&&p.length<65536&&(p.head.comment+=String.fromCharCode(c)),c&&$<j;);if(512&p.flags&&(p.check=o(p.check,U,$,z)),j-=$,z+=$,c)break t}else p.head&&(p.head.comment=null);p.mode=9;case 9:if(512&p.flags){for(;x<16;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(D!==(65535&p.check)){R.msg="header crc mismatch",p.mode=30;break}x=D=0}p.head&&(p.head.hcrc=p.flags>>9&1,p.head.done=!0),R.adler=p.check=0,p.mode=12;break;case 10:for(;x<32;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}R.adler=p.check=f(D),x=D=0,p.mode=11;case 11:if(p.havedict===0)return R.next_out=et,R.avail_out=Q,R.next_in=z,R.avail_in=j,p.hold=D,p.bits=x,2;R.adler=p.check=1,p.mode=12;case 12:if(P===5||P===6)break t;case 13:if(p.last){D>>>=7&x,x-=7&x,p.mode=27;break}for(;x<3;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}switch(p.last=1&D,x-=1,3&(D>>>=1)){case 0:p.mode=14;break;case 1:if(M(p),p.mode=20,P!==6)break;D>>>=2,x-=2;break t;case 2:p.mode=17;break;case 3:R.msg="invalid block type",p.mode=30}D>>>=2,x-=2;break;case 14:for(D>>>=7&x,x-=7&x;x<32;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if((65535&D)!=(D>>>16^65535)){R.msg="invalid stored block lengths",p.mode=30;break}if(p.length=65535&D,x=D=0,p.mode=15,P===6)break t;case 15:p.mode=16;case 16:if($=p.length){if(j<$&&($=j),Q<$&&($=Q),$===0)break t;s.arraySet(tt,U,z,$,et),j-=$,z+=$,Q-=$,et+=$,p.length-=$;break}p.mode=12;break;case 17:for(;x<14;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(p.nlen=257+(31&D),D>>>=5,x-=5,p.ndist=1+(31&D),D>>>=5,x-=5,p.ncode=4+(15&D),D>>>=4,x-=4,286<p.nlen||30<p.ndist){R.msg="too many length or distance symbols",p.mode=30;break}p.have=0,p.mode=18;case 18:for(;p.have<p.ncode;){for(;x<3;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}p.lens[K[p.have++]]=7&D,D>>>=3,x-=3}for(;p.have<19;)p.lens[K[p.have++]]=0;if(p.lencode=p.lendyn,p.lenbits=7,B={bits:p.lenbits},F=g(0,p.lens,0,19,p.lencode,0,p.work,B),p.lenbits=B.bits,F){R.msg="invalid code lengths set",p.mode=30;break}p.have=0,p.mode=19;case 19:for(;p.have<p.nlen+p.ndist;){for(;lt=(A=p.lencode[D&(1<<p.lenbits)-1])>>>16&255,Et=65535&A,!((ot=A>>>24)<=x);){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(Et<16)D>>>=ot,x-=ot,p.lens[p.have++]=Et;else{if(Et===16){for(T=ot+2;x<T;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(D>>>=ot,x-=ot,p.have===0){R.msg="invalid bit length repeat",p.mode=30;break}c=p.lens[p.have-1],$=3+(3&D),D>>>=2,x-=2}else if(Et===17){for(T=ot+3;x<T;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}x-=ot,c=0,$=3+(7&(D>>>=ot)),D>>>=3,x-=3}else{for(T=ot+7;x<T;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}x-=ot,c=0,$=11+(127&(D>>>=ot)),D>>>=7,x-=7}if(p.have+$>p.nlen+p.ndist){R.msg="invalid bit length repeat",p.mode=30;break}for(;$--;)p.lens[p.have++]=c}}if(p.mode===30)break;if(p.lens[256]===0){R.msg="invalid code -- missing end-of-block",p.mode=30;break}if(p.lenbits=9,B={bits:p.lenbits},F=g(m,p.lens,0,p.nlen,p.lencode,0,p.work,B),p.lenbits=B.bits,F){R.msg="invalid literal/lengths set",p.mode=30;break}if(p.distbits=6,p.distcode=p.distdyn,B={bits:p.distbits},F=g(_,p.lens,p.nlen,p.ndist,p.distcode,0,p.work,B),p.distbits=B.bits,F){R.msg="invalid distances set",p.mode=30;break}if(p.mode=20,P===6)break t;case 20:p.mode=21;case 21:if(6<=j&&258<=Q){R.next_out=et,R.avail_out=Q,R.next_in=z,R.avail_in=j,p.hold=D,p.bits=x,u(R,X),et=R.next_out,tt=R.output,Q=R.avail_out,z=R.next_in,U=R.input,j=R.avail_in,D=p.hold,x=p.bits,p.mode===12&&(p.back=-1);break}for(p.back=0;lt=(A=p.lencode[D&(1<<p.lenbits)-1])>>>16&255,Et=65535&A,!((ot=A>>>24)<=x);){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(lt&&!(240&lt)){for(mt=ot,Dt=lt,xt=Et;lt=(A=p.lencode[xt+((D&(1<<mt+Dt)-1)>>mt)])>>>16&255,Et=65535&A,!(mt+(ot=A>>>24)<=x);){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}D>>>=mt,x-=mt,p.back+=mt}if(D>>>=ot,x-=ot,p.back+=ot,p.length=Et,lt===0){p.mode=26;break}if(32&lt){p.back=-1,p.mode=12;break}if(64&lt){R.msg="invalid literal/length code",p.mode=30;break}p.extra=15&lt,p.mode=22;case 22:if(p.extra){for(T=p.extra;x<T;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}p.length+=D&(1<<p.extra)-1,D>>>=p.extra,x-=p.extra,p.back+=p.extra}p.was=p.length,p.mode=23;case 23:for(;lt=(A=p.distcode[D&(1<<p.distbits)-1])>>>16&255,Et=65535&A,!((ot=A>>>24)<=x);){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(!(240&lt)){for(mt=ot,Dt=lt,xt=Et;lt=(A=p.distcode[xt+((D&(1<<mt+Dt)-1)>>mt)])>>>16&255,Et=65535&A,!(mt+(ot=A>>>24)<=x);){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}D>>>=mt,x-=mt,p.back+=mt}if(D>>>=ot,x-=ot,p.back+=ot,64&lt){R.msg="invalid distance code",p.mode=30;break}p.offset=Et,p.extra=15&lt,p.mode=24;case 24:if(p.extra){for(T=p.extra;x<T;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}p.offset+=D&(1<<p.extra)-1,D>>>=p.extra,x-=p.extra,p.back+=p.extra}if(p.offset>p.dmax){R.msg="invalid distance too far back",p.mode=30;break}p.mode=25;case 25:if(Q===0)break t;if($=X-Q,p.offset>$){if(($=p.offset-$)>p.whave&&p.sane){R.msg="invalid distance too far back",p.mode=30;break}_t=$>p.wnext?($-=p.wnext,p.wsize-$):p.wnext-$,$>p.length&&($=p.length),wt=p.window}else wt=tt,_t=et-p.offset,$=p.length;for(Q<$&&($=Q),Q-=$,p.length-=$;tt[et++]=wt[_t++],--$;);p.length===0&&(p.mode=21);break;case 26:if(Q===0)break t;tt[et++]=p.length,Q--,p.mode=21;break;case 27:if(p.wrap){for(;x<32;){if(j===0)break t;j--,D|=U[z++]<<x,x+=8}if(X-=Q,R.total_out+=X,p.total+=X,X&&(R.adler=p.check=p.flags?o(p.check,tt,X,et-X):a(p.check,tt,X,et-X)),X=Q,(p.flags?D:f(D))!==p.check){R.msg="incorrect data check",p.mode=30;break}x=D=0}p.mode=28;case 28:if(p.wrap&&p.flags){for(;x<32;){if(j===0)break t;j--,D+=U[z++]<<x,x+=8}if(D!==(4294967295&p.total)){R.msg="incorrect length check",p.mode=30;break}x=D=0}p.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return l}return R.next_out=et,R.avail_out=Q,R.next_in=z,R.avail_in=j,p.hold=D,p.bits=x,(p.wsize||X!==R.avail_out&&p.mode<30&&(p.mode<27||P!==4))&&Z(R,R.output,R.next_out,X-R.avail_out)?(p.mode=31,-4):(it-=R.avail_in,X-=R.avail_out,R.total_in+=it,R.total_out+=X,p.total+=X,p.wrap&&X&&(R.adler=p.check=p.flags?o(p.check,tt,X,R.next_out-X):a(p.check,tt,X,R.next_out-X)),R.data_type=p.bits+(p.last?64:0)+(p.mode===12?128:0)+(p.mode===20||p.mode===15?256:0),(it==0&&X===0||P===4)&&F===d&&(F=-5),F)},r.inflateEnd=function(R){if(!R||!R.state)return l;var P=R.state;return P.window&&(P.window=null),R.state=null,d},r.inflateGetHeader=function(R,P){var p;return R&&R.state&&2&(p=R.state).wrap?((p.head=P).done=!1,d):l},r.inflateSetDictionary=function(R,P){var p,U=P.length;return R&&R.state?(p=R.state).wrap!==0&&p.mode!==11?l:p.mode===11&&a(1,P,U,0)!==p.check?-3:Z(R,P,U,U)?(p.mode=31,-4):(p.havedict=1,d):l},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,i,r){var s=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(m,_,d,l,b,h,E,f){var y,v,I,w,k,L,O,S,M,Z=f.bits,R=0,P=0,p=0,U=0,tt=0,z=0,et=0,j=0,Q=0,D=0,x=null,it=0,X=new s.Buf16(16),$=new s.Buf16(16),_t=null,wt=0;for(R=0;R<=15;R++)X[R]=0;for(P=0;P<l;P++)X[_[d+P]]++;for(tt=Z,U=15;1<=U&&X[U]===0;U--);if(U<tt&&(tt=U),U===0)return b[h++]=20971520,b[h++]=20971520,f.bits=1,0;for(p=1;p<U&&X[p]===0;p++);for(tt<p&&(tt=p),R=j=1;R<=15;R++)if(j<<=1,(j-=X[R])<0)return-1;if(0<j&&(m===0||U!==1))return-1;for($[1]=0,R=1;R<15;R++)$[R+1]=$[R]+X[R];for(P=0;P<l;P++)_[d+P]!==0&&(E[$[_[d+P]]++]=P);if(L=m===0?(x=_t=E,19):m===1?(x=a,it-=257,_t=o,wt-=257,256):(x=u,_t=g,-1),R=p,k=h,et=P=D=0,I=-1,w=(Q=1<<(z=tt))-1,m===1&&852<Q||m===2&&592<Q)return 1;for(;;){for(O=R-et,M=E[P]<L?(S=0,E[P]):E[P]>L?(S=_t[wt+E[P]],x[it+E[P]]):(S=96,0),y=1<<R-et,p=v=1<<z;b[k+(D>>et)+(v-=y)]=O<<24|S<<16|M|0,v!==0;);for(y=1<<R-1;D&y;)y>>=1;if(y!==0?(D&=y-1,D+=y):D=0,P++,--X[R]==0){if(R===U)break;R=_[d+E[P]]}if(tt<R&&(D&w)!==I){for(et===0&&(et=tt),k+=p,j=1<<(z=R-et);z+et<U&&!((j-=X[z+et])<=0);)z++,j<<=1;if(Q+=1<<z,m===1&&852<Q||m===2&&592<Q)return 1;b[I=D&w]=tt<<24|z<<16|k-h|0}}return D!==0&&(b[k+D]=R-et<<24|64<<16|0),f.bits=tt,0}},{"../utils/common":41}],51:[function(n,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,i,r){var s=n("../utils/common"),a=0,o=1;function u(A){for(var N=A.length;0<=--N;)A[N]=0}var g=0,m=29,_=256,d=_+1+m,l=30,b=19,h=2*d+1,E=15,f=16,y=7,v=256,I=16,w=17,k=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=new Array(2*(d+2));u(Z);var R=new Array(2*l);u(R);var P=new Array(512);u(P);var p=new Array(256);u(p);var U=new Array(m);u(U);var tt,z,et,j=new Array(l);function Q(A,N,K,W,C){this.static_tree=A,this.extra_bits=N,this.extra_base=K,this.elems=W,this.max_length=C,this.has_stree=A&&A.length}function D(A,N){this.dyn_tree=A,this.max_code=0,this.stat_desc=N}function x(A){return A<256?P[A]:P[256+(A>>>7)]}function it(A,N){A.pending_buf[A.pending++]=255&N,A.pending_buf[A.pending++]=N>>>8&255}function X(A,N,K){A.bi_valid>f-K?(A.bi_buf|=N<<A.bi_valid&65535,it(A,A.bi_buf),A.bi_buf=N>>f-A.bi_valid,A.bi_valid+=K-f):(A.bi_buf|=N<<A.bi_valid&65535,A.bi_valid+=K)}function $(A,N,K){X(A,K[2*N],K[2*N+1])}function _t(A,N){for(var K=0;K|=1&A,A>>>=1,K<<=1,0<--N;);return K>>>1}function wt(A,N,K){var W,C,q=new Array(E+1),J=0;for(W=1;W<=E;W++)q[W]=J=J+K[W-1]<<1;for(C=0;C<=N;C++){var V=A[2*C+1];V!==0&&(A[2*C]=_t(q[V]++,V))}}function ot(A){var N;for(N=0;N<d;N++)A.dyn_ltree[2*N]=0;for(N=0;N<l;N++)A.dyn_dtree[2*N]=0;for(N=0;N<b;N++)A.bl_tree[2*N]=0;A.dyn_ltree[2*v]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function lt(A){8<A.bi_valid?it(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function Et(A,N,K,W){var C=2*N,q=2*K;return A[C]<A[q]||A[C]===A[q]&&W[N]<=W[K]}function mt(A,N,K){for(var W=A.heap[K],C=K<<1;C<=A.heap_len&&(C<A.heap_len&&Et(N,A.heap[C+1],A.heap[C],A.depth)&&C++,!Et(N,W,A.heap[C],A.depth));)A.heap[K]=A.heap[C],K=C,C<<=1;A.heap[K]=W}function Dt(A,N,K){var W,C,q,J,V=0;if(A.last_lit!==0)for(;W=A.pending_buf[A.d_buf+2*V]<<8|A.pending_buf[A.d_buf+2*V+1],C=A.pending_buf[A.l_buf+V],V++,W===0?$(A,C,N):($(A,(q=p[C])+_+1,N),(J=L[q])!==0&&X(A,C-=U[q],J),$(A,q=x(--W),K),(J=O[q])!==0&&X(A,W-=j[q],J)),V<A.last_lit;);$(A,v,N)}function xt(A,N){var K,W,C,q=N.dyn_tree,J=N.stat_desc.static_tree,V=N.stat_desc.has_stree,rt=N.stat_desc.elems,ft=-1;for(A.heap_len=0,A.heap_max=h,K=0;K<rt;K++)q[2*K]!==0?(A.heap[++A.heap_len]=ft=K,A.depth[K]=0):q[2*K+1]=0;for(;A.heap_len<2;)q[2*(C=A.heap[++A.heap_len]=ft<2?++ft:0)]=1,A.depth[C]=0,A.opt_len--,V&&(A.static_len-=J[2*C+1]);for(N.max_code=ft,K=A.heap_len>>1;1<=K;K--)mt(A,q,K);for(C=rt;K=A.heap[1],A.heap[1]=A.heap[A.heap_len--],mt(A,q,1),W=A.heap[1],A.heap[--A.heap_max]=K,A.heap[--A.heap_max]=W,q[2*C]=q[2*K]+q[2*W],A.depth[C]=(A.depth[K]>=A.depth[W]?A.depth[K]:A.depth[W])+1,q[2*K+1]=q[2*W+1]=C,A.heap[1]=C++,mt(A,q,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],function(ut,Nt){var je,Bt,Ke,gt,An,vr,Wt=Nt.dyn_tree,ki=Nt.max_code,na=Nt.stat_desc.static_tree,ra=Nt.stat_desc.has_stree,ia=Nt.stat_desc.extra_bits,Ni=Nt.stat_desc.extra_base,We=Nt.stat_desc.max_length,Tn=0;for(gt=0;gt<=E;gt++)ut.bl_count[gt]=0;for(Wt[2*ut.heap[ut.heap_max]+1]=0,je=ut.heap_max+1;je<h;je++)We<(gt=Wt[2*Wt[2*(Bt=ut.heap[je])+1]+1]+1)&&(gt=We,Tn++),Wt[2*Bt+1]=gt,ki<Bt||(ut.bl_count[gt]++,An=0,Ni<=Bt&&(An=ia[Bt-Ni]),vr=Wt[2*Bt],ut.opt_len+=vr*(gt+An),ra&&(ut.static_len+=vr*(na[2*Bt+1]+An)));if(Tn!==0){do{for(gt=We-1;ut.bl_count[gt]===0;)gt--;ut.bl_count[gt]--,ut.bl_count[gt+1]+=2,ut.bl_count[We]--,Tn-=2}while(0<Tn);for(gt=We;gt!==0;gt--)for(Bt=ut.bl_count[gt];Bt!==0;)ki<(Ke=ut.heap[--je])||(Wt[2*Ke+1]!==gt&&(ut.opt_len+=(gt-Wt[2*Ke+1])*Wt[2*Ke],Wt[2*Ke+1]=gt),Bt--)}}(A,N),wt(q,ft,A.bl_count)}function c(A,N,K){var W,C,q=-1,J=N[1],V=0,rt=7,ft=4;for(J===0&&(rt=138,ft=3),N[2*(K+1)+1]=65535,W=0;W<=K;W++)C=J,J=N[2*(W+1)+1],++V<rt&&C===J||(V<ft?A.bl_tree[2*C]+=V:C!==0?(C!==q&&A.bl_tree[2*C]++,A.bl_tree[2*I]++):V<=10?A.bl_tree[2*w]++:A.bl_tree[2*k]++,q=C,ft=(V=0)===J?(rt=138,3):C===J?(rt=6,3):(rt=7,4))}function F(A,N,K){var W,C,q=-1,J=N[1],V=0,rt=7,ft=4;for(J===0&&(rt=138,ft=3),W=0;W<=K;W++)if(C=J,J=N[2*(W+1)+1],!(++V<rt&&C===J)){if(V<ft)for(;$(A,C,A.bl_tree),--V!=0;);else C!==0?(C!==q&&($(A,C,A.bl_tree),V--),$(A,I,A.bl_tree),X(A,V-3,2)):V<=10?($(A,w,A.bl_tree),X(A,V-3,3)):($(A,k,A.bl_tree),X(A,V-11,7));q=C,ft=(V=0)===J?(rt=138,3):C===J?(rt=6,3):(rt=7,4)}}u(j);var B=!1;function T(A,N,K,W){X(A,(g<<1)+(W?1:0),3),function(C,q,J,V){lt(C),V&&(it(C,J),it(C,~J)),s.arraySet(C.pending_buf,C.window,q,J,C.pending),C.pending+=J}(A,N,K,!0)}r._tr_init=function(A){B||(function(){var N,K,W,C,q,J=new Array(E+1);for(C=W=0;C<m-1;C++)for(U[C]=W,N=0;N<1<<L[C];N++)p[W++]=C;for(p[W-1]=C,C=q=0;C<16;C++)for(j[C]=q,N=0;N<1<<O[C];N++)P[q++]=C;for(q>>=7;C<l;C++)for(j[C]=q<<7,N=0;N<1<<O[C]-7;N++)P[256+q++]=C;for(K=0;K<=E;K++)J[K]=0;for(N=0;N<=143;)Z[2*N+1]=8,N++,J[8]++;for(;N<=255;)Z[2*N+1]=9,N++,J[9]++;for(;N<=279;)Z[2*N+1]=7,N++,J[7]++;for(;N<=287;)Z[2*N+1]=8,N++,J[8]++;for(wt(Z,d+1,J),N=0;N<l;N++)R[2*N+1]=5,R[2*N]=_t(N,5);tt=new Q(Z,L,_+1,d,E),z=new Q(R,O,0,l,E),et=new Q(new Array(0),S,0,b,y)}(),B=!0),A.l_desc=new D(A.dyn_ltree,tt),A.d_desc=new D(A.dyn_dtree,z),A.bl_desc=new D(A.bl_tree,et),A.bi_buf=0,A.bi_valid=0,ot(A)},r._tr_stored_block=T,r._tr_flush_block=function(A,N,K,W){var C,q,J=0;0<A.level?(A.strm.data_type===2&&(A.strm.data_type=function(V){var rt,ft=4093624447;for(rt=0;rt<=31;rt++,ft>>>=1)if(1&ft&&V.dyn_ltree[2*rt]!==0)return a;if(V.dyn_ltree[18]!==0||V.dyn_ltree[20]!==0||V.dyn_ltree[26]!==0)return o;for(rt=32;rt<_;rt++)if(V.dyn_ltree[2*rt]!==0)return o;return a}(A)),xt(A,A.l_desc),xt(A,A.d_desc),J=function(V){var rt;for(c(V,V.dyn_ltree,V.l_desc.max_code),c(V,V.dyn_dtree,V.d_desc.max_code),xt(V,V.bl_desc),rt=b-1;3<=rt&&V.bl_tree[2*M[rt]+1]===0;rt--);return V.opt_len+=3*(rt+1)+5+5+4,rt}(A),C=A.opt_len+3+7>>>3,(q=A.static_len+3+7>>>3)<=C&&(C=q)):C=q=K+5,K+4<=C&&N!==-1?T(A,N,K,W):A.strategy===4||q===C?(X(A,2+(W?1:0),3),Dt(A,Z,R)):(X(A,4+(W?1:0),3),function(V,rt,ft,ut){var Nt;for(X(V,rt-257,5),X(V,ft-1,5),X(V,ut-4,4),Nt=0;Nt<ut;Nt++)X(V,V.bl_tree[2*M[Nt]+1],3);F(V,V.dyn_ltree,rt-1),F(V,V.dyn_dtree,ft-1)}(A,A.l_desc.max_code+1,A.d_desc.max_code+1,J+1),Dt(A,A.dyn_ltree,A.dyn_dtree)),ot(A),W&&lt(A)},r._tr_tally=function(A,N,K){return A.pending_buf[A.d_buf+2*A.last_lit]=N>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&N,A.pending_buf[A.l_buf+A.last_lit]=255&K,A.last_lit++,N===0?A.dyn_ltree[2*K]++:(A.matches++,N--,A.dyn_ltree[2*(p[K]+_+1)]++,A.dyn_dtree[2*x(N)]++),A.last_lit===A.lit_bufsize-1},r._tr_align=function(A){X(A,2,3),$(A,v,Z),function(N){N.bi_valid===16?(it(N,N.bi_buf),N.bi_buf=0,N.bi_valid=0):8<=N.bi_valid&&(N.pending_buf[N.pending++]=255&N.bi_buf,N.bi_buf>>=8,N.bi_valid-=8)}(A)}},{"../utils/common":41}],53:[function(n,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,i,r){(function(s){(function(a,o){if(!a.setImmediate){var u,g,m,_,d=1,l={},b=!1,h=a.document,E=Object.getPrototypeOf&&Object.getPrototypeOf(a);E=E&&E.setTimeout?E:a,u={}.toString.call(a.process)==="[object process]"?function(I){process.nextTick(function(){y(I)})}:function(){if(a.postMessage&&!a.importScripts){var I=!0,w=a.onmessage;return a.onmessage=function(){I=!1},a.postMessage("","*"),a.onmessage=w,I}}()?(_="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",v,!1):a.attachEvent("onmessage",v),function(I){a.postMessage(_+I,"*")}):a.MessageChannel?((m=new MessageChannel).port1.onmessage=function(I){y(I.data)},function(I){m.port2.postMessage(I)}):h&&"onreadystatechange"in h.createElement("script")?(g=h.documentElement,function(I){var w=h.createElement("script");w.onreadystatechange=function(){y(I),w.onreadystatechange=null,g.removeChild(w),w=null},g.appendChild(w)}):function(I){setTimeout(y,0,I)},E.setImmediate=function(I){typeof I!="function"&&(I=new Function(""+I));for(var w=new Array(arguments.length-1),k=0;k<w.length;k++)w[k]=arguments[k+1];var L={callback:I,args:w};return l[d]=L,u(d),d++},E.clearImmediate=f}function f(I){delete l[I]}function y(I){if(b)setTimeout(y,0,I);else{var w=l[I];if(w){b=!0;try{(function(k){var L=k.callback,O=k.args;switch(O.length){case 0:L();break;case 1:L(O[0]);break;case 2:L(O[0],O[1]);break;case 3:L(O[0],O[1],O[2]);break;default:L.apply(o,O)}})(w)}finally{f(I),b=!1}}}}function v(I){I.source===a&&typeof I.data=="string"&&I.data.indexOf(_)===0&&y(+I.data.slice(_.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Ve<"u"?Ve:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Or);var os=Or.exports,us=as(os);async function Pr(t){if(t.name.endsWith(".zip")){const n=await new us().loadAsync(t);if(!n.files)throw new Error("Zip:"+t.name);for(const i in n.files)if(!n.files[i].dir){const r=n.files[i],s=await r.async("blob"),a=s.stream();return{fileName:r.name,fileSize:s.size,stream:a,zippedFilePath:t.name}}throw new Error}else{const e=t.stream();return{fileName:t.name,fileSize:t.size,stream:e}}}const dt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,yt=Object.keys,At=Array.isArray;function Rt(t,e){return typeof e!="object"||yt(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||dt.Promise||(dt.Promise=Promise);const Te=Object.getPrototypeOf,ls={}.hasOwnProperty;function St(t,e){return ls.call(t,e)}function le(t,e){typeof e=="function"&&(e=e(Te(t))),(typeof Reflect>"u"?yt:Reflect.ownKeys)(e).forEach(n=>{Mt(t,n,e[n])})}const Dr=Object.defineProperty;function Mt(t,e,n,i){Dr(t,e,Rt(n&&St(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function he(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Mt(t.prototype,"constructor",t),{extend:le.bind(null,t.prototype)}}}}const hs=Object.getOwnPropertyDescriptor;function kn(t,e){let n;return hs(t,e)||(n=Te(t))&&kn(n,e)}const cs=[].slice;function Ye(t,e,n){return cs.call(t,e,n)}function Br(t,e){return e(t)}function we(t){if(!t)throw new Error("Assertion Failed")}function Mr(t){dt.setImmediate?setImmediate(t):setTimeout(t,0)}function Ur(t,e){return t.reduce((n,i,r)=>{var s=e(i,r);return s&&(n[s[0]]=s[1]),n},{})}function Ut(t,e){if(St(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],i=0,r=e.length;i<r;++i){var s=Ut(t,e[i]);n.push(s)}return n}var a=e.indexOf(".");if(a!==-1){var o=t[e.substr(0,a)];return o===void 0?void 0:Ut(o,e.substr(a+1))}}function Ct(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){we(typeof n!="string"&&"length"in n);for(var i=0,r=e.length;i<r;++i)Ct(t,e[i],n[i])}else{var s=e.indexOf(".");if(s!==-1){var a=e.substr(0,s),o=e.substr(s+1);if(o==="")n===void 0?At(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var u=t[a];u&&St(t,a)||(u=t[a]={}),Ct(u,o,n)}}else n===void 0?At(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Fr(t){var e={};for(var n in t)St(t,n)&&(e[n]=t[n]);return e}const fs=[].concat;function zr(t){return fs.apply([],t)}const Gr="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(zr([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>dt[t]),ds=Gr.map(t=>dt[t]);Ur(Gr,t=>[t,!0]);let qt=null;function Ie(t){qt=typeof WeakMap<"u"&&new WeakMap;const e=Nn(t);return qt=null,e}function Nn(t){if(!t||typeof t!="object")return t;let e=qt&&qt.get(t);if(e)return e;if(At(t)){e=[],qt&&qt.set(t,e);for(var n=0,i=t.length;n<i;++n)e.push(Nn(t[n]))}else if(ds.indexOf(t.constructor)>=0)e=t;else{const s=Te(t);for(var r in e=s===Object.prototype?{}:Object.create(s),qt&&qt.set(t,e),t)St(t,r)&&(e[r]=Nn(t[r]))}return e}const{toString:ps}={};function Cn(t){return ps.call(t).slice(8,-1)}const xn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",_s=typeof xn=="symbol"?function(t){var e;return t!=null&&(e=t[xn])&&e.apply(t)}:function(){return null},ce={};function Ft(t){var e,n,i,r;if(arguments.length===1){if(At(t))return t.slice();if(this===ce&&typeof t=="string")return[t];if(r=_s(t)){for(n=[];!(i=r.next()).done;)n.push(i.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const On=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Ot=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function jr(t,e){Ot=t,Kr=e}var Kr=()=>!0;const ms=!new Error("").stack;function te(){if(ms)try{throw te.arguments,new Error}catch(t){return t}return new Error}function Pn(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Kr).map(i=>`
`+i).join("")):""}var Wr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Dn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Wr),gs={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function fe(t,e){this._e=te(),this.name=t,this.message=e}function Zr(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,i,r)=>r.indexOf(n)===i).join(`
`)}function Xe(t,e,n,i){this._e=te(),this.failures=e,this.failedKeys=i,this.successCount=n,this.message=Zr(t,e)}function Re(t,e){this._e=te(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Zr(t,e)}he(fe).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Pn(this._e,2))}},toString:function(){return this.name+": "+this.message}}),he(Xe).from(fe),he(Re).from(fe);var Bn=Dn.reduce((t,e)=>(t[e]=e+"Error",t),{});const ys=fe;var st=Dn.reduce((t,e)=>{var n=e+"Error";function i(r,s){this._e=te(),this.name=n,r?typeof r=="string"?(this.message=`${r}${s?`
 `+s:""}`,this.inner=s||null):typeof r=="object"&&(this.message=`${r.name} ${r.message}`,this.inner=r):(this.message=gs[e]||n,this.inner=null)}return he(i).from(ys),t[e]=i,t},{});st.Syntax=SyntaxError,st.Type=TypeError,st.Range=RangeError;var Hr=Wr.reduce((t,e)=>(t[e+"Error"]=st[e],t),{}),Je=Dn.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=st[e]),t),{});function ct(){}function Le(t){return t}function bs(t,e){return t==null||t===Le?e:function(n){return e(t(n))}}function ee(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Es(t,e){return t===ct?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var i=this.onsuccess,r=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ee(i,this.onsuccess):i),r&&(this.onerror=this.onerror?ee(r,this.onerror):r),s!==void 0?s:n}}function vs(t,e){return t===ct?e:function(){t.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ee(n,this.onsuccess):n),i&&(this.onerror=this.onerror?ee(i,this.onerror):i)}}function As(t,e){return t===ct?e:function(n){var i=t.apply(this,arguments);Rt(n,i);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ee(r,this.onsuccess):r),s&&(this.onerror=this.onerror?ee(s,this.onerror):s),i===void 0?a===void 0?void 0:a:Rt(i,a)}}function Ts(t,e){return t===ct?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function Mn(t,e){return t===ct?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var i=this,r=arguments.length,s=new Array(r);r--;)s[r]=arguments[r];return n.then(function(){return e.apply(i,s)})}return e.apply(this,arguments)}}Je.ModifyError=Xe,Je.DexieError=fe,Je.BulkError=Re;var Se={};const qr=100,[Un,Qe,Fn]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,Te(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Te(e),t]})(),Vr=Qe&&Qe.then,tn=Un&&Un.constructor,zn=!!Fn;var Gn=!1,ws=Fn?()=>{Fn.then(sn)}:dt.setImmediate?setImmediate.bind(null,sn):dt.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{sn(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(sn,0)},ke=function(t,e){Ne.push([t,e]),en&&(ws(),en=!1)},jn=!0,en=!0,ne=[],nn=[],Kn=null,Wn=Le,de={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ii,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{ii(t[0],t[1])}catch{}})}},nt=de,Ne=[],re=0,rn=[];function Y(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ct,this._lib=!1;var e=this._PSD=nt;if(Ot&&(this._stackHolder=te(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Se)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Hn(this,this._value))}this._state=null,this._value=null,++e.ref,Yr(this,t)}const Zn={get:function(){var t=nt,e=un;function n(i,r){var s=!t.global&&(t!==nt||e!==un);const a=s&&!zt();var o=new Y((u,g)=>{qn(this,new $r(hn(i,t,s,a),hn(r,t,s,a),u,g,t))});return Ot&&Qr(o,this),o}return n.prototype=Se,n},set:function(t){Mt(this,"then",t&&t.prototype===Se?Zn:{get:function(){return t},set:Zn.set})}};function $r(t,e,n,i,r){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=i,this.psd=r}function Yr(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var i=t._lib&&Ce();n&&typeof n.then=="function"?Yr(t,(r,s)=>{n instanceof Y?n._then(r,s):n.then(r,s)}):(t._state=!0,t._value=n,Xr(t)),i&&xe()}},Hn.bind(null,t))}catch(n){Hn(t,n)}}function Hn(t,e){if(nn.push(e),t._state===null){var n=t._lib&&Ce();e=Wn(e),t._state=!1,t._value=e,Ot&&e!==null&&typeof e=="object"&&!e._promise&&function(i,r,s){try{i.apply(null,s)}catch(a){r&&r(a)}}(()=>{var i=kn(e,"stack");e._promise=t,Mt(e,"stack",{get:()=>Gn?i&&(i.get?i.get.apply(e):i.value):t.stack})}),function(i){ne.some(r=>r._value===i._value)||ne.push(i)}(t),Xr(t),n&&xe()}}function Xr(t){var e=t._listeners;t._listeners=[];for(var n=0,i=e.length;n<i;++n)qn(t,e[n]);var r=t._PSD;--r.ref||r.finalize(),re===0&&(++re,ke(()=>{--re==0&&Vn()},[]))}function qn(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++re,ke(Is,[n,t,e])}else t._listeners.push(e)}function Is(t,e,n){try{Kn=e;var i,r=e._value;e._state?i=t(r):(nn.length&&(nn=[]),i=t(r),nn.indexOf(r)===-1&&function(s){for(var a=ne.length;a;)if(ne[--a]._value===s._value)return void ne.splice(a,1)}(e)),n.resolve(i)}catch(s){n.reject(s)}finally{Kn=null,--re==0&&Vn(),--n.psd.ref||n.psd.finalize()}}function Jr(t,e,n){if(e.length===n)return e;var i="";if(t._state===!1){var r,s,a=t._value;a!=null?(r=a.name||"Error",s=a.message||a,i=Pn(a,0)):(r=a,s=""),e.push(r+(s?": "+s:"")+i)}return Ot&&((i=Pn(t._stackHolder,2))&&e.indexOf(i)===-1&&e.push(i),t._prev&&Jr(t._prev,e,n)),e}function Qr(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function sn(){Ce()&&xe()}function Ce(){var t=jn;return jn=!1,en=!1,t}function xe(){var t,e,n;do for(;Ne.length>0;)for(t=Ne,Ne=[],n=t.length,e=0;e<n;++e){var i=t[e];i[0].apply(null,i[1])}while(Ne.length>0);jn=!0,en=!0}function Vn(){var t=ne;ne=[],t.forEach(i=>{i._PSD.onunhandled.call(null,i._value,i)});for(var e=rn.slice(0),n=e.length;n;)e[--n]()}function an(t){return new Y(Se,!1,t)}function pt(t,e){var n=nt;return function(){var i=Ce(),r=nt;try{return $t(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{$t(r,!1),i&&xe()}}}le(Y.prototype,{then:Zn,_then:function(t,e){qn(this,new $r(null,null,t,e,nt))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,i=>i instanceof e?n(i):an(i)):this.then(null,i=>i&&i.name===e?n(i):an(i))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),an(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Gn=!0;var t=Jr(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Gn=!1}}},timeout:function(t,e){return t<1/0?new Y((n,i)=>{var r=setTimeout(()=>i(new st.Timeout(e)),t);this.then(n,i).finally(clearTimeout.bind(null,r))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Mt(Y.prototype,Symbol.toStringTag,"Dexie.Promise"),de.env=ti(),le(Y,{all:function(){var t=Ft.apply(null,arguments).map(ln);return new Y(function(e,n){t.length===0&&e([]);var i=t.length;t.forEach((r,s)=>Y.resolve(r).then(a=>{t[s]=a,--i||e(t)},n))})},resolve:t=>{if(t instanceof Y)return t;if(t&&typeof t.then=="function")return new Y((n,i)=>{t.then(n,i)});var e=new Y(Se,!0,t);return Qr(e,Kn),e},reject:an,race:function(){var t=Ft.apply(null,arguments).map(ln);return new Y((e,n)=>{t.map(i=>Y.resolve(i).then(e,n))})},PSD:{get:()=>nt,set:t=>nt=t},totalEchoes:{get:()=>un},newPSD:Vt,usePSD:_e,scheduler:{get:()=>ke,set:t=>{ke=t}},rejectionMapper:{get:()=>Wn,set:t=>{Wn=t}},follow:(t,e)=>new Y((n,i)=>Vt((r,s)=>{var a=nt;a.unhandleds=[],a.onunhandled=s,a.finalize=ee(function(){(function(o){function u(){o(),rn.splice(rn.indexOf(u),1)}rn.push(u),++re,ke(()=>{--re==0&&Vn()},[])})(()=>{this.unhandleds.length===0?r():s(this.unhandleds[0])})},a.finalize),t()},e,n,i))}),tn&&(tn.allSettled&&Mt(Y,"allSettled",function(){const t=Ft.apply(null,arguments).map(ln);return new Y(e=>{t.length===0&&e([]);let n=t.length;const i=new Array(n);t.forEach((r,s)=>Y.resolve(r).then(a=>i[s]={status:"fulfilled",value:a},a=>i[s]={status:"rejected",reason:a}).then(()=>--n||e(i)))})}),tn.any&&typeof AggregateError<"u"&&Mt(Y,"any",function(){const t=Ft.apply(null,arguments).map(ln);return new Y((e,n)=>{t.length===0&&n(new AggregateError([]));let i=t.length;const r=new Array(i);t.forEach((s,a)=>Y.resolve(s).then(o=>e(o),o=>{r[a]=o,--i||n(new AggregateError(r))}))})}));const Tt={awaits:0,echoes:0,id:0};var Rs=0,on=[],$n=0,un=0,Ls=0;function Vt(t,e,n,i){var r=nt,s=Object.create(r);s.parent=r,s.ref=0,s.global=!1,s.id=++Ls;var a=de.env;s.env=zn?{Promise:Y,PromiseProp:{value:Y,configurable:!0,writable:!0},all:Y.all,race:Y.race,allSettled:Y.allSettled,any:Y.any,resolve:Y.resolve,reject:Y.reject,nthen:ni(a.nthen,s),gthen:ni(a.gthen,s)}:{},e&&Rt(s,e),++r.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=_e(s,t,n,i);return s.ref===0&&s.finalize(),o}function pe(){return Tt.id||(Tt.id=++Rs),++Tt.awaits,Tt.echoes+=qr,Tt.id}function zt(){return!!Tt.awaits&&(--Tt.awaits==0&&(Tt.id=0),Tt.echoes=Tt.awaits*qr,!0)}function ln(t){return Tt.echoes&&t&&t.constructor===tn?(pe(),t.then(e=>(zt(),e),e=>(zt(),bt(e)))):t}function Ss(t){++un,Tt.echoes&&--Tt.echoes!=0||(Tt.echoes=Tt.id=0),on.push(nt),$t(t,!0)}function ks(){var t=on[on.length-1];on.pop(),$t(t,!1)}function $t(t,e){var n=nt;if((e?!Tt.echoes||$n++&&t===nt:!$n||--$n&&t===nt)||ei(e?Ss.bind(null,t):ks),t!==nt&&(nt=t,n===de&&(de.env=ti()),zn)){var i=de.env.Promise,r=t.env;Qe.then=r.nthen,i.prototype.then=r.gthen,(n.global||t.global)&&(Object.defineProperty(dt,"Promise",r.PromiseProp),i.all=r.all,i.race=r.race,i.resolve=r.resolve,i.reject=r.reject,r.allSettled&&(i.allSettled=r.allSettled),r.any&&(i.any=r.any))}}function ti(){var t=dt.Promise;return zn?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(dt,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Qe.then,gthen:t.prototype.then}:{}}function _e(t,e,n,i,r){var s=nt;try{return $t(t,!0),e(n,i,r)}finally{$t(s,!1)}}function ei(t){Vr.call(Un,t)}function hn(t,e,n,i){return typeof t!="function"?t:function(){var r=nt;n&&pe(),$t(e,!0);try{return t.apply(this,arguments)}finally{$t(r,!1),i&&ei(zt)}}}function ni(t,e){return function(n,i){return t.call(this,hn(n,e),hn(i,e))}}(""+Vr).indexOf("[native code]")===-1&&(pe=zt=ct);const ri="unhandledrejection";function ii(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var i,r={promise:e,reason:t};if(dt.document&&document.createEvent?((i=document.createEvent("Event")).initEvent(ri,!0,!0),Rt(i,r)):dt.CustomEvent&&Rt(i=new CustomEvent(ri,{detail:r}),r),i&&dt.dispatchEvent&&(dispatchEvent(i),!dt.PromiseRejectionEvent&&dt.onunhandledrejection))try{dt.onunhandledrejection(i)}catch{}Ot&&i&&!i.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var bt=Y.reject;function Yn(t,e,n,i){if(t.idbdb&&(t._state.openComplete||nt.letThrough||t._vip)){var r=t._createTransaction(e,n,t._dbSchema);try{r.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===Bn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Yn(t,e,n,i))):bt(s)}return r._promise(e,(s,a)=>Vt(()=>(nt.trans=r,i(s,a,r)))).then(s=>r._completion.then(()=>s))}if(t._state.openComplete)return bt(new st.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return bt(new st.DatabaseClosed);t.open().catch(ct)}return t._state.dbReadyPromise.then(()=>Yn(t,e,n,i))}const si="3.2.4",ie="",Xn=-1/0,Gt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ai="String expected.",Oe=[],cn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Ns=cn,Cs=cn,oi=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),fn="__dbnames",Jn="readonly",Qn="readwrite";function se(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const ui={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function dn(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=Ie(e))[t],e)}class xs{_trans(e,n,i){const r=this._tx||nt.trans,s=this.name;function a(u,g,m){if(!m.schema[s])throw new st.NotFound("Table "+s+" not part of transaction");return n(m.idbtrans,m)}const o=Ce();try{return r&&r.db===this.db?r===nt.trans?r._promise(e,a,i):Vt(()=>r._promise(e,a,i),{trans:r,transless:nt.transless||nt}):Yn(this.db,e,[this.name],a)}finally{o&&xe()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",i=>this.core.get({trans:i,key:e}).then(r=>this.hook.reading.fire(r))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(At(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=yt(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const i=this.schema.indexes.concat(this.schema.primKey).filter(g=>g.compound&&n.every(m=>g.keyPath.indexOf(m)>=0)&&g.keyPath.every(m=>n.indexOf(m)>=0))[0];if(i&&this.db._maxKey!==ie)return this.where(i.name).equals(i.keyPath.map(g=>e[g]));!i&&Ot&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:r}=this.schema,s=this.db._deps.indexedDB;function a(g,m){try{return s.cmp(g,m)===0}catch{return!1}}const[o,u]=n.reduce(([g,m],_)=>{const d=r[_],l=e[_];return[g||d,g||!d?se(m,d&&d.multi?b=>{const h=Ut(b,_);return At(h)&&h.some(E=>a(l,E))}:b=>a(l,Ut(b,_))):m]},[null,null]);return o?this.where(o.name).equals(e[o.keyPath]).filter(u):i?this.filter(u):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,At(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=i=>{if(!i)return i;const r=Object.create(e.prototype);for(var s in i)if(St(i,s))try{r[s]=i[s]}catch{}return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){Rt(this,e)})}add(e,n){const{auto:i,keyPath:r}=this.schema.primKey;let s=e;return r&&i&&(s=dn(r)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:n!=null?[n]:null,values:[s]})).then(a=>a.numFailures?Y.reject(a.failures[0]):a.lastResult).then(a=>{if(r)try{Ct(e,r,a)}catch{}return a})}update(e,n){if(typeof e!="object"||At(e))return this.where(":id").equals(e).modify(n);{const i=Ut(e,this.schema.primKey.keyPath);if(i===void 0)return bt(new st.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?yt(n).forEach(r=>{Ct(e,r,n[r])}):n(e,{value:e,primKey:i})}catch{}return this.where(":id").equals(i).modify(n)}}put(e,n){const{auto:i,keyPath:r}=this.schema.primKey;let s=e;return r&&i&&(s=dn(r)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[s],keys:n!=null?[n]:null})).then(a=>a.numFailures?Y.reject(a.failures[0]):a.lastResult).then(a=>{if(r)try{Ct(e,r,a)}catch{}return a})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?Y.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:ui})).then(e=>e.numFailures?Y.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(i=>i.map(r=>this.hook.reading.fire(r))))}bulkAdd(e,n,i){const r=Array.isArray(n)?n:void 0,s=(i=i||(r?void 0:n))?i.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:o,keyPath:u}=this.schema.primKey;if(u&&r)throw new st.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new st.InvalidArgument("Arguments objects and keys must have the same length");const g=e.length;let m=u&&o?e.map(dn(u)):e;return this.core.mutate({trans:a,type:"add",keys:r,values:m,wantResults:s}).then(({numFailures:_,results:d,lastResult:l,failures:b})=>{if(_===0)return s?d:l;throw new Re(`${this.name}.bulkAdd(): ${_} of ${g} operations failed`,b)})})}bulkPut(e,n,i){const r=Array.isArray(n)?n:void 0,s=(i=i||(r?void 0:n))?i.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:o,keyPath:u}=this.schema.primKey;if(u&&r)throw new st.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new st.InvalidArgument("Arguments objects and keys must have the same length");const g=e.length;let m=u&&o?e.map(dn(u)):e;return this.core.mutate({trans:a,type:"put",keys:r,values:m,wantResults:s}).then(({numFailures:_,results:d,lastResult:l,failures:b})=>{if(_===0)return s?d:l;throw new Re(`${this.name}.bulkPut(): ${_} of ${g} operations failed`,b)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",i=>this.core.mutate({trans:i,type:"delete",keys:e})).then(({numFailures:i,lastResult:r,failures:s})=>{if(i===0)return r;throw new Re(`${this.name}.bulkDelete(): ${i} of ${n} operations failed`,s)})}}function Pe(t){var e={},n=function(a,o){if(o){for(var u=arguments.length,g=new Array(u-1);--u;)g[u-1]=arguments[u];return e[a].subscribe.apply(null,g),t}if(typeof a=="string")return e[a]};n.addEventType=s;for(var i=1,r=arguments.length;i<r;++i)s(arguments[i]);return n;function s(a,o,u){if(typeof a!="object"){var g;o||(o=Ts),u||(u=ct);var m={subscribers:[],fire:u,subscribe:function(_){m.subscribers.indexOf(_)===-1&&(m.subscribers.push(_),m.fire=o(m.fire,_))},unsubscribe:function(_){m.subscribers=m.subscribers.filter(function(d){return d!==_}),m.fire=m.subscribers.reduce(o,u)}};return e[a]=n[a]=m,m}yt(g=a).forEach(function(_){var d=g[_];if(At(d))s(_,g[_][0],g[_][1]);else{if(d!=="asap")throw new st.InvalidArgument("Invalid event config");var l=s(_,Le,function(){for(var b=arguments.length,h=new Array(b);b--;)h[b]=arguments[b];l.subscribers.forEach(function(E){Mr(function(){E.apply(null,h)})})})}})}}function De(t,e){return he(e).from({prototype:t}),e}function me(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function tr(t,e){t.filter=se(t.filter,e)}function er(t,e,n){var i=t.replayFilter;t.replayFilter=i?()=>se(i(),e()):e,t.justLimit=n&&!i}function pn(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new st.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function li(t,e,n){const i=pn(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:i,range:t.range}})}function _n(t,e,n,i){const r=t.replayFilter?se(t.filter,t.replayFilter()):t.filter;if(t.or){const s={},a=(o,u,g)=>{if(!r||r(u,g,d=>u.stop(d),d=>u.fail(d))){var m=u.primaryKey,_=""+m;_==="[object ArrayBuffer]"&&(_=""+new Uint8Array(m)),St(s,_)||(s[_]=!0,e(o,u,g))}};return Promise.all([t.or._iterate(a,n),hi(li(t,i,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}return hi(li(t,i,n),se(t.algorithm,r),e,!t.keysOnly&&t.valueMapper)}function hi(t,e,n,i){var r=pt(i?(s,a,o)=>n(i(s),a,o):n);return t.then(s=>{if(s)return s.start(()=>{var a=()=>s.continue();e&&!e(s,o=>a=o,o=>{s.stop(o),a=ct},o=>{s.fail(o),a=ct})||r(s.value,s,o=>a=o),a()})})}function Lt(t,e){try{const n=ci(t),i=ci(e);if(n!==i)return n==="Array"?1:i==="Array"?-1:n==="binary"?1:i==="binary"?-1:n==="string"?1:i==="string"?-1:n==="Date"?1:i!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(r,s){const a=r.length,o=s.length,u=a<o?a:o;for(let g=0;g<u;++g)if(r[g]!==s[g])return r[g]<s[g]?-1:1;return a===o?0:a<o?-1:1}(fi(t),fi(e));case"Array":return function(r,s){const a=r.length,o=s.length,u=a<o?a:o;for(let g=0;g<u;++g){const m=Lt(r[g],s[g]);if(m!==0)return m}return a===o?0:a<o?-1:1}(t,e)}}catch{}return NaN}function ci(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=Cn(t);return n==="ArrayBuffer"?"binary":n}function fi(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class Os{_read(e,n){var i=this._ctx;return i.error?i.table._trans(null,bt.bind(null,i.error)):i.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,bt.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=se(n.algorithm,e)}_iterate(e,n){return _n(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return e&&Rt(i,e),n._ctx=i,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(i=>_n(n,e,i,n.table.core))}count(e){return this._read(n=>{const i=this._ctx,r=i.table.core;if(me(i,!0))return r.count({trans:n,query:{index:pn(i,r.schema),range:i.range}}).then(a=>Math.min(a,i.limit));var s=0;return _n(i,()=>(++s,!1),n,r).then(()=>s)}).then(e)}sortBy(e,n){const i=e.split(".").reverse(),r=i[0],s=i.length-1;function a(g,m){return m?a(g[i[m]],m-1):g[r]}var o=this._ctx.dir==="next"?1:-1;function u(g,m){var _=a(g,s),d=a(m,s);return _<d?-o:_>d?o:0}return this.toArray(function(g){return g.sort(u)}).then(n)}toArray(e){return this._read(n=>{var i=this._ctx;if(i.dir==="next"&&me(i,!0)&&i.limit>0){const{valueMapper:r}=i,s=pn(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:s,range:i.range}}).then(({result:a})=>r?a.map(r):a)}{const r=[];return _n(i,s=>r.push(s),n,i.table.core).then(()=>r)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,me(n)?er(n,()=>{var i=e;return(r,s)=>i===0||(i===1?(--i,!1):(s(()=>{r.advance(i),i=0}),!1))}):er(n,()=>{var i=e;return()=>--i<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),er(this._ctx,()=>{var n=e;return function(i,r,s){return--n<=0&&r(s),n>=0}},!0),this}until(e,n){return tr(this._ctx,function(i,r,s){return!e(i.value)||(r(s),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,i;return tr(this._ctx,function(r){return e(r.value)}),n=this._ctx,i=e,n.isMatch=se(n.isMatch,i),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(i,r){e(r.key,r)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(i,r){e(r.primaryKey,r)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var i=[];return this.each(function(r,s){i.push(s.key)}).then(function(){return i}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&me(n,!0)&&n.limit>0)return this._read(r=>{var s=pn(n,n.table.core.schema);return n.table.core.query({trans:r,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(({result:r})=>r).then(e);n.keysOnly=!n.isMatch;var i=[];return this.each(function(r,s){i.push(s.primaryKey)}).then(function(){return i}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var i={};return tr(this._ctx,function(r){var s=r.primaryKey.toString(),a=St(i,s);return i[s]=!0,!a}),this}modify(e){var n=this._ctx;return this._write(i=>{var r;if(typeof e=="function")r=e;else{var s=yt(e),a=s.length;r=function(h){for(var E=!1,f=0;f<a;++f){var y=s[f],v=e[y];Ut(h,y)!==v&&(Ct(h,y,v),E=!0)}return E}}const o=n.table.core,{outbound:u,extractKey:g}=o.schema.primaryKey,m=this.db._options.modifyChunkSize||200,_=[];let d=0;const l=[],b=(h,E)=>{const{failures:f,numFailures:y}=E;d+=h-y;for(let v of yt(f))_.push(f[v])};return this.clone().primaryKeys().then(h=>{const E=f=>{const y=Math.min(m,h.length-f);return o.getMany({trans:i,keys:h.slice(f,f+y),cache:"immutable"}).then(v=>{const I=[],w=[],k=u?[]:null,L=[];for(let S=0;S<y;++S){const M=v[S],Z={value:Ie(M),primKey:h[f+S]};r.call(Z,Z.value,Z)!==!1&&(Z.value==null?L.push(h[f+S]):u||Lt(g(M),g(Z.value))===0?(w.push(Z.value),u&&k.push(h[f+S])):(L.push(h[f+S]),I.push(Z.value)))}const O=me(n)&&n.limit===1/0&&(typeof e!="function"||e===nr)&&{index:n.index,range:n.range};return Promise.resolve(I.length>0&&o.mutate({trans:i,type:"add",values:I}).then(S=>{for(let M in S.failures)L.splice(parseInt(M),1);b(I.length,S)})).then(()=>(w.length>0||O&&typeof e=="object")&&o.mutate({trans:i,type:"put",keys:k,values:w,criteria:O,changeSpec:typeof e!="function"&&e}).then(S=>b(w.length,S))).then(()=>(L.length>0||O&&e===nr)&&o.mutate({trans:i,type:"delete",keys:L,criteria:O}).then(S=>b(L.length,S))).then(()=>h.length>f+y&&E(f+m))})};return E(0).then(()=>{if(_.length>0)throw new Xe("Error modifying one or more objects",_,d,l);return h.length})})})}delete(){var e=this._ctx,n=e.range;return me(e)&&(e.isPrimKey&&!Cs||n.type===3)?this._write(i=>{const{primaryKey:r}=e.table.core.schema,s=n;return e.table.core.count({trans:i,query:{index:r,range:s}}).then(a=>e.table.core.mutate({trans:i,type:"deleteRange",range:s}).then(({failures:o,lastResult:u,results:g,numFailures:m})=>{if(m)throw new Xe("Could not delete some values",Object.keys(o).map(_=>o[_]),a-m);return a-m}))}):this.modify(nr)}}const nr=(t,e)=>e.value=null;function Ps(t,e){return t<e?-1:t===e?0:1}function Ds(t,e){return t>e?-1:t===e?0:1}function kt(t,e,n){var i=t instanceof pi?new t.Collection(t):t;return i._ctx.error=n?new n(e):new TypeError(e),i}function ge(t){return new t.Collection(t,()=>di("")).limit(0)}function Bs(t,e,n,i,r,s){for(var a=Math.min(t.length,i.length),o=-1,u=0;u<a;++u){var g=e[u];if(g!==i[u])return r(t[u],n[u])<0?t.substr(0,u)+n[u]+n.substr(u+1):r(t[u],i[u])<0?t.substr(0,u)+i[u]+n.substr(u+1):o>=0?t.substr(0,o)+e[o]+n.substr(o+1):null;r(t[u],g)<0&&(o=u)}return a<i.length&&s==="next"?t+n.substr(t.length):a<t.length&&s==="prev"?t.substr(0,n.length):o<0?null:t.substr(0,o)+i[o]+n.substr(o+1)}function mn(t,e,n,i){var r,s,a,o,u,g,m,_=n.length;if(!n.every(h=>typeof h=="string"))return kt(t,ai);function d(h){r=function(f){return f==="next"?y=>y.toUpperCase():y=>y.toLowerCase()}(h),s=function(f){return f==="next"?y=>y.toLowerCase():y=>y.toUpperCase()}(h),a=h==="next"?Ps:Ds;var E=n.map(function(f){return{lower:s(f),upper:r(f)}}).sort(function(f,y){return a(f.lower,y.lower)});o=E.map(function(f){return f.upper}),u=E.map(function(f){return f.lower}),g=h,m=h==="next"?"":i}d("next");var l=new t.Collection(t,()=>Yt(o[0],u[_-1]+i));l._ondirectionchange=function(h){d(h)};var b=0;return l._addAlgorithm(function(h,E,f){var y=h.key;if(typeof y!="string")return!1;var v=s(y);if(e(v,u,b))return!0;for(var I=null,w=b;w<_;++w){var k=Bs(y,v,o[w],u[w],a,g);k===null&&I===null?b=w+1:(I===null||a(I,k)>0)&&(I=k)}return E(I!==null?function(){h.continue(I+m)}:f),!1}),l}function Yt(t,e,n,i){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:i}}function di(t){return{type:1,lower:t,upper:t}}class pi{get Collection(){return this._ctx.table.db.Collection}between(e,n,i,r){i=i!==!1,r=r===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(i||r)&&(!i||!r)?ge(this):new this.Collection(this,()=>Yt(e,n,!i,!r))}catch{return kt(this,Gt)}}equals(e){return e==null?kt(this,Gt):new this.Collection(this,()=>di(e))}above(e){return e==null?kt(this,Gt):new this.Collection(this,()=>Yt(e,void 0,!0))}aboveOrEqual(e){return e==null?kt(this,Gt):new this.Collection(this,()=>Yt(e,void 0,!1))}below(e){return e==null?kt(this,Gt):new this.Collection(this,()=>Yt(void 0,e,!1,!0))}belowOrEqual(e){return e==null?kt(this,Gt):new this.Collection(this,()=>Yt(void 0,e))}startsWith(e){return typeof e!="string"?kt(this,ai):this.between(e,e+ie,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):mn(this,(n,i)=>n.indexOf(i[0])===0,[e],ie)}equalsIgnoreCase(e){return mn(this,(n,i)=>n===i[0],[e],"")}anyOfIgnoreCase(){var e=Ft.apply(ce,arguments);return e.length===0?ge(this):mn(this,(n,i)=>i.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=Ft.apply(ce,arguments);return e.length===0?ge(this):mn(this,(n,i)=>i.some(r=>n.indexOf(r)===0),e,ie)}anyOf(){const e=Ft.apply(ce,arguments);let n=this._cmp;try{e.sort(n)}catch{return kt(this,Gt)}if(e.length===0)return ge(this);const i=new this.Collection(this,()=>Yt(e[0],e[e.length-1]));i._ondirectionchange=s=>{n=s==="next"?this._ascending:this._descending,e.sort(n)};let r=0;return i._addAlgorithm((s,a,o)=>{const u=s.key;for(;n(u,e[r])>0;)if(++r,r===e.length)return a(o),!1;return n(u,e[r])===0||(a(()=>{s.continue(e[r])}),!1)}),i}notEqual(e){return this.inAnyRange([[Xn,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=Ft.apply(ce,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return kt(this,Gt)}const n=e.reduce((i,r)=>i?i.concat([[i[i.length-1][1],r]]):[[Xn,r]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const i=this._cmp,r=this._ascending,s=this._descending,a=this._min,o=this._max;if(e.length===0)return ge(this);if(!e.every(y=>y[0]!==void 0&&y[1]!==void 0&&r(y[0],y[1])<=0))return kt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",st.InvalidArgument);const u=!n||n.includeLowers!==!1,g=n&&n.includeUppers===!0;let m,_=r;function d(y,v){return _(y[0],v[0])}try{m=e.reduce(function(y,v){let I=0,w=y.length;for(;I<w;++I){const k=y[I];if(i(v[0],k[1])<0&&i(v[1],k[0])>0){k[0]=a(k[0],v[0]),k[1]=o(k[1],v[1]);break}}return I===w&&y.push(v),y},[]),m.sort(d)}catch{return kt(this,Gt)}let l=0;const b=g?y=>r(y,m[l][1])>0:y=>r(y,m[l][1])>=0,h=u?y=>s(y,m[l][0])>0:y=>s(y,m[l][0])>=0;let E=b;const f=new this.Collection(this,()=>Yt(m[0][0],m[m.length-1][1],!u,!g));return f._ondirectionchange=y=>{y==="next"?(E=b,_=r):(E=h,_=s),m.sort(d)},f._addAlgorithm((y,v,I)=>{for(var w=y.key;E(w);)if(++l,l===m.length)return v(I),!1;return!!function(k){return!b(k)&&!h(k)}(w)||(this._cmp(w,m[l][1])===0||this._cmp(w,m[l][0])===0||v(()=>{_===r?y.continue(m[l][0]):y.continue(m[l][1])}),!1)}),f}startsWithAnyOf(){const e=Ft.apply(ce,arguments);return e.every(n=>typeof n=="string")?e.length===0?ge(this):this.inAnyRange(e.map(n=>[n,n+ie])):kt(this,"startsWithAnyOf() only works with strings")}}function Pt(t){return pt(function(e){return Be(e),t(e.target.error),!1})}function Be(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const Me="storagemutated",Xt="x-storagemutated-1",Jt=Pe(null,Me);class Ms{_lock(){return we(!nt.global),++this._reculock,this._reculock!==1||nt.global||(nt.lockOwnerFor=this),this}_unlock(){if(we(!nt.global),--this._reculock==0)for(nt.global||(nt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{_e(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&nt.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,i=this.db._state.dbOpenError;if(we(!this.idbtrans),!e&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new st.DatabaseClosed(i);case"MissingAPIError":throw new st.MissingAPI(i.message,i);default:throw new st.OpenFailed(i)}if(!this.active)throw new st.TransactionInactive;return we(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=pt(r=>{Be(r),this._reject(e.error)}),e.onabort=pt(r=>{Be(r),this.active&&this._reject(new st.Abort(e.error)),this.active=!1,this.on("abort").fire(r)}),e.oncomplete=pt(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Jt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,i){if(e==="readwrite"&&this.mode!=="readwrite")return bt(new st.ReadOnly("Transaction is readonly"));if(!this.active)return bt(new st.TransactionInactive);if(this._locked())return new Y((s,a)=>{this._blockedFuncs.push([()=>{this._promise(e,n,i).then(s,a)},nt])});if(i)return Vt(()=>{var s=new Y((a,o)=>{this._lock();const u=n(a,o,this);u&&u.then&&u.then(a,o)});return s.finally(()=>this._unlock()),s._lib=!0,s});var r=new Y((s,a)=>{var o=n(s,a,this);o&&o.then&&o.then(s,a)});return r._lib=!0,r}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const i=Y.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>i);else{n._waitingFor=i,n._waitingQueue=[];var r=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(r.get(-1/0).onsuccess=a)})()}var s=n._waitingFor;return new Y((a,o)=>{i.then(u=>n._waitingQueue.push(pt(a.bind(null,u))),u=>n._waitingQueue.push(pt(o.bind(null,u)))).finally(()=>{n._waitingFor===s&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new st.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(St(n,e))return n[e];const i=this.schema[e];if(!i)throw new st.NotFound("Table "+e+" not part of transaction");const r=new this.db.Table(e,i,this);return r.core=this.db.core.table(e),n[e]=r,r}}function rr(t,e,n,i,r,s,a){return{name:t,keyPath:e,unique:n,multi:i,auto:r,compound:s,src:(n&&!a?"&":"")+(i?"*":"")+(r?"++":"")+_i(e)}}function _i(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function mi(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Ur(n,i=>[i.name,i])}}let Ue=t=>{try{return t.only([[]]),Ue=()=>[[]],[[]]}catch{return Ue=()=>ie,ie}};function ir(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?i=>i[e]:i=>Ut(i,e)}(t):e=>Ut(e,t)}function gi(t){return[].slice.call(t)}let Us=0;function Fe(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function Fs(t,e,n){function i(u){if(u.type===3)return null;if(u.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:g,upper:m,lowerOpen:_,upperOpen:d}=u;return g===void 0?m===void 0?null:e.upperBound(m,!!d):m===void 0?e.lowerBound(g,!!_):e.bound(g,m,!!_,!!d)}const{schema:r,hasGetAll:s}=function(u,g){const m=gi(u.objectStoreNames);return{schema:{name:u.name,tables:m.map(_=>g.objectStore(_)).map(_=>{const{keyPath:d,autoIncrement:l}=_,b=At(d),h=d==null,E={},f={name:_.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:b,keyPath:d,autoIncrement:l,unique:!0,extractKey:ir(d)},indexes:gi(_.indexNames).map(y=>_.index(y)).map(y=>{const{name:v,unique:I,multiEntry:w,keyPath:k}=y,L={name:v,compound:At(k),keyPath:k,unique:I,multiEntry:w,extractKey:ir(k)};return E[Fe(k)]=L,L}),getIndexByKeyPath:y=>E[Fe(y)]};return E[":id"]=f.primaryKey,d!=null&&(E[Fe(d)]=f.primaryKey),f})},hasGetAll:m.length>0&&"getAll"in g.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),a=r.tables.map(u=>function(g){const m=g.name;return{name:m,schema:g,mutate:function({trans:_,type:d,keys:l,values:b,range:h}){return new Promise((E,f)=>{E=pt(E);const y=_.objectStore(m),v=y.keyPath==null,I=d==="put"||d==="add";if(!I&&d!=="delete"&&d!=="deleteRange")throw new Error("Invalid operation type: "+d);const{length:w}=l||b||{length:1};if(l&&b&&l.length!==b.length)throw new Error("Given keys array must have same length as given values array.");if(w===0)return E({numFailures:0,failures:{},results:[],lastResult:void 0});let k;const L=[],O=[];let S=0;const M=R=>{++S,Be(R)};if(d==="deleteRange"){if(h.type===4)return E({numFailures:S,failures:O,results:[],lastResult:void 0});h.type===3?L.push(k=y.clear()):L.push(k=y.delete(i(h)))}else{const[R,P]=I?v?[b,l]:[b,null]:[l,null];if(I)for(let p=0;p<w;++p)L.push(k=P&&P[p]!==void 0?y[d](R[p],P[p]):y[d](R[p])),k.onerror=M;else for(let p=0;p<w;++p)L.push(k=y[d](R[p])),k.onerror=M}const Z=R=>{const P=R.target.result;L.forEach((p,U)=>p.error!=null&&(O[U]=p.error)),E({numFailures:S,failures:O,results:d==="delete"?l:L.map(p=>p.result),lastResult:P})};k.onerror=R=>{M(R),Z(R)},k.onsuccess=Z})},getMany:({trans:_,keys:d})=>new Promise((l,b)=>{l=pt(l);const h=_.objectStore(m),E=d.length,f=new Array(E);let y,v=0,I=0;const w=L=>{const O=L.target;f[O._pos]=O.result,++I===v&&l(f)},k=Pt(b);for(let L=0;L<E;++L)d[L]!=null&&(y=h.get(d[L]),y._pos=L,y.onsuccess=w,y.onerror=k,++v);v===0&&l(f)}),get:({trans:_,key:d})=>new Promise((l,b)=>{l=pt(l);const h=_.objectStore(m).get(d);h.onsuccess=E=>l(E.target.result),h.onerror=Pt(b)}),query:function(_){return d=>new Promise((l,b)=>{l=pt(l);const{trans:h,values:E,limit:f,query:y}=d,v=f===1/0?void 0:f,{index:I,range:w}=y,k=h.objectStore(m),L=I.isPrimaryKey?k:k.index(I.name),O=i(w);if(f===0)return l({result:[]});if(_){const S=E?L.getAll(O,v):L.getAllKeys(O,v);S.onsuccess=M=>l({result:M.target.result}),S.onerror=Pt(b)}else{let S=0;const M=E||!("openKeyCursor"in L)?L.openCursor(O):L.openKeyCursor(O),Z=[];M.onsuccess=R=>{const P=M.result;return P?(Z.push(E?P.value:P.primaryKey),++S===f?l({result:Z}):void P.continue()):l({result:Z})},M.onerror=Pt(b)}})}(s),openCursor:function({trans:_,values:d,query:l,reverse:b,unique:h}){return new Promise((E,f)=>{E=pt(E);const{index:y,range:v}=l,I=_.objectStore(m),w=y.isPrimaryKey?I:I.index(y.name),k=b?h?"prevunique":"prev":h?"nextunique":"next",L=d||!("openKeyCursor"in w)?w.openCursor(i(v),k):w.openKeyCursor(i(v),k);L.onerror=Pt(f),L.onsuccess=pt(O=>{const S=L.result;if(!S)return void E(null);S.___id=++Us,S.done=!1;const M=S.continue.bind(S);let Z=S.continuePrimaryKey;Z&&(Z=Z.bind(S));const R=S.advance.bind(S),P=()=>{throw new Error("Cursor not stopped")};S.trans=_,S.stop=S.continue=S.continuePrimaryKey=S.advance=()=>{throw new Error("Cursor not started")},S.fail=pt(f),S.next=function(){let p=1;return this.start(()=>p--?this.continue():this.stop()).then(()=>this)},S.start=p=>{const U=new Promise((z,et)=>{z=pt(z),L.onerror=Pt(et),S.fail=et,S.stop=j=>{S.stop=S.continue=S.continuePrimaryKey=S.advance=P,z(j)}}),tt=()=>{if(L.result)try{p()}catch(z){S.fail(z)}else S.done=!0,S.start=()=>{throw new Error("Cursor behind last entry")},S.stop()};return L.onsuccess=pt(z=>{L.onsuccess=tt,tt()}),S.continue=M,S.continuePrimaryKey=Z,S.advance=R,tt(),U},E(S)},f)})},count({query:_,trans:d}){const{index:l,range:b}=_;return new Promise((h,E)=>{const f=d.objectStore(m),y=l.isPrimaryKey?f:f.index(l.name),v=i(b),I=v?y.count(v):y.count();I.onsuccess=pt(w=>h(w.target.result)),I.onerror=Pt(E)})}}}(u)),o={};return a.forEach(u=>o[u.name]=u),{stack:"dbcore",transaction:t.transaction.bind(t),table(u){if(!o[u])throw new Error(`Table '${u}' not found`);return o[u]},MIN_KEY:-1/0,MAX_KEY:Ue(e),schema:r}}function sr({_novip:t},e){const n=e.db,i=function(r,s,{IDBKeyRange:a,indexedDB:o},u){return{dbcore:function(m,_){return _.reduce((d,{create:l})=>({...d,...l(d)}),m)}(Fs(s,a,u),r.dbcore)}}(t._middlewares,n,t._deps,e);t.core=i.dbcore,t.tables.forEach(r=>{const s=r.name;t.core.schema.tables.some(a=>a.name===s)&&(r.core=t.core.table(s),t[s]instanceof t.Table&&(t[s].core=r.core))})}function gn({_novip:t},e,n,i){n.forEach(r=>{const s=i[r];e.forEach(a=>{const o=kn(a,r);(!o||"value"in o&&o.value===void 0)&&(a===t.Transaction.prototype||a instanceof t.Transaction?Mt(a,r,{get(){return this.table(r)},set(u){Dr(this,r,{value:u,writable:!0,configurable:!0,enumerable:!0})}}):a[r]=new t.Table(r,s))})})}function ar({_novip:t},e){e.forEach(n=>{for(let i in n)n[i]instanceof t.Table&&delete n[i]})}function zs(t,e){return t._cfg.version-e._cfg.version}function Gs(t,e,n,i){const r=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,r);s.create(n),s._completion.catch(i);const a=s._reject.bind(s),o=nt.transless||nt;Vt(()=>{nt.trans=s,nt.transless=o,e===0?(yt(r).forEach(u=>{or(n,u,r[u].primKey,r[u].indexes)}),sr(t,n),Y.follow(()=>t.on.populate.fire(s)).catch(a)):function({_novip:u},g,m,_){const d=[],l=u._versions;let b=u._dbSchema=lr(u,u.idbdb,_),h=!1;const E=l.filter(y=>y._cfg.version>=g);function f(){return d.length?Y.resolve(d.shift()(m.idbtrans)).then(f):Y.resolve()}return E.forEach(y=>{d.push(()=>{const v=b,I=y._cfg.dbschema;hr(u,v,_),hr(u,I,_),b=u._dbSchema=I;const w=yi(v,I);w.add.forEach(L=>{or(_,L[0],L[1].primKey,L[1].indexes)}),w.change.forEach(L=>{if(L.recreate)throw new st.Upgrade("Not yet support for changing primary key");{const O=_.objectStore(L.name);L.add.forEach(S=>ur(O,S)),L.change.forEach(S=>{O.deleteIndex(S.name),ur(O,S)}),L.del.forEach(S=>O.deleteIndex(S))}});const k=y._cfg.contentUpgrade;if(k&&y._cfg.version>g){sr(u,_),m._memoizedTables={},h=!0;let L=Fr(I);w.del.forEach(Z=>{L[Z]=v[Z]}),ar(u,[u.Transaction.prototype]),gn(u,[u.Transaction.prototype],yt(L),L),m.schema=L;const O=On(k);let S;O&&pe();const M=Y.follow(()=>{if(S=k(m),S&&O){var Z=zt.bind(null,null);S.then(Z,Z)}});return S&&typeof S.then=="function"?Y.resolve(S):M.then(()=>S)}}),d.push(v=>{(!h||!Ns)&&function(I,w){[].slice.call(w.db.objectStoreNames).forEach(k=>I[k]==null&&w.db.deleteObjectStore(k))}(y._cfg.dbschema,v),ar(u,[u.Transaction.prototype]),gn(u,[u.Transaction.prototype],u._storeNames,u._dbSchema),m.schema=u._dbSchema})}),f().then(()=>{var y,v;v=_,yt(y=b).forEach(I=>{v.db.objectStoreNames.contains(I)||or(v,I,y[I].primKey,y[I].indexes)})})}(t,e,s,n).catch(a)})}function yi(t,e){const n={del:[],add:[],change:[]};let i;for(i in t)e[i]||n.del.push(i);for(i in e){const r=t[i],s=e[i];if(r){const a={name:i,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(r.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||r.primKey.auto!==s.primKey.auto&&!cn)a.recreate=!0,n.change.push(a);else{const o=r.idxByName,u=s.idxByName;let g;for(g in o)u[g]||a.del.push(g);for(g in u){const m=o[g],_=u[g];m?m.src!==_.src&&a.change.push(_):a.add.push(_)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}else n.add.push([i,s])}return n}function or(t,e,n,i){const r=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(s=>ur(r,s)),r}function ur(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function lr(t,e,n){const i={};return Ye(e.objectStoreNames,0).forEach(r=>{const s=n.objectStore(r);let a=s.keyPath;const o=rr(_i(a),a||"",!1,!1,!!s.autoIncrement,a&&typeof a!="string",!0),u=[];for(let m=0;m<s.indexNames.length;++m){const _=s.index(s.indexNames[m]);a=_.keyPath;var g=rr(_.name,a,!!_.unique,!!_.multiEntry,!1,a&&typeof a!="string",!1);u.push(g)}i[r]=mi(r,o,u)}),i}function hr({_novip:t},e,n){const i=n.db.objectStoreNames;for(let r=0;r<i.length;++r){const s=i[r],a=n.objectStore(s);t._hasGetAll="getAll"in a;for(let o=0;o<a.indexNames.length;++o){const u=a.indexNames[o],g=a.index(u).keyPath,m=typeof g=="string"?g:"["+Ye(g).join("+")+"]";if(e[s]){const _=e[s].idxByName[m];_&&(_.name=u,delete e[s].idxByName[m],e[s].idxByName[u]=_)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&dt.WorkerGlobalScope&&dt instanceof dt.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class js{_parseStoresSpec(e,n){yt(e).forEach(i=>{if(e[i]!==null){var r=e[i].split(",").map((a,o)=>{const u=(a=a.trim()).replace(/([&*]|\+\+)/g,""),g=/^\[/.test(u)?u.match(/^\[(.*)\]$/)[1].split("+"):u;return rr(u,g||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),At(g),o===0)}),s=r.shift();if(s.multi)throw new st.Schema("Primary key cannot be multi-valued");r.forEach(a=>{if(a.auto)throw new st.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new st.Schema("Index must have a name and cannot be an empty string")}),n[i]=mi(i,s,r)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?Rt(this._cfg.storesSource,e):e;const i=n._versions,r={};let s={};return i.forEach(a=>{Rt(r,a._cfg.storesSource),s=a._cfg.dbschema={},a._parseStoresSpec(r,s)}),n._dbSchema=s,ar(n,[n._allTables,n,n.Transaction.prototype]),gn(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],yt(s),s),n._storeNames=yt(s),this}upgrade(e){return this._cfg.contentUpgrade=Mn(this._cfg.contentUpgrade||ct,e),this}}function cr(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new ae(fn,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function fr(t){return t&&typeof t.databases=="function"}function dr(t){return Vt(function(){return nt.letThrough=!0,t()})}function Ks(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Ws(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?bt(e.dbOpenError):t);Ot&&(e.openCanceller._stackHolder=te()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const i=e.openCanceller;function r(){if(e.openCanceller!==i)throw new st.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,a=null,o=!1;return Y.race([i,(typeof navigator>"u"?Y.resolve():Ks()).then(()=>new Y((u,g)=>{if(r(),!n)throw new st.MissingAPI;const m=t.name,_=e.autoSchema?n.open(m):n.open(m,Math.round(10*t.verno));if(!_)throw new st.MissingAPI;_.onerror=Pt(g),_.onblocked=pt(t._fireOnBlocked),_.onupgradeneeded=pt(d=>{if(a=_.transaction,e.autoSchema&&!t._options.allowEmptyDB){_.onerror=Be,a.abort(),_.result.close();const b=n.deleteDatabase(m);b.onsuccess=b.onerror=pt(()=>{g(new st.NoSuchDatabase(`Database ${m} doesnt exist`))})}else{a.onerror=Pt(g);var l=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;o=l<1,t._novip.idbdb=_.result,Gs(t,l/10,a,g)}},g),_.onsuccess=pt(()=>{a=null;const d=t._novip.idbdb=_.result,l=Ye(d.objectStoreNames);if(l.length>0)try{const h=d.transaction((b=l).length===1?b[0]:b,"readonly");e.autoSchema?function({_novip:E},f,y){E.verno=f.version/10;const v=E._dbSchema=lr(0,f,y);E._storeNames=Ye(f.objectStoreNames,0),gn(E,[E._allTables],yt(v),v)}(t,d,h):(hr(t,t._dbSchema,h),function(E,f){const y=yi(lr(0,E.idbdb,f),E._dbSchema);return!(y.add.length||y.change.some(v=>v.add.length||v.change.length))}(t,h)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),sr(t,h)}catch{}var b;Oe.push(t),d.onversionchange=pt(h=>{e.vcFired=!0,t.on("versionchange").fire(h)}),d.onclose=pt(h=>{t.on("close").fire(h)}),o&&function({indexedDB:h,IDBKeyRange:E},f){!fr(h)&&f!==fn&&cr(h,E).put({name:f}).catch(ct)}(t._deps,m),u()},g)}))]).then(()=>(r(),e.onReadyBeingFired=[],Y.resolve(dr(()=>t.on.ready.fire(t.vip))).then(function u(){if(e.onReadyBeingFired.length>0){let g=e.onReadyBeingFired.reduce(Mn,ct);return e.onReadyBeingFired=[],Y.resolve(dr(()=>g(t.vip))).then(u)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(u=>{e.dbOpenError=u;try{a&&a.abort()}catch{}return i===e.openCanceller&&t._close(),bt(u)}).finally(()=>{e.openComplete=!0,s()})}function pr(t){var e=s=>t.next(s),n=r(e),i=r(s=>t.throw(s));function r(s){return a=>{var o=s(a),u=o.value;return o.done?u:u&&typeof u.then=="function"?u.then(n,i):At(u)?Promise.all(u).then(n,i):n(u)}}return r(e)()}function Zs(t,e,n){var i=arguments.length;if(i<2)throw new st.InvalidArgument("Too few arguments");for(var r=new Array(i-1);--i;)r[i-1]=arguments[i];return n=r.pop(),[t,zr(r),n]}function bi(t,e,n,i,r){return Y.resolve().then(()=>{const s=nt.transless||nt,a=t._createTransaction(e,n,t._dbSchema,i),o={trans:a,transless:s};if(i)a.idbtrans=i.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(_){return _.name===Bn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>bi(t,e,n,null,r))):bt(_)}const u=On(r);let g;u&&pe();const m=Y.follow(()=>{if(g=r.call(a,a),g)if(u){var _=zt.bind(null,null);g.then(_,_)}else typeof g.next=="function"&&typeof g.throw=="function"&&(g=pr(g))},o);return(g&&typeof g.then=="function"?Y.resolve(g).then(_=>a.active?_:bt(new st.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):m.then(()=>g)).then(_=>(i&&a._resolve(),a._completion.then(()=>_))).catch(_=>(a._reject(_),bt(_)))})}function yn(t,e,n){const i=At(t)?t.slice():[t];for(let r=0;r<n;++r)i.push(e);return i}const Hs={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:i}=n,r={},s=[];function a(m,_,d){const l=Fe(m),b=r[l]=r[l]||[],h=m==null?0:typeof m=="string"?1:m.length,E=_>0,f={...d,isVirtual:E,keyTail:_,keyLength:h,extractKey:ir(m),unique:!E&&d.unique};return b.push(f),f.isPrimaryKey||s.push(f),h>1&&a(h===2?m[0]:m.slice(0,h-1),_+1,d),b.sort((y,v)=>y.keyTail-v.keyTail),f}const o=a(i.primaryKey.keyPath,0,i.primaryKey);r[":id"]=[o];for(const m of i.indexes)a(m.keyPath,0,m);function u(m){const _=m.query.index;return _.isVirtual?{...m,query:{index:_,range:(d=m.query.range,l=_.keyTail,{type:d.type===1?2:d.type,lower:yn(d.lower,d.lowerOpen?t.MAX_KEY:t.MIN_KEY,l),lowerOpen:!0,upper:yn(d.upper,d.upperOpen?t.MIN_KEY:t.MAX_KEY,l),upperOpen:!0})}}:m;var d,l}return{...n,schema:{...i,primaryKey:o,indexes:s,getIndexByKeyPath:function(m){const _=r[Fe(m)];return _&&_[0]}},count:m=>n.count(u(m)),query:m=>n.query(u(m)),openCursor(m){const{keyTail:_,isVirtual:d,keyLength:l}=m.query.index;return d?n.openCursor(u(m)).then(b=>b&&function(h){return Object.create(h,{continue:{value:function(f){f!=null?h.continue(yn(f,m.reverse?t.MAX_KEY:t.MIN_KEY,_)):m.unique?h.continue(h.key.slice(0,l).concat(m.reverse?t.MIN_KEY:t.MAX_KEY,_)):h.continue()}},continuePrimaryKey:{value(f,y){h.continuePrimaryKey(yn(f,t.MAX_KEY,_),y)}},primaryKey:{get:()=>h.primaryKey},key:{get(){const f=h.key;return l===1?f[0]:f.slice(0,l)}},value:{get:()=>h.value}})}(b)):n.openCursor(m)}}}}}};function _r(t,e,n,i){return n=n||{},i=i||"",yt(t).forEach(r=>{if(St(e,r)){var s=t[r],a=e[r];if(typeof s=="object"&&typeof a=="object"&&s&&a){const o=Cn(s);o!==Cn(a)?n[i+r]=e[r]:o==="Object"?_r(s,a,n,i+r+"."):s!==a&&(n[i+r]=e[r])}else s!==a&&(n[i+r]=e[r])}else n[i+r]=void 0}),yt(e).forEach(r=>{St(t,r)||(n[i+r]=e[r])}),n}const qs={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:i}=n.schema;return{...n,mutate(s){const a=nt.trans,{deleting:o,creating:u,updating:g}=a.table(e).hook;switch(s.type){case"add":if(u.fire===ct)break;return a._promise("readwrite",()=>m(s),!0);case"put":if(u.fire===ct&&g.fire===ct)break;return a._promise("readwrite",()=>m(s),!0);case"delete":if(o.fire===ct)break;return a._promise("readwrite",()=>m(s),!0);case"deleteRange":if(o.fire===ct)break;return a._promise("readwrite",()=>function(d){return _(d.trans,d.range,1e4)}(s),!0)}return n.mutate(s);function m(d){const l=nt.trans,b=d.keys||function(h,E){return E.type==="delete"?E.keys:E.keys||E.values.map(h.extractKey)}(i,d);if(!b)throw new Error("Keys missing");return(d=d.type==="add"||d.type==="put"?{...d,keys:b}:{...d}).type!=="delete"&&(d.values=[...d.values]),d.keys&&(d.keys=[...d.keys]),function(h,E,f){return E.type==="add"?Promise.resolve([]):h.getMany({trans:E.trans,keys:f,cache:"immutable"})}(n,d,b).then(h=>{const E=b.map((f,y)=>{const v=h[y],I={onerror:null,onsuccess:null};if(d.type==="delete")o.fire.call(I,f,v,l);else if(d.type==="add"||v===void 0){const w=u.fire.call(I,f,d.values[y],l);f==null&&w!=null&&(f=w,d.keys[y]=f,i.outbound||Ct(d.values[y],i.keyPath,f))}else{const w=_r(v,d.values[y]),k=g.fire.call(I,w,f,v,l);if(k){const L=d.values[y];Object.keys(k).forEach(O=>{St(L,O)?L[O]=k[O]:Ct(L,O,k[O])})}}return I});return n.mutate(d).then(({failures:f,results:y,numFailures:v,lastResult:I})=>{for(let w=0;w<b.length;++w){const k=y?y[w]:b[w],L=E[w];k==null?L.onerror&&L.onerror(f[w]):L.onsuccess&&L.onsuccess(d.type==="put"&&h[w]?d.values[w]:k)}return{failures:f,results:y,numFailures:v,lastResult:I}}).catch(f=>(E.forEach(y=>y.onerror&&y.onerror(f)),Promise.reject(f)))})}function _(d,l,b){return n.query({trans:d,values:!1,query:{index:i,range:l},limit:b}).then(({result:h})=>m({type:"delete",keys:h,trans:d}).then(E=>E.numFailures>0?Promise.reject(E.failures[0]):h.length<b?{failures:[],numFailures:0,lastResult:void 0}:_(d,{...l,lower:h[h.length-1],lowerOpen:!0},b)))}}}}})};function Ei(t,e,n){try{if(!e||e.keys.length<t.length)return null;const i=[];for(let r=0,s=0;r<e.keys.length&&s<t.length;++r)Lt(e.keys[r],t[s])===0&&(i.push(n?Ie(e.values[r]):e.values[r]),++s);return i.length===t.length?i:null}catch{return null}}const Vs={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:i=>{if(!i.cache)return n.getMany(i);const r=Ei(i.keys,i.trans._cache,i.cache==="clone");return r?Y.resolve(r):n.getMany(i).then(s=>(i.trans._cache={keys:i.keys,values:i.cache==="clone"?Ie(s):s},s))},mutate:i=>(i.type!=="add"&&(i.trans._cache=null),n.mutate(i))}}})};function mr(t){return!("from"in t)}const jt=function(t,e){if(!this){const n=new jt;return t&&"d"in t&&Rt(n,t),n}Rt(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function ze(t,e,n){const i=Lt(e,n);if(isNaN(i))return;if(i>0)throw RangeError();if(mr(t))return Rt(t,{from:e,to:n,d:1});const r=t.l,s=t.r;if(Lt(n,t.from)<0)return r?ze(r,e,n):t.l={from:e,to:n,d:1,l:null,r:null},vi(t);if(Lt(e,t.to)>0)return s?ze(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},vi(t);Lt(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),Lt(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const a=!t.r;r&&!t.l&&bn(t,r),s&&a&&bn(t,s)}function bn(t,e){mr(e)||function n(i,{from:r,to:s,l:a,r:o}){ze(i,r,s),a&&n(i,a),o&&n(i,o)}(t,e)}function $s(t,e){const n=gr(e);let i=n.next();if(i.done)return!1;let r=i.value;const s=gr(t);let a=s.next(r.from),o=a.value;for(;!i.done&&!a.done;){if(Lt(o.from,r.to)<=0&&Lt(o.to,r.from)>=0)return!0;Lt(r.from,o.from)<0?r=(i=n.next(o.from)).value:o=(a=s.next(r.from)).value}return!1}function gr(t){let e=mr(t)?null:{s:0,n:t};return{next(n){const i=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,i)for(;e.n.l&&Lt(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!i||Lt(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function vi(t){var e,n;const i=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),r=i>1?"r":i<-1?"l":"";if(r){const s=r==="r"?"l":"r",a={...t},o=t[r];t.from=o.from,t.to=o.to,t[r]=o[r],a[r]=o[s],t[s]=a,a.d=Ai(a)}t.d=Ai(t)}function Ai({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}le(jt.prototype,{add(t){return bn(this,t),this},addKey(t){return ze(this,t,t),this},addKeys(t){return t.forEach(e=>ze(this,e,e)),this},[xn](){return gr(this)}});const Ys={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new jt(t.MIN_KEY,t.MAX_KEY);return{...t,table:i=>{const r=t.table(i),{schema:s}=r,{primaryKey:a}=s,{extractKey:o,outbound:u}=a,g={...r,mutate:d=>{const l=d.trans,b=l.mutatedParts||(l.mutatedParts={}),h=k=>{const L=`idb://${e}/${i}/${k}`;return b[L]||(b[L]=new jt)},E=h(""),f=h(":dels"),{type:y}=d;let[v,I]=d.type==="deleteRange"?[d.range]:d.type==="delete"?[d.keys]:d.values.length<50?[[],d.values]:[];const w=d.trans._cache;return r.mutate(d).then(k=>{if(At(v)){y!=="delete"&&(v=k.results),E.addKeys(v);const L=Ei(v,w);L||y==="add"||f.addKeys(v),(L||I)&&function(O,S,M,Z){function R(P){const p=O(P.name||"");function U(z){return z!=null?P.extractKey(z):null}const tt=z=>P.multiEntry&&At(z)?z.forEach(et=>p.addKey(et)):p.addKey(z);(M||Z).forEach((z,et)=>{const j=M&&U(M[et]),Q=Z&&U(Z[et]);Lt(j,Q)!==0&&(j!=null&&tt(j),Q!=null&&tt(Q))})}S.indexes.forEach(R)}(h,s,L,I)}else if(v){const L={from:v.lower,to:v.upper};f.add(L),E.add(L)}else E.add(n),f.add(n),s.indexes.forEach(L=>h(L.name).add(n));return k})}},m=({query:{index:d,range:l}})=>{var b,h;return[d,new jt((b=l.lower)!==null&&b!==void 0?b:t.MIN_KEY,(h=l.upper)!==null&&h!==void 0?h:t.MAX_KEY)]},_={get:d=>[a,new jt(d.key)],getMany:d=>[a,new jt().addKeys(d.keys)],count:m,query:m,openCursor:m};return yt(_).forEach(d=>{g[d]=function(l){const{subscr:b}=nt;if(b){const h=I=>{const w=`idb://${e}/${i}/${I}`;return b[w]||(b[w]=new jt)},E=h(""),f=h(":dels"),[y,v]=_[d](l);if(h(y.name||"").add(v),!y.isPrimaryKey){if(d!=="count"){const I=d==="query"&&u&&l.values&&r.query({...l,values:!1});return r[d].apply(this,arguments).then(w=>{if(d==="query"){if(u&&l.values)return I.then(({result:L})=>(E.addKeys(L),w));const k=l.values?w.result.map(o):w.result;l.values?E.addKeys(k):f.addKeys(k)}else if(d==="openCursor"){const k=w,L=l.values;return k&&Object.create(k,{key:{get:()=>(f.addKey(k.primaryKey),k.key)},primaryKey:{get(){const O=k.primaryKey;return f.addKey(O),O}},value:{get:()=>(L&&E.addKey(k.primaryKey),k.value)}})}return w})}f.add(n)}}return r[d].apply(this,arguments)}}),g}}}};class ae{constructor(e,n){this._middlewares={},this.verno=0;const i=ae.dependencies;this._options=n={addons:ae.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:r}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ct,dbReadyPromise:null,cancelOpen:ct,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;s.dbReadyPromise=new Y(o=>{s.dbReadyResolve=o}),s.openCanceller=new Y((o,u)=>{s.cancelOpen=u}),this._state=s,this.name=e,this.on=Pe(this,"populate","blocked","versionchange","close",{ready:[Mn,ct]}),this.on.ready.subscribe=Br(this.on.ready.subscribe,o=>(u,g)=>{ae.vip(()=>{const m=this._state;if(m.openComplete)m.dbOpenError||Y.resolve().then(u),g&&o(u);else if(m.onReadyBeingFired)m.onReadyBeingFired.push(u),g&&o(u);else{o(u);const _=this;g||o(function d(){_.on.ready.unsubscribe(u),_.on.ready.unsubscribe(d)})}})}),this.Collection=(a=this,De(Os.prototype,function(o,u){this.db=a;let g=ui,m=null;if(u)try{g=u()}catch(b){m=b}const _=o._ctx,d=_.table,l=d.hook.reading.fire;this._ctx={table:d,index:_.index,isPrimKey:!_.index||d.schema.primKey.keyPath&&_.index===d.schema.primKey.name,range:g,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:m,or:_.or,valueMapper:l!==Le?l:null}})),this.Table=function(o){return De(xs.prototype,function(u,g,m){this.db=o,this._tx=m,this.name=u,this.schema=g,this.hook=o._allTables[u]?o._allTables[u].hook:Pe(null,{creating:[Es,ct],reading:[bs,Le],updating:[As,ct],deleting:[vs,ct]})})}(this),this.Transaction=function(o){return De(Ms.prototype,function(u,g,m,_,d){this.db=o,this.mode=u,this.storeNames=g,this.schema=m,this.chromeTransactionDurability=_,this.idbtrans=null,this.on=Pe(this,"complete","error","abort"),this.parent=d||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Y((l,b)=>{this._resolve=l,this._reject=b}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},l=>{var b=this.active;return this.active=!1,this.on.error.fire(l),this.parent?this.parent._reject(l):b&&this.idbtrans&&this.idbtrans.abort(),bt(l)})})}(this),this.Version=function(o){return De(js.prototype,function(u){this.db=o,this._cfg={version:u,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return De(pi.prototype,function(u,g,m){this.db=o,this._ctx={table:u,index:g===":id"?null:g,or:m};const _=o._deps.indexedDB;if(!_)throw new st.MissingAPI;this._cmp=this._ascending=_.cmp.bind(_),this._descending=(d,l)=>_.cmp(l,d),this._max=(d,l)=>_.cmp(d,l)>0?d:l,this._min=(d,l)=>_.cmp(d,l)<0?d:l,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=Ue(n.IDBKeyRange),this._createTransaction=(o,u,g,m)=>new this.Transaction(o,u,g,this._options.chromeTransactionDurability,m),this._fireOnBlocked=o=>{this.on("blocked").fire(o),Oe.filter(u=>u.name===this.name&&u!==this&&!u._state.vcFired).map(u=>u.on("versionchange").fire(o))},this.use(Hs),this.use(qs),this.use(Ys),this.use(Vs),this.vip=Object.create(this,{_vip:{value:!0}}),r.forEach(o=>o(this))}version(e){if(isNaN(e)||e<.1)throw new st.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new st.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var i=n.filter(r=>r._cfg.version===e)[0];return i||(i=new this.Version(e),n.push(i),n.sort(zs),i.stores({}),this._state.autoSchema=!1,i)}_whenReady(e){return this.idbdb&&(this._state.openComplete||nt.letThrough||this._vip)?e():new Y((n,i)=>{if(this._state.openComplete)return i(new st.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void i(new st.DatabaseClosed);this.open().catch(ct)}this._state.dbReadyPromise.then(n,i)}).then(e)}use({stack:e,create:n,level:i,name:r}){r&&this.unuse({stack:e,name:r});const s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:n,level:i??10,name:r}),s.sort((a,o)=>a.level-o.level),this}unuse({stack:e,name:n,create:i}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(r=>i?r.create!==i:!!n&&r.name!==n)),this}open(){return Ws(this)}_close(){const e=this._state,n=Oe.indexOf(this);if(n>=0&&Oe.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new Y(i=>{e.dbReadyResolve=i}),e.openCanceller=new Y((i,r)=>{e.cancelOpen=r})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new st.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new Y((i,r)=>{const s=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=pt(()=>{(function({indexedDB:o,IDBKeyRange:u},g){!fr(o)&&g!==fn&&cr(o,u).delete(g).catch(ct)})(this._deps,this.name),i()}),a.onerror=Pt(r),a.onblocked=this._fireOnBlocked};if(e)throw new st.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return yt(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Zs.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,i){let r=nt.trans;r&&r.db===this&&e.indexOf("!")===-1||(r=null);const s=e.indexOf("?")!==-1;let a,o;e=e.replace("!","").replace("?","");try{if(o=n.map(g=>{var m=g instanceof this.Table?g.name:g;if(typeof m!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return m}),e=="r"||e===Jn)a=Jn;else{if(e!="rw"&&e!=Qn)throw new st.InvalidArgument("Invalid transaction mode: "+e);a=Qn}if(r){if(r.mode===Jn&&a===Qn){if(!s)throw new st.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&o.forEach(g=>{if(r&&r.storeNames.indexOf(g)===-1){if(!s)throw new st.SubTransaction("Table "+g+" not included in parent transaction.");r=null}}),s&&r&&!r.active&&(r=null)}}catch(g){return r?r._promise(null,(m,_)=>{_(g)}):bt(g)}const u=bi.bind(null,this,a,o,r,i);return r?r._promise(a,u,"lock"):nt.trans?_e(nt.transless,()=>this._whenReady(u)):this._whenReady(u)}table(e){if(!St(this._allTables,e))throw new st.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Xs=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Js{constructor(e){this._subscribe=e}subscribe(e,n,i){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:i})}[Xs](){return this}}function Ti(t,e){return yt(e).forEach(n=>{bn(t[n]||(t[n]=new jt),e[n])}),t}function Qs(t){let e,n=!1;const i=new Js(r=>{const s=On(t);let a=!1,o={},u={};const g={get closed(){return a},unsubscribe:()=>{a=!0,Jt.storagemutated.unsubscribe(l)}};r.start&&r.start(g);let m=!1,_=!1;function d(){return yt(u).some(h=>o[h]&&$s(o[h],u[h]))}const l=h=>{Ti(o,h),d()&&b()},b=()=>{if(m||a)return;o={};const h={},E=function(f){s&&pe();const y=()=>Vt(t,{subscr:f,trans:null}),v=nt.trans?_e(nt.transless,y):y();return s&&v.then(zt,zt),v}(h);_||(Jt(Me,l),_=!0),m=!0,Promise.resolve(E).then(f=>{n=!0,e=f,m=!1,a||(d()?b():(o={},u=h,r.next&&r.next(f)))},f=>{m=!1,n=!1,r.error&&r.error(f),g.unsubscribe()})};return b(),g});return i.hasValue=()=>n,i.getValue=()=>e,i}let yr;try{yr={indexedDB:dt.indexedDB||dt.mozIndexedDB||dt.webkitIndexedDB||dt.msIndexedDB,IDBKeyRange:dt.IDBKeyRange||dt.webkitIDBKeyRange}}catch{yr={indexedDB:null,IDBKeyRange:null}}const oe=ae;function En(t){let e=Kt;try{Kt=!0,Jt.storagemutated.fire(t)}finally{Kt=e}}le(oe,{...Je,delete:t=>new oe(t,{addons:[]}).delete(),exists:t=>new oe(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return fr(e)?Promise.resolve(e.databases()).then(i=>i.map(r=>r.name).filter(r=>r!==fn)):cr(e,n).toCollection().primaryKeys()}(oe.dependencies).then(t)}catch{return bt(new st.MissingAPI)}},defineClass:()=>function(t){Rt(this,t)},ignoreTransaction:t=>nt.trans?_e(nt.transless,t):t(),vip:dr,async:function(t){return function(){try{var e=pr(t.apply(this,arguments));return e&&typeof e.then=="function"?e:Y.resolve(e)}catch(n){return bt(n)}}},spawn:function(t,e,n){try{var i=pr(t.apply(n,e||[]));return i&&typeof i.then=="function"?i:Y.resolve(i)}catch(r){return bt(r)}},currentTransaction:{get:()=>nt.trans||null},waitFor:function(t,e){const n=Y.resolve(typeof t=="function"?oe.ignoreTransaction(t):t).timeout(e||6e4);return nt.trans?nt.trans.waitFor(n):n},Promise:Y,debug:{get:()=>Ot,set:t=>{jr(t,t==="dexie"?()=>!0:oi)}},derive:he,extend:Rt,props:le,override:Br,Events:Pe,on:Jt,liveQuery:Qs,extendObservabilitySet:Ti,getByKeyPath:Ut,setByKeyPath:Ct,delByKeyPath:function(t,e){typeof e=="string"?Ct(t,e,void 0):"length"in e&&[].map.call(e,function(n){Ct(t,n,void 0)})},shallowClone:Fr,deepClone:Ie,getObjectDiff:_r,cmp:Lt,asap:Mr,minKey:Xn,addons:[],connections:Oe,errnames:Bn,dependencies:yr,semVer:si,version:si.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),oe.maxKey=Ue(oe.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Jt(Me,t=>{if(!Kt){let e;cn?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Xt,!0,!0,t)):e=new CustomEvent(Xt,{detail:t}),Kt=!0,dispatchEvent(e),Kt=!1}}),addEventListener(Xt,({detail:t})=>{Kt||En(t)}));let Kt=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(Xt);typeof t.unref=="function"&&t.unref(),Jt(Me,e=>{Kt||t.postMessage(e)}),t.onmessage=e=>{e.data&&En(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Jt(Me,e=>{try{Kt||(typeof localStorage<"u"&&localStorage.setItem(Xt,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:Xt,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===Xt){const n=JSON.parse(e.newValue);n&&En(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===Xt&&En(e.changedParts)})}Y.rejectionMapper=function(t,e){if(!t||t instanceof fe||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Hr[t.name])return t;var n=new Hr[t.name](e||t.message,t);return"stack"in t&&Mt(n,"stack",{get:function(){return this.inner.stack}}),n},jr(Ot,oi);const Ge="z0, z1, z2, z3, z4, z5, z6, z7, z8, z9, z10",vn="z0_, z1_, z2_, z3_, z4_, z5_, z6_, z7_, z8_, z9_, z10_";class br extends ae{constructor(e){super(e),this.version(8).stores({countries:"++id, name, &gid_0, "+Ge+","+vn,regions1:"++id, name, resourceIdRef, &[gid_0+gid_1], "+Ge+","+vn,regions2:"++id, resourceIdRef, name, &[gid_0+gid_1+gid_2], "+Ge+","+vn,points:"++id, resourceIdRef, type, country, name_1, name, &[country+name_1+name], "+Ge,routeSegments:"++id, resourceIdRef, mode, sourceCountry, sourceName1, sourceName2, sourceName, targetCountry, targetName1, targetName2, targetName, sourceIdRef, targetIdRef, &[sourceIdRef+targetIdRef], "+Ge+","+vn}),this.countries=this.table("countries"),this.regions1=this.table("regions1"),this.regions2=this.table("regions2"),this.points=this.table("points"),this.routeSegments=this.table("routeSegments")}static async open(e){return new br(e)}async findAllGeoRegions(e,n){const i=0<=n&&n<=2?[this.countries]:n<=4?[this.countries,this.regions1]:[this.regions1,this.regions2];return Promise.all(i.map(async r=>{const s=[];for(let a=n;a>=0;a--)if(e[n].length===1){if(s.push(r.where(`z${n}`).anyOf(e[n][0]).toArray()),e[n][0].length===1)break}else s.push(r.where(`z${n}`).anyOf(e[n].length===2?e[n][0].concat(e[n][1]):e[n][0]).toArray());return Promise.all(s)}))}async findAllGeoPoints(e,n){const i=this.points,r=[];for(let s=n;s>=0;s--)if(e[n].length===1){if(r.push(i.where(`z${n}`).anyOf(e[n][0]).toArray()),e[n][0].length===1)break}else r.push(i.where(`z${n}`).anyOf(e[n].length===2?e[n][0].concat(e[n][1]):e[n][0]).toArray());return Promise.all(r)}async findAllGeoLineStrings(e,n){const i=this.routeSegments,r=[];for(let s=n;s>=0;s--)if(e[n].length===1){if(r.push(i.where(`z${n}`).anyOf(e[n][0]).toArray()),e[n][0].length===1)break}else r.push(i.where(`z${n}`).anyOf(e[n].length===2?e[n][0].concat(e[n][1]):e[n][0]).toArray());return Promise.all(r)}async storeGISRouteSegment(e){const n=await Promise.all(e.map(async i=>{const{sourceCountry:r,sourceName1:s,sourceName2:a,sourceName:o,targetCountry:u,targetName1:g,targetName2:m,targetName:_}=i,d=await this.findGISPoint({country:r,name_1:s,name_2:a,name:o}),l=await this.findGISPoint({country:u,name_1:g,name_2:m,name:_});if(d===void 0||l===void 0||d.id===void 0||l.id===void 0)throw new Error;const[b,h]=d.lat>l.lat?[d.lat,l.lat]:[l.lat,d.lat],[E,f]=d.lng>l.lng?[d.lng,l.lng]:[l.lng,d.lng],y=Di({lat:b,lng:E},{lat:h,lng:f},Qt),v={...i,uuid:wn(),sourceIdRef:d.uuid,targetIdRef:l.uuid,...y};return console.log(v),v}));await this.routeSegments.bulkAdd(n)}async findGISPoint({country:e,name_1:n,name_2:i,name:r}){return this.points.where("[country+name_1+name_2+name]").equals(e+n+i+r).last()}}let Er=!1;function ta(t){const e=[];for(let n=0;n<t.length;n++){const i=t.item(n);i&&e.push(i)}return e}const wi=(t,e)=>{self.postMessage({value:{type:Zt.started,value:{dbName:e,fileName:t}}})},Ii=t=>{self.postMessage({value:t})},Ri=(t,e)=>{self.postMessage({value:{type:Zt.error,fileName:t,errorMessage:e}})},Li=t=>{self.postMessage({value:{type:Zt.cancel,fileName:t}})},Si=t=>{self.postMessage({value:{type:Zt.finished,fileName:t}})},ea=async(t,e,n)=>{const i=ta(e);for(const r of["cities","routes"])await Promise.all(i.filter(s=>{const a=s.name.toLowerCase();return a.startsWith(r)&&a.endsWith(".csv")}).map(async s=>Bi({db:t,stream:(await Pr(s)).stream,fileName:s.name,fileSize:s.size,csvLoaders:n,startedCallback:wi,progressCallback:Ii,errorCallback:Ri,cancelCallback:Li,finishedCallback:Si})));await Promise.all(i.filter(r=>{const s=r.name.toLowerCase();return s.startsWith("gadm")&&(s.endsWith(".json")||s.endsWith(".json.zip"))}).map(async r=>ss({db:t,stream:(await Pr(r)).stream,fileName:r.name,fileSize:r.size,startedCallback:wi,progressCallback:Ii,errorCallback:Ri,cancelCallback:Li,finishedCallback:Si}))).catch(r=>{console.error(r)}).then(()=>{})};self.onmessage=async function(e){const n=e.data;switch(n.type){case Ar.start:if(!Er){Er=!0;const i=n.value.dbName;console.log("dbName:",i);const r=new br(i);await ea(r,e.data.data,Fi),Er=!1}break}}})();
